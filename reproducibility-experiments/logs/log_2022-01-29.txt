Script started on 2022-01-29 15:37:12+01:00 [TERM="xterm-256color" TTY="/dev/pts/0" COLUMNS="80" LINES="24"]
(base) ]0;sejmou@sejmou-desktop: ~/Repos/Uni/ExpDesDS/FANG[01;32msejmou@sejmou-desktop[00m:[01;34m~/Repos/Uni/ExpDesDS/FANG[00m$ ac[K[Kcondat[K activate test
(test) ]0;sejmou@sejmou-desktop: ~/Repos/Uni/ExpDesDS/FANG[01;32msejmou@sejmou-desktop[00m:[01;34m~/Repos/Uni/ExpDesDS/FANG[00m$ cat README.md
# Factual News Graph (FANG)
This is the implementation of FANG - a graph representation learning framework for fake news detection. 

For more details, please refer to our paper.
[Van-Hoang Nguyen, Kazunari Sugiyama, Preslav Nakov, Min-Yen Kan, FANG: Leveraging Social Context for Fake News Detection Using Graph Representation (CIKM 2020)](https://dl.acm.org/doi/10.1145/3340531.3412046)


## Installation
```bash
conda env create -f environment. yml 
```

## Requirements
### Packages
* conda 4.8.2
* python 3.7.7
* torch 1.5.1
* tensorboard 1.15.0
### Hardware
* GPU: Titan RTX 24220MiB total memory
* CPU: 16GiB total memory

## Data
We provided the processed data used in our experiments in `data/news_graph`

| Description | File name | Format |
| ----- | ----- | ----- |
| Social entities | entities.txt | |
| Social entity's features | entity_features.tsv | entity_id [tab] feature_1_value [tab] feature_2_value... |
| User-news support interactions with negative sentiment | support_negative.tsv | user_id [tab] news_id [tab] seconds_since_publication |
| User-news support interactions with neutral sentiment | support_neutral.tsv | user_id [tab] news_id [tab] seconds_since_publication |
| User-news deny interactions | deny.tsv | user_id [tab] news_id [tab] seconds_since_publication |
| User-news report interactions | report.tsv | user_id [tab] news_id [tab] seconds_since_publication |
| News information | news_info.tsv | news_id [tab] labels [tab] title |
| Indicator whether certain pair of entities should be closed or far, only used for evaluation, not for as labels | rep_entities.tsv | entity_1_id [tab] entity_2_id [tab] closed/far [tab] stance |
| Source-source citation interactions | source_citation.tsv | source_1_id [tab] source_2_id |
| Source-news publication interactions | source_publication.tsv | source_id [tab] news_id |
| User-user friendship interactions | user_relationships.tsv | user_1_id [tab] user_2_id |
| Train-val-test splits (representative of a fold) | train_test_{training percentage}.json | {"train": train_entities, "val": validate_entities, "test": test_entities} | 

Unprocessed data, including news and users who engage them can be found in `data/fang_fake.csv` and `data/fang_real.csv`.

## Run Graph Learning Frameworks
```
usage: run_graph.py [-h] [-t TASK] [-m MODEL] [-p PATH] [--percent PERCENT]
                    [--temporal] [--use-stance] [--use-proximity]
                    [--epochs EPOCHS] [--attention]
                    [--pretrained_dir PRETRAINED_DIR]
                    [--pretrained_step PRETRAINED_STEP]

Graph Learning

optional arguments:
  -h, --help            show this help message and exit
  -t TASK, --task TASK  task name
  -m MODEL, --model MODEL
                        model name
  -p PATH, --path PATH  path to dataset
  --percent PERCENT
  --temporal            whether to use temporality
  --use-stance          whether to use stance
  --use-proximity       whether to use proximity
  --epochs EPOCHS       number of epochs
  --attention           whether to use attention
  --pretrained_dir PRETRAINED_DIR
                        path to pre-trained model directory
  --pretrained_step PRETRAINED_STEP
                        pre-trained model step
```

Training FANG for `30` epochs at `90%` data with `temporality`, `stance loss` and `proximity loss`.
```
python run_graph.py -t fang -m graph_sage -p data/news_graph --percent 90 --epochs=30 --attention --use-stance --use-proximity --temporal
```

Training GCN baseline for `1000` epochs at `90%` data.
```
python run_graph.py -t news_graph -m gcn -p data/news_graph --percent 90 --epochs=1000
```

## Other resources
* Relation filtering, Stance detection, Sentiment Classification models can be found [here](https://github.com/nguyenvanhoang7398/FANG-helper)
* Social media retriever used to crawl unprocessed data, implemented by Kai Shu et al. can be found [here](https://github.com/KaiDMML/FakeNewsNet/)
* The implementation of GraphSage from which this code was adapted can be found [here](https://github.com/twjiang/graphSAGE-pytorch)

## Cite
Please cite our paper as below if you use this code in your work:

```
@inproceedings{10.1145/3340531.3412046,
author = {Nguyen, Van-Hoang and Sugiyama, Kazunari and Nakov, Preslav and Kan, Min-Yen},
title = {FANG: Leveraging Social Context for Fake News Detection Using Graph Representation},
year = {2020},
isbn = {9781450368599},
publisher = {Association for Computing Machinery},
address = {New York, NY, USA},
url = {https://doi.org/10.1145/3340531.3412046},
doi = {10.1145/3340531.3412046},
abstract = {We propose Factual News Graph (FANG), a novel graphical social context representation and learning framework for fake news detection. Unlike previous contextual models that have targeted performance, our focus is on representation learning. Compared to transductive models, FANG is scalable in training as it does not have to maintain all nodes, and it is efficient at inference time, without the need to re-process the entire graph. Our experimental results show that FANG is better at capturing the social context into a high fidelity representation, compared to recent graphical and non-graphical models. In particular, FANG yields significant improvements for the task of fake news detection, and it is robust in the case of limited training data. We further demonstrate that the representations learned by FANG generalize to related tasks, such as predicting the factuality of reporting of a news medium.},
booktitle = {Proceedings of the 29th ACM International Conference on Information &amp; Knowledge Management},
pages = {1165–1174},
numpages = {10},
keywords = {representation learning, fake news, social networks, graph neural networks, disinformation},
location = {Virtual Event, Ireland},
series = {CIKM '20}
}
```
(test) ]0;sejmou@sejmou-desktop: ~/Repos/Uni/ExpDesDS/FANG[01;32msejmou@sejmou-desktop[00m:[01;34m~/Repos/Uni/ExpDesDS/FANG[00m$ [K(test) ]0;sejmou@sejmou-desktop: ~/Repos/Uni/ExpDesDS/FANG[01;32msejmou@sejmou-desktop[00m:[01;34m~/Repos/Uni/ExpDesDS/FANG[00m$ [K(test) ]0;sejmou@sejmou-desktop: ~/Repos/Uni/ExpDesDS/FANG[01;32msejmou@sejmou-desktop[00m:[01;34m~/Repos/Uni/ExpDesDS/FANG[00m$ time catcat README.mdonda activate test[6Pat README.md[1@t[1@i[1@m[1@e[1@ 
# Factual News Graph (FANG)
This is the implementation of FANG - a graph representation learning framework for fake news detection. 

For more details, please refer to our paper.
[Van-Hoang Nguyen, Kazunari Sugiyama, Preslav Nakov, Min-Yen Kan, FANG: Leveraging Social Context for Fake News Detection Using Graph Representation (CIKM 2020)](https://dl.acm.org/doi/10.1145/3340531.3412046)


## Installation
```bash
conda env create -f environment. yml 
```

## Requirements
### Packages
* conda 4.8.2
* python 3.7.7
* torch 1.5.1
* tensorboard 1.15.0
### Hardware
* GPU: Titan RTX 24220MiB total memory
* CPU: 16GiB total memory

## Data
We provided the processed data used in our experiments in `data/news_graph`

| Description | File name | Format |
| ----- | ----- | ----- |
| Social entities | entities.txt | |
| Social entity's features | entity_features.tsv | entity_id [tab] feature_1_value [tab] feature_2_value... |
| User-news support interactions with negative sentiment | support_negative.tsv | user_id [tab] news_id [tab] seconds_since_publication |
| User-news support interactions with neutral sentiment | support_neutral.tsv | user_id [tab] news_id [tab] seconds_since_publication |
| User-news deny interactions | deny.tsv | user_id [tab] news_id [tab] seconds_since_publication |
| User-news report interactions | report.tsv | user_id [tab] news_id [tab] seconds_since_publication |
| News information | news_info.tsv | news_id [tab] labels [tab] title |
| Indicator whether certain pair of entities should be closed or far, only used for evaluation, not for as labels | rep_entities.tsv | entity_1_id [tab] entity_2_id [tab] closed/far [tab] stance |
| Source-source citation interactions | source_citation.tsv | source_1_id [tab] source_2_id |
| Source-news publication interactions | source_publication.tsv | source_id [tab] news_id |
| User-user friendship interactions | user_relationships.tsv | user_1_id [tab] user_2_id |
| Train-val-test splits (representative of a fold) | train_test_{training percentage}.json | {"train": train_entities, "val": validate_entities, "test": test_entities} | 

Unprocessed data, including news and users who engage them can be found in `data/fang_fake.csv` and `data/fang_real.csv`.

## Run Graph Learning Frameworks
```
usage: run_graph.py [-h] [-t TASK] [-m MODEL] [-p PATH] [--percent PERCENT]
                    [--temporal] [--use-stance] [--use-proximity]
                    [--epochs EPOCHS] [--attention]
                    [--pretrained_dir PRETRAINED_DIR]
                    [--pretrained_step PRETRAINED_STEP]

Graph Learning

optional arguments:
  -h, --help            show this help message and exit
  -t TASK, --task TASK  task name
  -m MODEL, --model MODEL
                        model name
  -p PATH, --path PATH  path to dataset
  --percent PERCENT
  --temporal            whether to use temporality
  --use-stance          whether to use stance
  --use-proximity       whether to use proximity
  --epochs EPOCHS       number of epochs
  --attention           whether to use attention
  --pretrained_dir PRETRAINED_DIR
                        path to pre-trained model directory
  --pretrained_step PRETRAINED_STEP
                        pre-trained model step
```

Training FANG for `30` epochs at `90%` data with `temporality`, `stance loss` and `proximity loss`.
```
python run_graph.py -t fang -m graph_sage -p data/news_graph --percent 90 --epochs=30 --attention --use-stance --use-proximity --temporal
```

Training GCN baseline for `1000` epochs at `90%` data.
```
python run_graph.py -t news_graph -m gcn -p data/news_graph --percent 90 --epochs=1000
```

## Other resources
* Relation filtering, Stance detection, Sentiment Classification models can be found [here](https://github.com/nguyenvanhoang7398/FANG-helper)
* Social media retriever used to crawl unprocessed data, implemented by Kai Shu et al. can be found [here](https://github.com/KaiDMML/FakeNewsNet/)
* The implementation of GraphSage from which this code was adapted can be found [here](https://github.com/twjiang/graphSAGE-pytorch)

## Cite
Please cite our paper as below if you use this code in your work:

```
@inproceedings{10.1145/3340531.3412046,
author = {Nguyen, Van-Hoang and Sugiyama, Kazunari and Nakov, Preslav and Kan, Min-Yen},
title = {FANG: Leveraging Social Context for Fake News Detection Using Graph Representation},
year = {2020},
isbn = {9781450368599},
publisher = {Association for Computing Machinery},
address = {New York, NY, USA},
url = {https://doi.org/10.1145/3340531.3412046},
doi = {10.1145/3340531.3412046},
abstract = {We propose Factual News Graph (FANG), a novel graphical social context representation and learning framework for fake news detection. Unlike previous contextual models that have targeted performance, our focus is on representation learning. Compared to transductive models, FANG is scalable in training as it does not have to maintain all nodes, and it is efficient at inference time, without the need to re-process the entire graph. Our experimental results show that FANG is better at capturing the social context into a high fidelity representation, compared to recent graphical and non-graphical models. In particular, FANG yields significant improvements for the task of fake news detection, and it is robust in the case of limited training data. We further demonstrate that the representations learned by FANG generalize to related tasks, such as predicting the factuality of reporting of a news medium.},
booktitle = {Proceedings of the 29th ACM International Conference on Information &amp; Knowledge Management},
pages = {1165–1174},
numpages = {10},
keywords = {representation learning, fake news, social networks, graph neural networks, disinformation},
location = {Virtual Event, Ireland},
series = {CIKM '20}
}
```

real	0m0,003s
user	0m0,003s
sys	0m0,000s
(test) ]0;sejmou@sejmou-desktop: ~/Repos/Uni/ExpDesDS/FANG[01;32msejmou@sejmou-desktop[00m:[01;34m~/Repos/Uni/ExpDesDS/FANG[00m$ time python run_graph.py -t fang -m graph_sage -p data/news_graph --percent 90 --epochs=30 --attention --use-stance --use-proximity --temporal
^[[D^[[D^[[D^[[D^[[D^[[D^[[D^[[D^[[D^[[D^[[D^[[D^[[DUsing stance
Using proximity
Load FANG dataset from data/news_graph
^[[D^[[D^[[D^[[D^[[D^[[D^[[D^[[D^[[D^CTraceback (most recent call last):
  File "run_graph.py", line 67, in <module>
    fang(p_args)
  File "run_graph.py", line 55, in fang
    pretrained_dir=args.pretrained_dir, pretrained_step=args.pretrained_step)
  File "/home/sejmou/Repos/Uni/ExpDesDS/FANG/fang/graphsage/__init__.py", line 223, in run_fang_graph_sage
    load_single(run_config, fang_config, is_community)
  File "/home/sejmou/Repos/Uni/ExpDesDS/FANG/fang/graphsage/__init__.py", line 31, in load_single
    data = FangGraphSageDataset(fang_config, is_community)
  File "/home/sejmou/Repos/Uni/ExpDesDS/FANG/fang/dataset.py", line 37, in __init__
    self.load(inference)
  File "/home/sejmou/Repos/Uni/ExpDesDS/FANG/fang/dataset.py", line 90, in load
    feature_data = [[float(x) for x in row[1:]] for row in feature_content]
  File "/home/sejmou/Repos/Uni/ExpDesDS/FANG/fang/dataset.py", line 90, in <listcomp>
    feature_data = [[float(x) for x in row[1:]] for row in feature_content]
  File "/home/sejmou/Repos/Uni/ExpDesDS/FANG/fang/dataset.py", line 90, in <listcomp>
    feature_data = [[float(x) for x in row[1:]] for row in feature_content]
KeyboardInterrupt

real	0m5,314s
user	0m3,903s
sys	0m0,445s
(test) ]0;sejmou@sejmou-desktop: ~/Repos/Uni/ExpDesDS/FANG[01;32msejmou@sejmou-desktop[00m:[01;34m~/Repos/Uni/ExpDesDS/FANG[00m$ time python run_graph.py -t fang -m graph_sage -p data/news_graph --percent 90 --epochs=30 --attention --use-stance --use-proximity --temporal[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[1P[1P[1@1[1@0
Using stance
Using proximity
Load FANG dataset from data/news_graph
/home/sejmou/Repos/Uni/ExpDesDS/FANG/fang/utils.py:98: RuntimeWarning: divide by zero encountered in power
  sum_inv = np.power(row_sum, -1).flatten()
Loading cache
Use temporal
Initialize optimizer with weight decay 0.0005
Train 55026 Dev 466 Test 465
Training GraphSage:   0%|                                                                                                                                                           | 0/30 [00:00<?, ?it/s]
Sampling news batches:   0%|                                                                                                                                                        | 0/94 [00:00<?, ?it/s][A{'grad': 2.731378674507141, 'context_loss': 7.984857082366943, 'stance_loss': 1.4197192192077637, 'news_loss': 0.6196579933166504}


Validating rep learning:   0%|                                                                                                                                                    | 0/2211 [00:00<?, ?it/s][A[A

Validating rep learning:   9%|███████████▉                                                                                                                            | 195/2211 [00:00<00:01, 1942.79it/s][A[A

Validating rep learning:  18%|█████████████████████████                                                                                                               | 408/2211 [00:00<00:00, 1994.20it/s][A[A

Validating rep learning:  28%|██████████████████████████████████████▎                                                                                                 | 622/2211 [00:00<00:00, 2033.94it/s][A[A

Validating rep learning:  37%|██████████████████████████████████████████████████▊                                                                                     | 826/2211 [00:00<00:00, 2033.09it/s][A[A

Validating rep learning:  46%|██████████████████████████████████████████████████████████████▊                                                                        | 1028/2211 [00:00<00:00, 2028.73it/s][A[A

Validating rep learning:  56%|██████████████████████████████████████████████████████████████████████████▉                                                            | 1228/2211 [00:00<00:00, 2019.40it/s][A[A

Validating rep learning:  64%|███████████████████████████████████████████████████████████████████████████████████████                                                | 1426/2211 [00:00<00:00, 2005.35it/s][A[A

Validating rep learning:  73%|███████████████████████████████████████████████████████████████████████████████████████████████████▏                                   | 1624/2211 [00:00<00:00, 1997.27it/s][A[A

Validating rep learning:  82%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████▏                       | 1822/2211 [00:00<00:00, 1990.41it/s][A[A

Validating rep learning:  91%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▎           | 2019/2211 [00:01<00:00, 1983.08it/s][A[AValidating rep learning: 100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 2211/2211 [00:01<00:00, 2011.13it/s]
{'stance_avg_closed_ratio': 0.9715869484264399, 'stance_avg_far_ratio': 0.9694062036851598, 'other_avg_closed_ratio': 1.121694470716749, 'other_avg_far_ratio': 0.0}

Sampling news batches:   1%|█▌                                                                                                                                            | 1/94 [01:18<2:02:26, 78.99s/it][A
Sampling news batches:   2%|███                                                                                                                                           | 2/94 [01:40<1:34:46, 61.81s/it][A
Sampling news batches:   3%|████▌                                                                                                                                         | 3/94 [02:04<1:16:35, 50.50s/it][A
Sampling news batches:   4%|██████                                                                                                                                        | 4/94 [02:22<1:00:57, 40.64s/it][A
Sampling news batches:   5%|███████▋                                                                                                                                        | 5/94 [02:45<52:24, 35.34s/it][A
Sampling news batches:   6%|█████████▏                                                                                                                                      | 6/94 [03:01<43:34, 29.71s/it][A
Sampling news batches:   7%|██████████▋                                                                                                                                     | 7/94 [03:25<40:13, 27.74s/it][A
Sampling news batches:   9%|████████████▎                                                                                                                                   | 8/94 [03:44<36:12, 25.26s/it][A
Sampling news batches:  10%|█████████████▊                                                                                                                                  | 9/94 [04:02<32:41, 23.08s/it][A
Sampling news batches:  11%|███████████████▏                                                                                                                               | 10/94 [04:23<31:22, 22.41s/it][A
Sampling news batches:  12%|████████████████▋                                                                                                                              | 11/94 [04:44<30:26, 22.01s/it][A
Sampling news batches:  13%|██████████████████▎                                                                                                                            | 12/94 [05:02<28:30, 20.86s/it][A
Sampling news batches:  14%|███████████████████▊                                                                                                                           | 13/94 [05:23<28:10, 20.87s/it][A
Sampling news batches:  15%|█████████████████████▎                                                                                                                         | 14/94 [05:43<27:21, 20.52s/it][A
Sampling news batches:  16%|██████████████████████▊                                                                                                                        | 15/94 [06:04<27:29, 20.88s/it][A
Sampling news batches:  17%|████████████████████████▎                                                                                                                      | 16/94 [06:23<26:18, 20.24s/it][A
Sampling news batches:  18%|█████████████████████████▊                                                                                                                     | 17/94 [06:49<28:08, 21.92s/it][A
Sampling news batches:  19%|███████████████████████████▍                                                                                                                   | 18/94 [07:12<28:07, 22.21s/it][A
Sampling news batches:  20%|████████████████████████████▉                                                                                                                  | 19/94 [07:34<27:44, 22.19s/it][A
Sampling news batches:  21%|██████████████████████████████▍                                                                                                                | 20/94 [07:54<26:20, 21.36s/it][A
Sampling news batches:  22%|███████████████████████████████▉                                                                                                               | 21/94 [08:15<26:06, 21.46s/it][A
Sampling news batches:  23%|█████████████████████████████████▍                                                                                                             | 22/94 [08:36<25:27, 21.21s/it][A
Sampling news batches:  24%|██████████████████████████████████▉                                                                                                            | 23/94 [08:53<23:34, 19.92s/it][A
Sampling news batches:  26%|████████████████████████████████████▌                                                                                                          | 24/94 [09:08<21:44, 18.64s/it][A
Sampling news batches:  27%|██████████████████████████████████████                                                                                                         | 25/94 [09:29<22:00, 19.14s/it][A
Sampling news batches:  28%|███████████████████████████████████████▌                                                                                                       | 26/94 [09:46<20:56, 18.48s/it][A
Sampling news batches:  29%|█████████████████████████████████████████                                                                                                      | 27/94 [10:08<22:04, 19.77s/it][A
Sampling news batches:  30%|██████████████████████████████████████████▌                                                                                                    | 28/94 [10:29<21:53, 19.90s/it][A
Sampling news batches:  31%|████████████████████████████████████████████                                                                                                   | 29/94 [10:48<21:23, 19.74s/it][A
Sampling news batches:  32%|█████████████████████████████████████████████▋                                                                                                 | 30/94 [11:12<22:16, 20.88s/it][A
Sampling news batches:  33%|███████████████████████████████████████████████▏                                                                                               | 31/94 [11:33<22:13, 21.16s/it][A
Sampling news batches:  34%|████████████████████████████████████████████████▋                                                                                              | 32/94 [11:56<22:16, 21.55s/it][A
Sampling news batches:  35%|██████████████████████████████████████████████████▏                                                                                            | 33/94 [12:13<20:24, 20.08s/it][A
Sampling news batches:  36%|███████████████████████████████████████████████████▋                                                                                           | 34/94 [12:35<20:51, 20.86s/it][A
Sampling news batches:  37%|█████████████████████████████████████████████████████▏                                                                                         | 35/94 [12:51<19:00, 19.33s/it][A
Sampling news batches:  38%|██████████████████████████████████████████████████████▊                                                                                        | 36/94 [13:08<18:08, 18.77s/it][A
Sampling news batches:  39%|████████████████████████████████████████████████████████▎                                                                                      | 37/94 [13:29<18:13, 19.18s/it][A
Sampling news batches:  40%|█████████████████████████████████████████████████████████▊                                                                                     | 38/94 [13:44<16:59, 18.21s/it][A
Sampling news batches:  41%|███████████████████████████████████████████████████████████▎                                                                                   | 39/94 [14:04<17:02, 18.59s/it][A
Sampling news batches:  43%|████████████████████████████████████████████████████████████▊                                                                                  | 40/94 [14:30<18:41, 20.77s/it][A{'grad': 2.3944867849349976, 'context_loss': 7.824466371536255, 'stance_loss': 1.3801974385976792, 'news_loss': 0.6680029267445207}


Validating rep learning:   0%|                                                                                                                                                    | 0/2211 [00:00<?, ?it/s][A[A

Validating rep learning:   9%|███████████▋                                                                                                                            | 189/2211 [00:00<00:01, 1887.62it/s][A[A

Validating rep learning:  18%|████████████████████████▊                                                                                                               | 404/2211 [00:00<00:00, 1958.07it/s][A[A

Validating rep learning:  28%|█████████████████████████████████████▉                                                                                                  | 616/2211 [00:00<00:00, 2001.48it/s][A[A

Validating rep learning:  37%|██████████████████████████████████████████████████▌                                                                                     | 822/2211 [00:00<00:00, 2017.22it/s][A[A

Validating rep learning:  46%|██████████████████████████████████████████████████████████████▌                                                                        | 1025/2211 [00:00<00:00, 2020.05it/s][A[A

Validating rep learning:  55%|██████████████████████████████████████████████████████████████████████████▋                                                            | 1223/2211 [00:00<00:00, 2007.47it/s][A[A

Validating rep learning:  64%|██████████████████████████████████████████████████████████████████████████████████████▊                                                | 1421/2211 [00:00<00:00, 1997.70it/s][A[A

Validating rep learning:  73%|██████████████████████████████████████████████████████████████████████████████████████████████████▊                                    | 1619/2211 [00:00<00:00, 1991.66it/s][A[A

Validating rep learning:  82%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████▉                        | 1817/2211 [00:00<00:00, 1985.67it/s][A[A

Validating rep learning:  91%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████            | 2015/2211 [00:01<00:00, 1983.43it/s][A[AValidating rep learning: 100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 2211/2211 [00:01<00:00, 2006.87it/s]
{'stance_avg_closed_ratio': 0.9738796604115639, 'stance_avg_far_ratio': 0.9874844265414526, 'other_avg_closed_ratio': 0.9417998448003435, 'other_avg_far_ratio': 0.0}

Sampling news batches:  44%|██████████████████████████████████████████████████████████████▎                                                                                | 41/94 [15:46<32:55, 37.26s/it][A
Sampling news batches:  45%|███████████████████████████████████████████████████████████████▉                                                                               | 42/94 [16:06<27:51, 32.15s/it][A
Sampling news batches:  46%|█████████████████████████████████████████████████████████████████▍                                                                             | 43/94 [16:29<25:06, 29.54s/it][A
Sampling news batches:  47%|██████████████████████████████████████████████████████████████████▉                                                                            | 44/94 [16:44<21:01, 25.22s/it][A
Sampling news batches:  48%|████████████████████████████████████████████████████████████████████▍                                                                          | 45/94 [17:06<19:36, 24.00s/it][A
Sampling news batches:  49%|█████████████████████████████████████████████████████████████████████▉                                                                         | 46/94 [17:26<18:15, 22.82s/it][A
Sampling news batches:  50%|███████████████████████████████████████████████████████████████████████▌                                                                       | 47/94 [17:42<16:25, 20.98s/it][A
Sampling news batches:  51%|█████████████████████████████████████████████████████████████████████████                                                                      | 48/94 [18:07<16:56, 22.10s/it][A
Sampling news batches:  52%|██████████████████████████████████████████████████████████████████████████▌                                                                    | 49/94 [18:21<14:49, 19.76s/it][A
Sampling news batches:  53%|████████████████████████████████████████████████████████████████████████████                                                                   | 50/94 [18:42<14:46, 20.14s/it][A
Sampling news batches:  54%|█████████████████████████████████████████████████████████████████████████████▌                                                                 | 51/94 [19:05<15:00, 20.94s/it][A
Sampling news batches:  55%|███████████████████████████████████████████████████████████████████████████████                                                                | 52/94 [19:24<14:18, 20.45s/it][A
Sampling news batches:  56%|████████████████████████████████████████████████████████████████████████████████▋                                                              | 53/94 [19:47<14:21, 21.00s/it][A
Sampling news batches:  57%|██████████████████████████████████████████████████████████████████████████████████▏                                                            | 54/94 [20:06<13:41, 20.54s/it][A
Sampling news batches:  59%|███████████████████████████████████████████████████████████████████████████████████▋                                                           | 55/94 [20:29<13:52, 21.34s/it][A
Sampling news batches:  60%|█████████████████████████████████████████████████████████████████████████████████████▏                                                         | 56/94 [20:49<13:06, 20.70s/it][A
Sampling news batches:  61%|██████████████████████████████████████████████████████████████████████████████████████▋                                                        | 57/94 [21:13<13:25, 21.78s/it][A
Sampling news batches:  62%|████████████████████████████████████████████████████████████████████████████████████████▏                                                      | 58/94 [21:29<11:58, 19.97s/it][A
Sampling news batches:  63%|█████████████████████████████████████████████████████████████████████████████████████████▊                                                     | 59/94 [21:48<11:34, 19.85s/it][A
Sampling news batches:  64%|███████████████████████████████████████████████████████████████████████████████████████████▎                                                   | 60/94 [22:05<10:44, 18.96s/it][A
Sampling news batches:  65%|████████████████████████████████████████████████████████████████████████████████████████████▊                                                  | 61/94 [22:26<10:49, 19.68s/it][A
Sampling news batches:  66%|██████████████████████████████████████████████████████████████████████████████████████████████▎                                                | 62/94 [22:45<10:23, 19.48s/it][A
Sampling news batches:  67%|███████████████████████████████████████████████████████████████████████████████████████████████▊                                               | 63/94 [23:01<09:26, 18.26s/it][A
Sampling news batches:  68%|█████████████████████████████████████████████████████████████████████████████████████████████████▎                                             | 64/94 [23:23<09:39, 19.33s/it][A
Sampling news batches:  69%|██████████████████████████████████████████████████████████████████████████████████████████████████▉                                            | 65/94 [23:43<09:28, 19.59s/it][A
Sampling news batches:  70%|████████████████████████████████████████████████████████████████████████████████████████████████████▍                                          | 66/94 [24:09<10:05, 21.63s/it][A
Sampling news batches:  71%|█████████████████████████████████████████████████████████████████████████████████████████████████████▉                                         | 67/94 [24:29<09:31, 21.16s/it][A
Sampling news batches:  72%|███████████████████████████████████████████████████████████████████████████████████████████████████████▍                                       | 68/94 [24:56<09:50, 22.72s/it][A
Sampling news batches:  73%|████████████████████████████████████████████████████████████████████████████████████████████████████████▉                                      | 69/94 [25:11<08:30, 20.43s/it][A
Sampling news batches:  74%|██████████████████████████████████████████████████████████████████████████████████████████████████████████▍                                    | 70/94 [25:36<08:43, 21.80s/it][A
Sampling news batches:  76%|████████████████████████████████████████████████████████████████████████████████████████████████████████████                                   | 71/94 [25:54<07:55, 20.69s/it][A
Sampling news batches:  77%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████▌                                 | 72/94 [26:16<07:45, 21.17s/it][A
Sampling news batches:  78%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████                                | 73/94 [26:39<07:35, 21.69s/it][A
Sampling news batches:  79%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████▌                              | 74/94 [27:07<07:48, 23.40s/it][A
Sampling news batches:  80%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████                             | 75/94 [27:27<07:09, 22.63s/it][A
Sampling news batches:  81%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████▌                           | 76/94 [27:55<07:14, 24.14s/it][A
Sampling news batches:  82%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▏                         | 77/94 [28:20<06:55, 24.45s/it][A
Sampling news batches:  83%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▋                        | 78/94 [29:02<07:53, 29.58s/it][A
Sampling news batches:  84%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▏                      | 79/94 [29:25<06:53, 27.59s/it][A
Sampling news batches:  85%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▋                     | 80/94 [29:59<06:53, 29.51s/it][A{'grad': 1.1074402034282684, 'context_loss': 7.751325178146362, 'stance_loss': 1.3711838215589522, 'news_loss': 0.6598427603642146}


Validating rep learning:   0%|                                                                                                                                                    | 0/2211 [00:00<?, ?it/s][A[A

Validating rep learning:   8%|███████████▌                                                                                                                            | 187/2211 [00:00<00:01, 1869.45it/s][A[A

Validating rep learning:  18%|████████████████████████▌                                                                                                               | 400/2211 [00:00<00:00, 1939.08it/s][A[A

Validating rep learning:  27%|█████████████████████████████████████▎                                                                                                  | 607/2211 [00:00<00:00, 1974.54it/s][A[A

Validating rep learning:  35%|████████████████████████████████████████████████                                                                                        | 782/2211 [00:00<00:00, 1900.99it/s][A[A

Validating rep learning:  44%|████████████████████████████████████████████████████████████                                                                            | 977/2211 [00:00<00:00, 1912.62it/s][A[A

Validating rep learning:  53%|███████████████████████████████████████████████████████████████████████▊                                                               | 1176/2211 [00:00<00:00, 1935.06it/s][A[A

Validating rep learning:  62%|███████████████████████████████████████████████████████████████████████████████████▌                                                   | 1369/2211 [00:00<00:00, 1931.53it/s][A[A

Validating rep learning:  71%|███████████████████████████████████████████████████████████████████████████████████████████████▏                                       | 1559/2211 [00:00<00:00, 1919.62it/s][A[A

Validating rep learning:  79%|███████████████████████████████████████████████████████████████████████████████████████████████████████████▏                           | 1755/2211 [00:00<00:00, 1931.33it/s][A[A

Validating rep learning:  88%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████                | 1951/2211 [00:01<00:00, 1937.85it/s][A[A

Validating rep learning:  97%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████    | 2146/2211 [00:01<00:00, 1939.13it/s][A[AValidating rep learning: 100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 2211/2211 [00:01<00:00, 1944.76it/s]
{'stance_avg_closed_ratio': 0.9700161236075064, 'stance_avg_far_ratio': 0.9545489660794552, 'other_avg_closed_ratio': 0.9648957240889876, 'other_avg_far_ratio': 0.0}

Sampling news batches:  86%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▏                   | 81/94 [31:23<09:55, 45.83s/it][A
Sampling news batches:  87%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▋                  | 82/94 [31:47<07:53, 39.42s/it][A
Sampling news batches:  88%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▎                | 83/94 [32:31<07:28, 40.80s/it][A
Sampling news batches:  89%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▊               | 84/94 [33:34<07:55, 47.57s/it][A
Sampling news batches:  90%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▎             | 85/94 [33:55<05:56, 39.57s/it][A
Sampling news batches:  91%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▊            | 86/94 [35:08<06:34, 49.36s/it][A
Sampling news batches:  93%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▎          | 87/94 [35:33<04:54, 42.14s/it][A
Sampling news batches:  94%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▊         | 88/94 [36:18<04:18, 43.02s/it][A
Sampling news batches:  95%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▍       | 89/94 [36:43<03:07, 37.58s/it][A
Sampling news batches:  96%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▉      | 90/94 [37:27<02:38, 39.60s/it][A
Sampling news batches:  97%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▍    | 91/94 [37:51<01:44, 34.79s/it][A
Sampling news batches:  98%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▉   | 92/94 [38:58<01:29, 44.65s/it][A
Sampling news batches:  99%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▍ | 93/94 [39:18<00:37, 37.14s/it][A
Sampling news batches: 100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 94/94 [39:52<00:00, 36.20s/it][ASampling news batches: 100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 94/94 [39:52<00:00, 25.45s/it]
Validating
Training GraphSage:   0%|                                                                                                                                                           | 0/30 [49:53<?, ?it/s]
Traceback (most recent call last):
  File "run_graph.py", line 67, in <module>
    fang(p_args)
  File "run_graph.py", line 55, in fang
    pretrained_dir=args.pretrained_dir, pretrained_step=args.pretrained_step)
  File "/home/sejmou/Repos/Uni/ExpDesDS/FANG/fang/graphsage/__init__.py", line 227, in run_fang_graph_sage
    n_nodes, input_size, pretrained_dir, pretrained_step)
  File "/home/sejmou/Repos/Uni/ExpDesDS/FANG/fang/graphsage/__init__.py", line 631, in train_fn
    writer, device, tag="validate")
  File "/home/sejmou/Repos/Uni/ExpDesDS/FANG/fang/graphsage/__init__.py", line 709, in eval_fn
    embed_size, device, cutoff_range, test=True)
  File "/home/sejmou/Repos/Uni/ExpDesDS/FANG/fang/graphsage/__init__.py", line 741, in preprocess_news_classification_data
    else torch.zeros(1, embed_size).to(device) for e_users in engage_users_batch]
  File "/home/sejmou/Repos/Uni/ExpDesDS/FANG/fang/graphsage/__init__.py", line 741, in <listcomp>
    else torch.zeros(1, embed_size).to(device) for e_users in engage_users_batch]
  File "/home/sejmou/anaconda3/envs/test/lib/python3.7/site-packages/torch/nn/modules/module.py", line 550, in __call__
    result = self.forward(*input, **kwargs)
  File "/home/sejmou/Repos/Uni/ExpDesDS/FANG/user_embed/graphsage/models.py", line 55, in forward
    aggregate_feats = self.aggregate(nb, pre_hidden_embs, pre_neighs)
  File "/home/sejmou/Repos/Uni/ExpDesDS/FANG/user_embed/graphsage/models.py", line 121, in aggregate
    mask = mask.div(num_neigh).to(embed_matrix.device)
RuntimeError: CUDA out of memory. Tried to allocate 2.40 GiB (GPU 0; 5.93 GiB total capacity; 469.63 MiB already allocated; 1.07 GiB free; 4.09 GiB reserved in total by PyTorch)
^C

real	53m26,672s
user	67m24,858s
sys	21m58,361s
(test) ]0;sejmou@sejmou-desktop: ~/Repos/Uni/ExpDesDS/FANG[01;32msejmou@sejmou-desktop[00m:[01;34m~/Repos/Uni/ExpDesDS/FANG[00m$ time python run_graph.py -t fang -m graph_sage -p data/news_graph --percent 10 --epochs=30 --attention --use-stance --use-proximity --temporal
Using stance
Using proximity
Load FANG dataset from data/news_graph
/home/sejmou/Repos/Uni/ExpDesDS/FANG/fang/utils.py:98: RuntimeWarning: divide by zero encountered in power
  sum_inv = np.power(row_sum, -1).flatten()
Loading cache
Use temporal
Initialize optimizer with weight decay 0.0005
Train 55026 Dev 466 Test 465
Training GraphSage:   0%|                                                                                                                                                           | 0/30 [00:00<?, ?it/s]
Sampling news batches:   0%|                                                                                                                                                       | 0/187 [00:00<?, ?it/s][A{'grad': 1.9890191555023193, 'context_loss': 7.950969696044922, 'stance_loss': 1.3828717470169067, 'news_loss': 0.6532542705535889}


Validating rep learning:   0%|                                                                                                                                                    | 0/2211 [00:00<?, ?it/s][A[A

Validating rep learning:   9%|████████████▋                                                                                                                           | 206/2211 [00:00<00:00, 2058.26it/s][A[A

Validating rep learning:  20%|██████████████████████████▊                                                                                                             | 435/2211 [00:00<00:00, 2122.35it/s][A[A

Validating rep learning:  29%|███████████████████████████████████████▉                                                                                                | 649/2211 [00:00<00:00, 2125.02it/s][A[A

Validating rep learning:  39%|████████████████████████████████████████████████████▍                                                                                   | 852/2211 [00:00<00:00, 2092.81it/s][A[A

Validating rep learning:  48%|████████████████████████████████████████████████████████████████▍                                                                      | 1056/2211 [00:00<00:00, 2074.94it/s][A[A

Validating rep learning:  57%|████████████████████████████████████████████████████████████████████████████▋                                                          | 1255/2211 [00:00<00:00, 2047.75it/s][A[A

Validating rep learning:  66%|████████████████████████████████████████████████████████████████████████████████████████▋                                              | 1453/2211 [00:00<00:00, 2026.91it/s][A[A

Validating rep learning:  75%|████████████████████████████████████████████████████████████████████████████████████████████████████▉                                  | 1654/2211 [00:00<00:00, 2020.21it/s][A[A

Validating rep learning:  84%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████▏                     | 1854/2211 [00:00<00:00, 2011.63it/s][A[A

Validating rep learning:  93%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▍         | 2055/2211 [00:01<00:00, 2008.60it/s][A[AValidating rep learning: 100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 2211/2211 [00:01<00:00, 2044.60it/s]
{'stance_avg_closed_ratio': 0.9946204661990605, 'stance_avg_far_ratio': 1.0041652304168651, 'other_avg_closed_ratio': 1.05941964068365, 'other_avg_far_ratio': 0.0}

Sampling news batches:   1%|▊                                                                                                                                            | 1/187 [01:03<3:17:21, 63.66s/it][A
Sampling news batches:   1%|█▌                                                                                                                                           | 2/187 [01:15<2:28:27, 48.15s/it][A
Sampling news batches:   2%|██▎                                                                                                                                          | 3/187 [01:28<1:55:32, 37.68s/it][A
Sampling news batches:   2%|███                                                                                                                                          | 4/187 [01:36<1:27:51, 28.81s/it][A
Sampling news batches:   3%|███▊                                                                                                                                         | 5/187 [01:47<1:10:44, 23.32s/it][A
Sampling news batches:   3%|████▌                                                                                                                                          | 6/187 [01:56<57:25, 19.04s/it][A
Sampling news batches:   4%|█████▎                                                                                                                                         | 7/187 [02:05<47:42, 15.90s/it][A
Sampling news batches:   4%|██████                                                                                                                                         | 8/187 [02:18<45:18, 15.19s/it][A
Sampling news batches:   5%|██████▉                                                                                                                                        | 9/187 [02:35<46:24, 15.64s/it][A
Sampling news batches:   5%|███████▌                                                                                                                                      | 10/187 [02:46<42:03, 14.26s/it][A
Sampling news batches:   6%|████████▎                                                                                                                                     | 11/187 [02:58<39:39, 13.52s/it][A
Sampling news batches:   6%|█████████                                                                                                                                     | 12/187 [03:11<39:40, 13.60s/it][A
Sampling news batches:   7%|█████████▊                                                                                                                                    | 13/187 [03:22<36:39, 12.64s/it][A
Sampling news batches:   7%|██████████▋                                                                                                                                   | 14/187 [03:32<34:35, 11.99s/it][A
Sampling news batches:   8%|███████████▍                                                                                                                                  | 15/187 [03:39<30:09, 10.52s/it][A
Sampling news batches:   9%|████████████▏                                                                                                                                 | 16/187 [03:52<32:02, 11.24s/it][A
Sampling news batches:   9%|████████████▉                                                                                                                                 | 17/187 [04:03<31:27, 11.11s/it][A
Sampling news batches:  10%|█████████████▋                                                                                                                                | 18/187 [04:15<31:33, 11.20s/it][A
Sampling news batches:  10%|██████████████▍                                                                                                                               | 19/187 [04:26<31:40, 11.32s/it][A
Sampling news batches:  11%|███████████████▏                                                                                                                              | 20/187 [04:34<28:47, 10.35s/it][A
Sampling news batches:  11%|███████████████▉                                                                                                                              | 21/187 [04:46<29:46, 10.76s/it][A
Sampling news batches:  12%|████████████████▋                                                                                                                             | 22/187 [05:00<32:00, 11.64s/it][A
Sampling news batches:  12%|█████████████████▍                                                                                                                            | 23/187 [05:08<29:30, 10.80s/it][A
Sampling news batches:  13%|██████████████████▏                                                                                                                           | 24/187 [05:18<27:59, 10.30s/it][A
Sampling news batches:  13%|██████████████████▉                                                                                                                           | 25/187 [05:26<26:22,  9.77s/it][A
Sampling news batches:  14%|███████████████████▋                                                                                                                          | 26/187 [05:40<29:16, 10.91s/it][A
Sampling news batches:  14%|████████████████████▌                                                                                                                         | 27/187 [05:50<28:13, 10.58s/it][A
Sampling news batches:  15%|█████████████████████▎                                                                                                                        | 28/187 [05:59<27:09, 10.25s/it][A
Sampling news batches:  16%|██████████████████████                                                                                                                        | 29/187 [06:12<28:51, 10.96s/it][A
Sampling news batches:  16%|██████████████████████▊                                                                                                                       | 30/187 [06:21<27:30, 10.51s/it][A
Sampling news batches:  17%|███████████████████████▌                                                                                                                      | 31/187 [06:28<24:34,  9.45s/it][A
Sampling news batches:  17%|████████████████████████▎                                                                                                                     | 32/187 [06:43<28:29, 11.03s/it][A
Sampling news batches:  18%|█████████████████████████                                                                                                                     | 33/187 [06:51<26:05, 10.16s/it][A
Sampling news batches:  18%|█████████████████████████▊                                                                                                                    | 34/187 [07:01<25:28,  9.99s/it][A
Sampling news batches:  19%|██████████████████████████▌                                                                                                                   | 35/187 [07:11<25:29, 10.06s/it][A
Sampling news batches:  19%|███████████████████████████▎                                                                                                                  | 36/187 [07:23<26:52, 10.68s/it][A
Sampling news batches:  20%|████████████████████████████                                                                                                                  | 37/187 [07:31<25:04, 10.03s/it][A
Sampling news batches:  20%|████████████████████████████▊                                                                                                                 | 38/187 [07:41<24:44,  9.96s/it][A
Sampling news batches:  21%|█████████████████████████████▌                                                                                                                | 39/187 [07:51<24:22,  9.88s/it][A
Sampling news batches:  21%|██████████████████████████████▎                                                                                                               | 40/187 [08:04<26:14, 10.71s/it][A{'grad': 2.1754977107048035, 'context_loss': 7.886634087562561, 'stance_loss': 1.3645452708005905, 'news_loss': 0.7199431035829627}


Validating rep learning:   0%|                                                                                                                                                    | 0/2211 [00:00<?, ?it/s][A[A

Validating rep learning:   9%|████████████▌                                                                                                                           | 205/2211 [00:00<00:00, 2048.01it/s][A[A

Validating rep learning:  20%|██████████████████████████▌                                                                                                             | 432/2211 [00:00<00:00, 2109.37it/s][A[A

Validating rep learning:  29%|███████████████████████████████████████▍                                                                                                | 642/2211 [00:00<00:00, 2104.64it/s][A[A

Validating rep learning:  38%|████████████████████████████████████████████████████▏                                                                                   | 848/2211 [00:00<00:00, 2090.79it/s][A[A

Validating rep learning:  48%|████████████████████████████████████████████████████████████████▏                                                                      | 1052/2211 [00:00<00:00, 2074.99it/s][A[A

Validating rep learning:  57%|████████████████████████████████████████████████████████████████████████████▌                                                          | 1253/2211 [00:00<00:00, 2053.56it/s][A[A

Validating rep learning:  66%|████████████████████████████████████████████████████████████████████████████████████████▋                                              | 1452/2211 [00:00<00:00, 2031.90it/s][A[A

Validating rep learning:  75%|████████████████████████████████████████████████████████████████████████████████████████████████████▊                                  | 1652/2211 [00:00<00:00, 2020.44it/s][A[A

Validating rep learning:  84%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████                      | 1851/2211 [00:00<00:00, 2011.00it/s][A[A

Validating rep learning:  93%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▏         | 2051/2211 [00:01<00:00, 2004.78it/s][A[AValidating rep learning: 100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 2211/2211 [00:01<00:00, 2042.88it/s]
{'stance_avg_closed_ratio': 0.9885001390617654, 'stance_avg_far_ratio': 0.9695489102034228, 'other_avg_closed_ratio': 1.0092236500274117, 'other_avg_far_ratio': 0.0}

Sampling news batches:  22%|██████████████████████████████▋                                                                                                             | 41/187 [09:06<1:04:07, 26.35s/it][A
Sampling news batches:  22%|███████████████████████████████▉                                                                                                              | 42/187 [09:18<53:15, 22.04s/it][A
Sampling news batches:  23%|████████████████████████████████▋                                                                                                             | 43/187 [09:29<44:27, 18.52s/it][A
Sampling news batches:  24%|█████████████████████████████████▍                                                                                                            | 44/187 [09:37<37:09, 15.59s/it][A
Sampling news batches:  24%|██████████████████████████████████▏                                                                                                           | 45/187 [09:51<35:47, 15.13s/it][A
Sampling news batches:  25%|██████████████████████████████████▉                                                                                                           | 46/187 [10:01<31:34, 13.43s/it][A
Sampling news batches:  25%|███████████████████████████████████▋                                                                                                          | 47/187 [10:11<29:02, 12.45s/it][A
Sampling news batches:  26%|████████████████████████████████████▍                                                                                                         | 48/187 [10:24<29:03, 12.54s/it][A
Sampling news batches:  26%|█████████████████████████████████████▏                                                                                                        | 49/187 [10:32<25:36, 11.13s/it][A
Sampling news batches:  27%|█████████████████████████████████████▉                                                                                                        | 50/187 [10:43<25:19, 11.09s/it][A
Sampling news batches:  27%|██████████████████████████████████████▋                                                                                                       | 51/187 [10:52<23:39, 10.44s/it][A
Sampling news batches:  28%|███████████████████████████████████████▍                                                                                                      | 52/187 [11:00<22:07,  9.83s/it][A
Sampling news batches:  28%|████████████████████████████████████████▏                                                                                                     | 53/187 [11:13<23:46, 10.64s/it][A
Sampling news batches:  29%|█████████████████████████████████████████                                                                                                     | 54/187 [11:20<21:32,  9.72s/it][A
Sampling news batches:  29%|█████████████████████████████████████████▊                                                                                                    | 55/187 [11:30<21:36,  9.82s/it][A
Sampling news batches:  30%|██████████████████████████████████████████▌                                                                                                   | 56/187 [11:43<23:15, 10.65s/it][A
Sampling news batches:  30%|███████████████████████████████████████████▎                                                                                                  | 57/187 [11:55<23:50, 11.00s/it][A
Sampling news batches:  31%|████████████████████████████████████████████                                                                                                  | 58/187 [12:05<23:11, 10.78s/it][A
Sampling news batches:  32%|████████████████████████████████████████████▊                                                                                                 | 59/187 [12:15<22:30, 10.55s/it][A
Sampling news batches:  32%|█████████████████████████████████████████████▌                                                                                                | 60/187 [12:27<23:05, 10.91s/it][A
Sampling news batches:  33%|██████████████████████████████████████████████▎                                                                                               | 61/187 [12:36<21:50, 10.40s/it][A
Sampling news batches:  33%|███████████████████████████████████████████████                                                                                               | 62/187 [12:45<21:08, 10.15s/it][A
Sampling news batches:  34%|███████████████████████████████████████████████▊                                                                                              | 63/187 [12:53<19:40,  9.52s/it][A
Sampling news batches:  34%|████████████████████████████████████████████████▌                                                                                             | 64/187 [13:05<20:50, 10.17s/it][A
Sampling news batches:  35%|█████████████████████████████████████████████████▎                                                                                            | 65/187 [13:17<21:59, 10.82s/it][A
Sampling news batches:  35%|██████████████████████████████████████████████████                                                                                            | 66/187 [13:26<20:26, 10.14s/it][A
Sampling news batches:  36%|██████████████████████████████████████████████████▉                                                                                           | 67/187 [13:41<23:28, 11.74s/it][A
Sampling news batches:  36%|███████████████████████████████████████████████████▋                                                                                          | 68/187 [13:53<22:53, 11.54s/it][A
Sampling news batches:  37%|████████████████████████████████████████████████████▍                                                                                         | 69/187 [14:04<22:39, 11.52s/it][A
Sampling news batches:  37%|█████████████████████████████████████████████████████▏                                                                                        | 70/187 [14:15<22:25, 11.50s/it][A
Sampling news batches:  38%|█████████████████████████████████████████████████████▉                                                                                        | 71/187 [14:28<22:36, 11.69s/it][A
Sampling news batches:  39%|██████████████████████████████████████████████████████▋                                                                                       | 72/187 [14:37<21:12, 11.07s/it][A
Sampling news batches:  39%|███████████████████████████████████████████████████████▍                                                                                      | 73/187 [14:49<21:40, 11.41s/it][A
Sampling news batches:  40%|████████████████████████████████████████████████████████▏                                                                                     | 74/187 [15:04<23:26, 12.45s/it][A{'grad': 1.7794546484947205, 'context_loss': 7.766295719146728, 'stance_loss': 1.3549016058444976, 'news_loss': 0.6599918752908707}


Validating rep learning:   0%|                                                                                                                                                    | 0/2211 [00:00<?, ?it/s][A[A

Validating rep learning:   9%|████████████▊                                                                                                                           | 209/2211 [00:00<00:00, 2086.06it/s][A[A

Validating rep learning:  20%|██████████████████████████▉                                                                                                             | 438/2211 [00:00<00:00, 2140.89it/s][A[A

Validating rep learning:  30%|████████████████████████████████████████▏                                                                                               | 653/2211 [00:00<00:00, 2141.97it/s][A[A

Validating rep learning:  37%|██████████████████████████████████████████████████▋                                                                                     | 824/2211 [00:00<00:00, 1989.17it/s][A[A

Validating rep learning:  46%|██████████████████████████████████████████████████████████████▎                                                                        | 1020/2211 [00:00<00:00, 1977.86it/s][A[A

Validating rep learning:  55%|██████████████████████████████████████████████████████████████████████████                                                             | 1212/2211 [00:00<00:00, 1958.49it/s][A[A

Validating rep learning:  64%|█████████████████████████████████████████████████████████████████████████████████████▉                                                 | 1407/2211 [00:00<00:00, 1955.59it/s][A[A

Validating rep learning:  73%|██████████████████████████████████████████████████████████████████████████████████████████████████                                     | 1606/2211 [00:00<00:00, 1965.53it/s][A[A

Validating rep learning:  82%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████▎                        | 1806/2211 [00:00<00:00, 1973.85it/s][A[A

Validating rep learning:  91%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▍            | 2006/2211 [00:01<00:00, 1979.75it/s][A[A

Validating rep learning: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▊| 2208/2211 [00:01<00:00, 1989.76it/s][A[AValidating rep learning: 100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 2211/2211 [00:01<00:00, 2001.37it/s]
{'stance_avg_closed_ratio': 0.9716025520187314, 'stance_avg_far_ratio': 0.9557209465174934, 'other_avg_closed_ratio': 1.103377536773404, 'other_avg_far_ratio': 0.0}
{'grad': 3.6158560514450073, 'context_loss': 7.763865971565247, 'stance_loss': 1.3468519806861878, 'news_loss': 0.6759158983826637}


Validating rep learning:   0%|                                                                                                                                                    | 0/2211 [00:00<?, ?it/s][A[A

Validating rep learning:   9%|████████████▋                                                                                                                           | 206/2211 [00:00<00:00, 2054.75it/s][A[A

Validating rep learning:  20%|██████████████████████████▋                                                                                                             | 434/2211 [00:00<00:00, 2115.31it/s][A[A

Validating rep learning:  29%|███████████████████████████████████████▌                                                                                                | 644/2211 [00:00<00:00, 2109.44it/s][A[A

Validating rep learning:  38%|███████████████████████████████████████████████████▊                                                                                    | 843/2211 [00:00<00:00, 2069.89it/s][A[A

Validating rep learning:  47%|███████████████████████████████████████████████████████████████▋                                                                       | 1043/2211 [00:00<00:00, 2047.15it/s][A[A

Validating rep learning:  56%|███████████████████████████████████████████████████████████████████████████▊                                                           | 1242/2211 [00:00<00:00, 2028.39it/s][A[A

Validating rep learning:  65%|███████████████████████████████████████████████████████████████████████████████████████▊                                               | 1439/2211 [00:00<00:00, 2009.38it/s][A[A

Validating rep learning:  74%|███████████████████████████████████████████████████████████████████████████████████████████████████▉                                   | 1637/2211 [00:00<00:00, 1999.81it/s][A[A

Validating rep learning:  83%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████▉                       | 1834/2211 [00:00<00:00, 1987.78it/s][A[A

Validating rep learning:  92%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████           | 2031/2211 [00:01<00:00, 1980.98it/s][A[AValidating rep learning: 100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 2211/2211 [00:01<00:00, 2020.71it/s]
{'stance_avg_closed_ratio': 0.9775671864622936, 'stance_avg_far_ratio': 0.9529071034871254, 'other_avg_closed_ratio': 1.0621993779801577, 'other_avg_far_ratio': 0.0}
{'grad': 1.9014919102191925, 'context_loss': 7.726739013195038, 'stance_loss': 1.321181833744049, 'news_loss': 0.6728985428810119}


Validating rep learning:   0%|                                                                                                                                                    | 0/2211 [00:00<?, ?it/s][A[A

Validating rep learning:   9%|████████████▋                                                                                                                           | 207/2211 [00:00<00:00, 2061.49it/s][A[A

Validating rep learning:  20%|██████████████████████████▊                                                                                                             | 436/2211 [00:00<00:00, 2122.31it/s][A[A

Validating rep learning:  29%|████████████████████████████████████████                                                                                                | 651/2211 [00:00<00:00, 2129.94it/s][A[A

Validating rep learning:  39%|████████████████████████████████████████████████████▌                                                                                   | 854/2211 [00:00<00:00, 2098.48it/s][A[A

Validating rep learning:  48%|████████████████████████████████████████████████████████████████▌                                                                      | 1058/2211 [00:00<00:00, 2078.20it/s][A[A

Validating rep learning:  57%|████████████████████████████████████████████████████████████████████████████▊                                                          | 1257/2211 [00:00<00:00, 2048.02it/s][A[A

Validating rep learning:  66%|████████████████████████████████████████████████████████████████████████████████████████▉                                              | 1456/2211 [00:00<00:00, 2030.20it/s][A[A

Validating rep learning:  75%|█████████████████████████████████████████████████████████████████████████████████████████████████████                                  | 1656/2211 [00:00<00:00, 2020.07it/s][A[A

Validating rep learning:  84%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████▎                     | 1856/2211 [00:00<00:00, 2012.11it/s][A[A

Validating rep learning:  93%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▍         | 2055/2211 [00:01<00:00, 2005.21it/s][A[AValidating rep learning: 100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 2211/2211 [00:01<00:00, 2045.78it/s]
{'stance_avg_closed_ratio': 0.9758333624003592, 'stance_avg_far_ratio': 0.949225950857746, 'other_avg_closed_ratio': 1.0145919241003247, 'other_avg_far_ratio': 0.0}
Sampling news batches: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 187/187 [-1:37:47<00:00, -0.14it/s]
Validating
Training GraphSage:   0%|                                                                                                                                                        | 0/30 [-1:49:47<?, ?it/s]
Traceback (most recent call last):
  File "run_graph.py", line 67, in <module>
    fang(p_args)
  File "run_graph.py", line 55, in fang
    pretrained_dir=args.pretrained_dir, pretrained_step=args.pretrained_step)
  File "/home/sejmou/Repos/Uni/ExpDesDS/FANG/fang/graphsage/__init__.py", line 227, in run_fang_graph_sage
    n_nodes, input_size, pretrained_dir, pretrained_step)
  File "/home/sejmou/Repos/Uni/ExpDesDS/FANG/fang/graphsage/__init__.py", line 631, in train_fn
    writer, device, tag="validate")
  File "/home/sejmou/Repos/Uni/ExpDesDS/FANG/fang/graphsage/__init__.py", line 709, in eval_fn
    embed_size, device, cutoff_range, test=True)
  File "/home/sejmou/Repos/Uni/ExpDesDS/FANG/fang/graphsage/__init__.py", line 741, in preprocess_news_classification_data
    else torch.zeros(1, embed_size).to(device) for e_users in engage_users_batch]
  File "/home/sejmou/Repos/Uni/ExpDesDS/FANG/fang/graphsage/__init__.py", line 741, in <listcomp>
    else torch.zeros(1, embed_size).to(device) for e_users in engage_users_batch]
  File "/home/sejmou/anaconda3/envs/test/lib/python3.7/site-packages/torch/nn/modules/module.py", line 550, in __call__
    result = self.forward(*input, **kwargs)
  File "/home/sejmou/Repos/Uni/ExpDesDS/FANG/user_embed/graphsage/models.py", line 55, in forward
    aggregate_feats = self.aggregate(nb, pre_hidden_embs, pre_neighs)
  File "/home/sejmou/Repos/Uni/ExpDesDS/FANG/user_embed/graphsage/models.py", line 121, in aggregate
    mask = mask.div(num_neigh).to(embed_matrix.device)
RuntimeError: CUDA out of memory. Tried to allocate 2.39 GiB (GPU 0; 5.93 GiB total capacity; 340.30 MiB already allocated; 1.87 GiB free; 3.25 GiB reserved in total by PyTorch)

real	0m0,000s
user	42m56,402s
sys	4m26,868s
(test) ]0;sejmou@sejmou-desktop: ~/Repos/Uni/ExpDesDS/FANG[01;32msejmou@sejmou-desktop[00m:[01;34m~/Repos/Uni/ExpDesDS/FANG[00m$ time python run_graph.py -t fang -m graph_sage -p data/news_graph --percent 10 --epochs=30 --attention --use-stance --use-proximity --temporal
Using stance
Using proximity
Load FANG dataset from data/news_graph
/home/sejmou/Repos/Uni/ExpDesDS/FANG/fang/utils.py:98: RuntimeWarning: divide by zero encountered in power
  sum_inv = np.power(row_sum, -1).flatten()
Loading cache
Use temporal
Initialize optimizer with weight decay 0.0005
Train 55026 Dev 466 Test 465
Training GraphSage:   0%|                                                                                                                                                           | 0/30 [00:00<?, ?it/s]
Sampling news batches:   0%|                                                                                                                                                      | 0/1496 [00:00<?, ?it/s][A{'grad': 5.3996134996414185, 'context_loss': 8.610655784606934}


Validating rep learning:   0%|                                                                                                                                                    | 0/2211 [00:00<?, ?it/s][A[A

Validating rep learning:   8%|██████████▌                                                                                                                             | 172/2211 [00:00<00:01, 1714.16it/s][A[A

Validating rep learning:  17%|███████████████████████▍                                                                                                                | 381/2211 [00:00<00:01, 1809.37it/s][A[A

Validating rep learning:  26%|██████████████████████████████████▉                                                                                                     | 569/2211 [00:00<00:00, 1829.96it/s][A[A

Validating rep learning:  35%|███████████████████████████████████████████████▏                                                                                        | 768/2211 [00:00<00:00, 1874.12it/s][A[A

Validating rep learning:  43%|██████████████████████████████████████████████████████████▊                                                                             | 957/2211 [00:00<00:00, 1876.20it/s][A[A

Validating rep learning:  52%|█████████████████████████████████████████████████████████████████████▉                                                                 | 1145/2211 [00:00<00:00, 1875.37it/s][A[A

Validating rep learning:  60%|█████████████████████████████████████████████████████████████████████████████████                                                      | 1328/2211 [00:00<00:00, 1858.57it/s][A[A

Validating rep learning:  68%|████████████████████████████████████████████████████████████████████████████████████████████▎                                          | 1512/2211 [00:00<00:00, 1851.48it/s][A[A

Validating rep learning:  77%|███████████████████████████████████████████████████████████████████████████████████████████████████████▌                               | 1696/2211 [00:00<00:00, 1845.56it/s][A[A

Validating rep learning:  85%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████▋                    | 1879/2211 [00:01<00:00, 1840.60it/s][A[A

Validating rep learning:  93%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████         | 2064/2211 [00:01<00:00, 1841.33it/s][A[AValidating rep learning: 100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 2211/2211 [00:01<00:00, 1867.54it/s]
{'stance_avg_closed_ratio': 0.9880445472530026, 'stance_avg_far_ratio': 1.0023923867503164, 'other_avg_closed_ratio': 1.0347162725506107, 'other_avg_far_ratio': 0.0}

Sampling news batches:   0%|                                                                                                                                           | 1/1496 [01:05<27:07:19, 65.31s/it][A
Sampling news batches:   0%|▏                                                                                                                                          | 2/1496 [01:07<19:11:31, 46.25s/it][A
Sampling news batches:   0%|▎                                                                                                                                          | 3/1496 [01:09<13:45:04, 33.16s/it][A
Sampling news batches:   0%|▎                                                                                                                                           | 4/1496 [01:11<9:47:30, 23.63s/it][A
Sampling news batches:   0%|▍                                                                                                                                           | 5/1496 [01:13<7:07:20, 17.20s/it][A
Sampling news batches:   0%|▌                                                                                                                                           | 6/1496 [01:15<5:13:02, 12.61s/it][A
Sampling news batches:   0%|▋                                                                                                                                           | 7/1496 [01:17<3:53:02,  9.39s/it][A
Sampling news batches:   1%|▋                                                                                                                                           | 8/1496 [01:21<3:13:28,  7.80s/it][A
Sampling news batches:   1%|▊                                                                                                                                           | 9/1496 [01:22<2:24:54,  5.85s/it][A
Sampling news batches:   1%|▉                                                                                                                                          | 10/1496 [01:24<1:55:42,  4.67s/it][A
Sampling news batches:   1%|█                                                                                                                                          | 11/1496 [01:25<1:29:09,  3.60s/it][A
Sampling news batches:   1%|█                                                                                                                                          | 12/1496 [01:28<1:25:20,  3.45s/it][A
Sampling news batches:   1%|█▏                                                                                                                                         | 13/1496 [01:30<1:16:58,  3.11s/it][A
Sampling news batches:   1%|█▎                                                                                                                                         | 14/1496 [01:32<1:04:49,  2.62s/it][A
Sampling news batches:   1%|█▍                                                                                                                                         | 15/1496 [01:34<1:00:07,  2.44s/it][A
Sampling news batches:   1%|█▍                                                                                                                                         | 16/1496 [01:38<1:15:51,  3.08s/it][A
Sampling news batches:   1%|█▌                                                                                                                                         | 17/1496 [01:41<1:09:33,  2.82s/it][A
Sampling news batches:   1%|█▋                                                                                                                                         | 18/1496 [01:42<1:00:39,  2.46s/it][A
Sampling news batches:   1%|█▊                                                                                                                                         | 19/1496 [01:45<1:00:01,  2.44s/it][A
Sampling news batches:   1%|█▉                                                                                                                                           | 20/1496 [01:47<57:19,  2.33s/it][A
Sampling news batches:   1%|█▉                                                                                                                                         | 21/1496 [01:51<1:11:15,  2.90s/it][A
Sampling news batches:   1%|██                                                                                                                                         | 22/1496 [01:53<1:05:10,  2.65s/it][A
Sampling news batches:   2%|██▏                                                                                                                                        | 23/1496 [01:56<1:03:44,  2.60s/it][A
Sampling news batches:   2%|██▏                                                                                                                                        | 24/1496 [01:59<1:07:48,  2.76s/it][A
Sampling news batches:   2%|██▎                                                                                                                                        | 25/1496 [02:01<1:01:44,  2.52s/it][A
Sampling news batches:   2%|██▍                                                                                                                                          | 26/1496 [02:02<53:50,  2.20s/it][A
Sampling news batches:   2%|██▌                                                                                                                                        | 27/1496 [02:06<1:03:47,  2.61s/it][A
Sampling news batches:   2%|██▋                                                                                                                                          | 28/1496 [02:07<56:56,  2.33s/it][A
Sampling news batches:   2%|██▋                                                                                                                                          | 29/1496 [02:08<46:14,  1.89s/it][A
Sampling news batches:   2%|██▊                                                                                                                                          | 30/1496 [02:11<50:57,  2.09s/it][A
Sampling news batches:   2%|██▉                                                                                                                                          | 31/1496 [02:13<49:36,  2.03s/it][A
Sampling news batches:   2%|███                                                                                                                                          | 32/1496 [02:14<44:38,  1.83s/it][A
Sampling news batches:   2%|███                                                                                                                                        | 33/1496 [02:18<1:00:46,  2.49s/it][A
Sampling news batches:   2%|███▏                                                                                                                                       | 34/1496 [02:21<1:06:36,  2.73s/it][A
Sampling news batches:   2%|███▎                                                                                                                                       | 35/1496 [02:24<1:05:24,  2.69s/it][A
Sampling news batches:   2%|███▍                                                                                                                                         | 36/1496 [02:26<57:40,  2.37s/it][A
Sampling news batches:   2%|███▍                                                                                                                                         | 37/1496 [02:27<51:21,  2.11s/it][A
Sampling news batches:   3%|███▌                                                                                                                                         | 38/1496 [02:30<58:29,  2.41s/it][A
Sampling news batches:   3%|███▌                                                                                                                                       | 39/1496 [02:34<1:05:56,  2.72s/it][A
Sampling news batches:   3%|███▊                                                                                                                                         | 40/1496 [02:35<53:21,  2.20s/it][A{'grad': 3.7983720898628235, 'context_loss': 7.877995848655701, 'stance_loss': 1.3925318224676724, 'news_loss': 0.8450901508331299}


Validating rep learning:   0%|                                                                                                                                                    | 0/2211 [00:00<?, ?it/s][A[A

Validating rep learning:   8%|███████████▏                                                                                                                            | 181/2211 [00:00<00:01, 1801.87it/s][A[A

Validating rep learning:  18%|███████████████████████▊                                                                                                                | 387/2211 [00:00<00:00, 1870.08it/s][A[A

Validating rep learning:  26%|███████████████████████████████████▍                                                                                                    | 576/2211 [00:00<00:00, 1874.78it/s][A[A

Validating rep learning:  35%|███████████████████████████████████████████████▍                                                                                        | 772/2211 [00:00<00:00, 1899.16it/s][A[A

Validating rep learning:  43%|██████████████████████████████████████████████████████████▉                                                                             | 959/2211 [00:00<00:00, 1889.04it/s][A[A

Validating rep learning:  52%|█████████████████████████████████████████████████████████████████████▉                                                                 | 1145/2211 [00:00<00:00, 1880.01it/s][A[A

Validating rep learning:  60%|█████████████████████████████████████████████████████████████████████████████████▏                                                     | 1329/2211 [00:00<00:00, 1865.61it/s][A[A

Validating rep learning:  68%|████████████████████████████████████████████████████████████████████████████████████████████▍                                          | 1514/2211 [00:00<00:00, 1859.62it/s][A[A

Validating rep learning:  77%|███████████████████████████████████████████████████████████████████████████████████████████████████████▋                               | 1699/2211 [00:00<00:00, 1855.96it/s][A[A

Validating rep learning:  85%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████                    | 1884/2211 [00:01<00:00, 1852.11it/s][A[A

Validating rep learning:  94%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▎        | 2069/2211 [00:01<00:00, 1850.61it/s][A[AValidating rep learning: 100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 2211/2211 [00:01<00:00, 1873.25it/s]
{'stance_avg_closed_ratio': 0.9821270159763223, 'stance_avg_far_ratio': 1.0012354012454587, 'other_avg_closed_ratio': 0.9157223211216861, 'other_avg_far_ratio': 0.0}

Sampling news batches:   3%|███▊                                                                                                                                       | 41/1496 [03:38<8:17:30, 20.52s/it][A
Sampling news batches:   3%|███▉                                                                                                                                       | 42/1496 [03:39<5:57:54, 14.77s/it][A
Sampling news batches:   3%|███▉                                                                                                                                       | 43/1496 [03:43<4:37:58, 11.48s/it][A
Sampling news batches:   3%|████                                                                                                                                       | 44/1496 [03:43<3:17:46,  8.17s/it][A
Sampling news batches:   3%|████▏                                                                                                                                      | 45/1496 [03:45<2:27:04,  6.08s/it][A
Sampling news batches:   3%|████▎                                                                                                                                      | 46/1496 [03:47<1:56:47,  4.83s/it][A
Sampling news batches:   3%|████▎                                                                                                                                      | 47/1496 [03:48<1:29:48,  3.72s/it][A
Sampling news batches:   3%|████▍                                                                                                                                      | 48/1496 [03:49<1:12:09,  2.99s/it][A
Sampling news batches:   3%|████▌                                                                                                                                      | 49/1496 [03:51<1:07:56,  2.82s/it][A
Sampling news batches:   3%|████▋                                                                                                                                      | 50/1496 [03:54<1:07:33,  2.80s/it][A
Sampling news batches:   3%|████▋                                                                                                                                      | 51/1496 [03:56<1:00:08,  2.50s/it][A
Sampling news batches:   3%|████▉                                                                                                                                        | 52/1496 [03:58<58:04,  2.41s/it][A
Sampling news batches:   4%|████▉                                                                                                                                        | 53/1496 [04:00<53:27,  2.22s/it][A
Sampling news batches:   4%|█████                                                                                                                                        | 54/1496 [04:02<54:43,  2.28s/it][A
Sampling news batches:   4%|█████▏                                                                                                                                       | 55/1496 [04:04<51:32,  2.15s/it][A
Sampling news batches:   4%|█████▎                                                                                                                                       | 56/1496 [04:05<44:14,  1.84s/it][A
Sampling news batches:   4%|█████▎                                                                                                                                       | 57/1496 [04:06<36:20,  1.52s/it][A
Sampling news batches:   4%|█████▍                                                                                                                                       | 58/1496 [04:08<41:36,  1.74s/it][A
Sampling news batches:   4%|█████▌                                                                                                                                       | 59/1496 [04:11<47:01,  1.96s/it][A
Sampling news batches:   4%|█████▋                                                                                                                                       | 60/1496 [04:15<59:30,  2.49s/it][A
Sampling news batches:   4%|█████▋                                                                                                                                       | 61/1496 [04:16<55:32,  2.32s/it][A
Sampling news batches:   4%|█████▊                                                                                                                                       | 62/1496 [04:19<53:42,  2.25s/it][A
Sampling news batches:   4%|█████▊                                                                                                                                     | 63/1496 [04:23<1:10:25,  2.95s/it][A
Sampling news batches:   4%|█████▉                                                                                                                                     | 64/1496 [04:26<1:07:59,  2.85s/it][A
Sampling news batches:   4%|██████                                                                                                                                     | 65/1496 [04:28<1:03:08,  2.65s/it][A
Sampling news batches:   4%|██████▏                                                                                                                                      | 66/1496 [04:29<55:03,  2.31s/it][A
Sampling news batches:   4%|██████▎                                                                                                                                      | 67/1496 [04:32<58:54,  2.47s/it][A
Sampling news batches:   5%|██████▍                                                                                                                                      | 68/1496 [04:33<45:51,  1.93s/it][A
Sampling news batches:   5%|██████▌                                                                                                                                      | 69/1496 [04:34<41:01,  1.72s/it][A
Sampling news batches:   5%|██████▌                                                                                                                                      | 70/1496 [04:36<39:35,  1.67s/it][A
Sampling news batches:   5%|██████▋                                                                                                                                      | 71/1496 [04:38<45:06,  1.90s/it][A
Sampling news batches:   5%|██████▊                                                                                                                                      | 72/1496 [04:39<38:51,  1.64s/it][A
Sampling news batches:   5%|██████▉                                                                                                                                      | 73/1496 [04:41<37:56,  1.60s/it][A
Sampling news batches:   5%|██████▉                                                                                                                                      | 74/1496 [04:43<43:29,  1.84s/it][A
Sampling news batches:   5%|███████                                                                                                                                      | 75/1496 [04:46<51:18,  2.17s/it][A
Sampling news batches:   5%|███████▏                                                                                                                                     | 76/1496 [04:48<51:04,  2.16s/it][A
Sampling news batches:   5%|███████▎                                                                                                                                     | 77/1496 [04:51<54:46,  2.32s/it][A
Sampling news batches:   5%|███████▎                                                                                                                                     | 78/1496 [04:52<49:09,  2.08s/it][A
Sampling news batches:   5%|███████▍                                                                                                                                     | 79/1496 [04:55<50:03,  2.12s/it][A
Sampling news batches:   5%|███████▌                                                                                                                                     | 80/1496 [04:57<54:26,  2.31s/it][A{'grad': 3.8134575486183167, 'context_loss': 7.868317520618438, 'stance_loss': 1.3864657836300986, 'news_loss': 0.7150600651899973}


Validating rep learning:   0%|                                                                                                                                                    | 0/2211 [00:00<?, ?it/s][A[A

Validating rep learning:   8%|███████████                                                                                                                             | 179/2211 [00:00<00:01, 1789.83it/s][A[A

Validating rep learning:  18%|████████████████████████                                                                                                                | 391/2211 [00:00<00:00, 1875.28it/s][A[A

Validating rep learning:  26%|███████████████████████████████████▋                                                                                                    | 580/2211 [00:00<00:00, 1877.78it/s][A[A

Validating rep learning:  35%|███████████████████████████████████████████████▊                                                                                        | 777/2211 [00:00<00:00, 1901.69it/s][A[A

Validating rep learning:  42%|█████████████████████████████████████████████████████████▌                                                                              | 936/2211 [00:00<00:00, 1792.38it/s][A[A

Validating rep learning:  51%|████████████████████████████████████████████████████████████████████▌                                                                  | 1123/2211 [00:00<00:00, 1814.23it/s][A[A

Validating rep learning:  59%|███████████████████████████████████████████████████████████████████████████████▋                                                       | 1306/2211 [00:00<00:00, 1817.15it/s][A[A

Validating rep learning:  67%|██████████████████████████████████████████████████████████████████████████████████████████▉                                            | 1489/2211 [00:00<00:00, 1820.98it/s][A[A

Validating rep learning:  76%|██████████████████████████████████████████████████████████████████████████████████████████████████████                                 | 1672/2211 [00:00<00:00, 1823.06it/s][A[A

Validating rep learning:  84%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████▎                     | 1856/2211 [00:01<00:00, 1826.76it/s][A[A

Validating rep learning:  92%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▌          | 2040/2211 [00:01<00:00, 1829.69it/s][A[AValidating rep learning: 100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 2211/2211 [00:01<00:00, 1847.39it/s]
{'stance_avg_closed_ratio': 0.991084955707156, 'stance_avg_far_ratio': 0.996903142054782, 'other_avg_closed_ratio': 0.9576621739680218, 'other_avg_far_ratio': 0.0}

Sampling news batches:   5%|███████▌                                                                                                                                   | 81/1496 [06:01<8:09:58, 20.78s/it][A
Sampling news batches:   5%|███████▌                                                                                                                                   | 82/1496 [06:04<6:02:15, 15.37s/it][A
Sampling news batches:   6%|███████▋                                                                                                                                   | 83/1496 [06:05<4:20:51, 11.08s/it][A
Sampling news batches:   6%|███████▊                                                                                                                                   | 84/1496 [06:07<3:16:06,  8.33s/it][A
Sampling news batches:   6%|███████▉                                                                                                                                   | 85/1496 [06:08<2:24:02,  6.12s/it][A
Sampling news batches:   6%|███████▉                                                                                                                                   | 86/1496 [06:10<1:55:58,  4.93s/it][A
Sampling news batches:   6%|████████                                                                                                                                   | 87/1496 [06:11<1:29:53,  3.83s/it][A
Sampling news batches:   6%|████████▏                                                                                                                                  | 88/1496 [06:13<1:12:39,  3.10s/it][A
Sampling news batches:   6%|████████▎                                                                                                                                  | 89/1496 [06:14<1:02:14,  2.65s/it][A
Sampling news batches:   6%|████████▍                                                                                                                                    | 90/1496 [06:16<58:16,  2.49s/it][A
Sampling news batches:   6%|████████▌                                                                                                                                    | 91/1496 [06:18<53:59,  2.31s/it][A
Sampling news batches:   6%|████████▋                                                                                                                                    | 92/1496 [06:21<56:16,  2.40s/it][A
Sampling news batches:   6%|████████▊                                                                                                                                    | 93/1496 [06:23<51:55,  2.22s/it][A
Sampling news batches:   6%|████████▊                                                                                                                                    | 94/1496 [06:26<56:02,  2.40s/it][A
Sampling news batches:   6%|████████▉                                                                                                                                    | 95/1496 [06:28<58:39,  2.51s/it][A
Sampling news batches:   6%|█████████                                                                                                                                    | 96/1496 [06:30<53:30,  2.29s/it][A
Sampling news batches:   6%|█████████▏                                                                                                                                   | 97/1496 [06:32<52:20,  2.24s/it][A
Sampling news batches:   7%|█████████▏                                                                                                                                   | 98/1496 [06:34<49:13,  2.11s/it][A
Sampling news batches:   7%|█████████▎                                                                                                                                   | 99/1496 [06:35<40:49,  1.75s/it][A
Sampling news batches:   7%|█████████▎                                                                                                                                  | 100/1496 [06:39<56:33,  2.43s/it][A
Sampling news batches:   7%|█████████▍                                                                                                                                  | 101/1496 [06:40<47:54,  2.06s/it][A
Sampling news batches:   7%|█████████▌                                                                                                                                  | 102/1496 [06:42<43:40,  1.88s/it][A
Sampling news batches:   7%|█████████▋                                                                                                                                  | 103/1496 [06:45<53:24,  2.30s/it][A
Sampling news batches:   7%|█████████▋                                                                                                                                  | 104/1496 [06:47<52:46,  2.27s/it][A
Sampling news batches:   7%|█████████▊                                                                                                                                  | 105/1496 [06:50<58:13,  2.51s/it][A
Sampling news batches:   7%|█████████▉                                                                                                                                  | 106/1496 [06:52<54:28,  2.35s/it][A
Sampling news batches:   7%|██████████                                                                                                                                  | 107/1496 [06:55<54:56,  2.37s/it][A
Sampling news batches:   7%|█████████▉                                                                                                                                | 108/1496 [06:58<1:00:39,  2.62s/it][A
Sampling news batches:   7%|██████████▏                                                                                                                                 | 109/1496 [07:00<55:59,  2.42s/it][A
Sampling news batches:   7%|██████████▎                                                                                                                                 | 110/1496 [07:01<47:09,  2.04s/it][A
Sampling news batches:   7%|██████████▍                                                                                                                                 | 111/1496 [07:03<44:38,  1.93s/it][A
Sampling news batches:   7%|██████████▍                                                                                                                                 | 112/1496 [07:04<41:32,  1.80s/it][A
Sampling news batches:   8%|██████████▌                                                                                                                                 | 113/1496 [07:05<37:09,  1.61s/it][A
Sampling news batches:   8%|██████████▋                                                                                                                                 | 114/1496 [07:08<45:11,  1.96s/it][A
Sampling news batches:   8%|██████████▊                                                                                                                                 | 115/1496 [07:10<43:58,  1.91s/it][A
Sampling news batches:   8%|██████████▊                                                                                                                                 | 116/1496 [07:13<52:38,  2.29s/it][A
Sampling news batches:   8%|██████████▉                                                                                                                                 | 117/1496 [07:16<58:17,  2.54s/it][A
Sampling news batches:   8%|██████████▉                                                                                                                               | 118/1496 [07:20<1:07:59,  2.96s/it][A
Sampling news batches:   8%|███████████▏                                                                                                                                | 119/1496 [07:21<55:09,  2.40s/it][A
Sampling news batches:   8%|███████████▏                                                                                                                                | 120/1496 [07:22<44:11,  1.93s/it][A{'grad': 5.940694808959961, 'context_loss': 7.805394005775452, 'stance_loss': 1.38415175014072, 'news_loss': 0.6667269170284271}


Validating rep learning:   0%|                                                                                                                                                    | 0/2211 [00:00<?, ?it/s][A[A

Validating rep learning:   8%|███████████▏                                                                                                                            | 182/2211 [00:00<00:01, 1814.86it/s][A[A

Validating rep learning:  18%|████████████████████████▏                                                                                                               | 394/2211 [00:00<00:00, 1895.88it/s][A[A

Validating rep learning:  26%|███████████████████████████████████▊                                                                                                    | 582/2211 [00:00<00:00, 1889.36it/s][A[A

Validating rep learning:  35%|████████████████████████████████████████████████                                                                                        | 781/2211 [00:00<00:00, 1916.07it/s][A[A

Validating rep learning:  44%|███████████████████████████████████████████████████████████▋                                                                            | 970/2211 [00:00<00:00, 1905.19it/s][A[A

Validating rep learning:  52%|██████████████████████████████████████████████████████████████████████▋                                                                | 1158/2211 [00:00<00:00, 1896.07it/s][A[A

Validating rep learning:  61%|█████████████████████████████████████████████████████████████████████████████████▉                                                     | 1342/2211 [00:00<00:00, 1876.07it/s][A[A

Validating rep learning:  69%|█████████████████████████████████████████████████████████████████████████████████████████████                                          | 1525/2211 [00:00<00:00, 1859.88it/s][A[A

Validating rep learning:  77%|████████████████████████████████████████████████████████████████████████████████████████████████████████▍                              | 1710/2211 [00:00<00:00, 1854.97it/s][A[A

Validating rep learning:  86%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████▋                   | 1895/2211 [00:01<00:00, 1853.12it/s][A[A

Validating rep learning:  94%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▉        | 2079/2211 [00:01<00:00, 1848.57it/s][A[AValidating rep learning: 100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 2211/2211 [00:01<00:00, 1881.42it/s]
{'stance_avg_closed_ratio': 0.9641114162722667, 'stance_avg_far_ratio': 0.9670706039037767, 'other_avg_closed_ratio': 0.9974140235829168, 'other_avg_far_ratio': 0.0}

Sampling news batches:   8%|███████████▏                                                                                                                              | 121/1496 [08:22<7:25:37, 19.45s/it][A
Sampling news batches:   8%|███████████▎                                                                                                                              | 122/1496 [08:25<5:27:02, 14.28s/it][A
Sampling news batches:   8%|███████████▎                                                                                                                              | 123/1496 [08:28<4:09:37, 10.91s/it][A
Sampling news batches:   8%|███████████▍                                                                                                                              | 124/1496 [08:29<3:05:48,  8.13s/it][A
Sampling news batches:   8%|███████████▌                                                                                                                              | 125/1496 [08:32<2:26:46,  6.42s/it][A
Sampling news batches:   8%|███████████▌                                                                                                                              | 126/1496 [08:33<1:54:45,  5.03s/it][A
Sampling news batches:   8%|███████████▋                                                                                                                              | 127/1496 [08:34<1:27:16,  3.82s/it][A
Sampling news batches:   9%|███████████▊                                                                                                                              | 128/1496 [08:37<1:16:45,  3.37s/it][A
Sampling news batches:   9%|███████████▉                                                                                                                              | 129/1496 [08:39<1:06:08,  2.90s/it][A
Sampling news batches:   9%|████████████▏                                                                                                                               | 130/1496 [08:40<57:48,  2.54s/it][A
Sampling news batches:   9%|████████████▎                                                                                                                               | 131/1496 [08:42<49:45,  2.19s/it][A
Sampling news batches:   9%|████████████▎                                                                                                                               | 132/1496 [08:43<44:23,  1.95s/it][A
Sampling news batches:   9%|████████████▍                                                                                                                               | 133/1496 [08:46<48:33,  2.14s/it][A
Sampling news batches:   9%|████████████▌                                                                                                                               | 134/1496 [08:48<48:19,  2.13s/it][A
Sampling news batches:   9%|████████████▋                                                                                                                               | 135/1496 [08:50<50:06,  2.21s/it][A
Sampling news batches:   9%|████████████▌                                                                                                                             | 136/1496 [08:55<1:07:08,  2.96s/it][A
Sampling news batches:   9%|████████████▋                                                                                                                             | 137/1496 [08:57<1:01:22,  2.71s/it][A
Sampling news batches:   9%|████████████▉                                                                                                                               | 138/1496 [08:59<55:28,  2.45s/it][A
Sampling news batches:   9%|█████████████                                                                                                                               | 139/1496 [09:02<58:09,  2.57s/it][A
Sampling news batches:   9%|█████████████                                                                                                                               | 140/1496 [09:04<55:09,  2.44s/it][A
Sampling news batches:   9%|█████████████▏                                                                                                                              | 141/1496 [09:05<44:57,  1.99s/it][A
Sampling news batches:   9%|█████████████▎                                                                                                                              | 142/1496 [09:08<51:59,  2.30s/it][A
Sampling news batches:  10%|█████████████▍                                                                                                                              | 143/1496 [09:10<52:21,  2.32s/it][A
Sampling news batches:  10%|█████████████▍                                                                                                                              | 144/1496 [09:14<59:49,  2.65s/it][A
Sampling news batches:  10%|█████████████▌                                                                                                                              | 145/1496 [09:14<48:03,  2.13s/it][A
Sampling news batches:  10%|█████████████▋                                                                                                                              | 146/1496 [09:17<49:42,  2.21s/it][A
Sampling news batches:  10%|█████████████▊                                                                                                                              | 147/1496 [09:20<56:17,  2.50s/it][A
Sampling news batches:  10%|█████████████▊                                                                                                                              | 148/1496 [09:21<47:41,  2.12s/it][A
Sampling news batches:  10%|█████████████▉                                                                                                                              | 149/1496 [09:22<40:59,  1.83s/it][A
Sampling news batches:  10%|██████████████                                                                                                                              | 150/1496 [09:25<43:29,  1.94s/it][A
Sampling news batches:  10%|██████████████▏                                                                                                                             | 151/1496 [09:26<36:38,  1.63s/it][A
Sampling news batches:  10%|██████████████▏                                                                                                                             | 152/1496 [09:27<38:15,  1.71s/it][A
Sampling news batches:  10%|██████████████▎                                                                                                                             | 153/1496 [09:29<35:33,  1.59s/it][A
Sampling news batches:  10%|██████████████▍                                                                                                                             | 154/1496 [09:30<33:14,  1.49s/it][A
Sampling news batches:  10%|██████████████▌                                                                                                                             | 155/1496 [09:32<35:43,  1.60s/it][A
Sampling news batches:  10%|██████████████▌                                                                                                                             | 156/1496 [09:35<43:39,  1.96s/it][A
Sampling news batches:  10%|██████████████▋                                                                                                                             | 157/1496 [09:37<45:36,  2.04s/it][A
Sampling news batches:  11%|██████████████▊                                                                                                                             | 158/1496 [09:40<51:09,  2.29s/it][A
Sampling news batches:  11%|██████████████▉                                                                                                                             | 159/1496 [09:42<47:41,  2.14s/it][A
Sampling news batches:  11%|██████████████▉                                                                                                                             | 160/1496 [09:44<47:01,  2.11s/it][A{'grad': 5.128336071968079, 'context_loss': 7.7005778551101685, 'stance_loss': nan, 'news_loss': 0.7681120038032532}


Validating rep learning:   0%|                                                                                                                                                    | 0/2211 [00:00<?, ?it/s][A[A

Validating rep learning:   8%|██████████▊                                                                                                                             | 176/2211 [00:00<00:01, 1752.94it/s][A[A

Validating rep learning:  17%|███████████████████████▋                                                                                                                | 386/2211 [00:00<00:00, 1843.86it/s][A[A

Validating rep learning:  26%|███████████████████████████████████▎                                                                                                    | 574/2211 [00:00<00:00, 1853.44it/s][A[A

Validating rep learning:  35%|███████████████████████████████████████████████▌                                                                                        | 773/2211 [00:00<00:00, 1891.56it/s][A[A

Validating rep learning:  43%|███████████████████████████████████████████████████████████                                                                             | 960/2211 [00:00<00:00, 1883.21it/s][A[A

Validating rep learning:  52%|██████████████████████████████████████████████████████████████████████                                                                 | 1147/2211 [00:00<00:00, 1877.11it/s][A[A

Validating rep learning:  60%|█████████████████████████████████████████████████████████████████████████████████                                                      | 1328/2211 [00:00<00:00, 1856.39it/s][A[A

Validating rep learning:  68%|████████████████████████████████████████████████████████████████████████████████████████████▎                                          | 1511/2211 [00:00<00:00, 1847.60it/s][A[A

Validating rep learning:  77%|███████████████████████████████████████████████████████████████████████████████████████████████████████▎                               | 1693/2211 [00:00<00:00, 1836.97it/s][A[A

Validating rep learning:  85%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████▌                    | 1876/2211 [00:01<00:00, 1832.82it/s][A[A

Validating rep learning:  93%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▋         | 2059/2211 [00:01<00:00, 1831.05it/s][A[AValidating rep learning: 100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 2211/2211 [00:01<00:00, 1864.43it/s]
{'stance_avg_closed_ratio': 0.9806576084204348, 'stance_avg_far_ratio': 0.965051978803787, 'other_avg_closed_ratio': 0.9357877512575196, 'other_avg_far_ratio': 0.0}

Sampling news batches:  11%|██████████████▊                                                                                                                           | 161/1496 [10:48<7:44:10, 20.86s/it][A
Sampling news batches:  11%|██████████████▉                                                                                                                           | 162/1496 [10:50<5:37:02, 15.16s/it][A
Sampling news batches:  11%|███████████████                                                                                                                           | 163/1496 [10:53<4:12:23, 11.36s/it][A
Sampling news batches:  11%|███████████████▏                                                                                                                          | 164/1496 [10:55<3:11:17,  8.62s/it][A
Sampling news batches:  11%|███████████████▏                                                                                                                          | 165/1496 [10:56<2:21:33,  6.38s/it][A
Sampling news batches:  11%|███████████████▎                                                                                                                          | 166/1496 [10:57<1:49:06,  4.92s/it][A
Sampling news batches:  11%|███████████████▍                                                                                                                          | 167/1496 [10:58<1:23:19,  3.76s/it][A
Sampling news batches:  11%|███████████████▍                                                                                                                          | 168/1496 [11:00<1:07:27,  3.05s/it][A
Sampling news batches:  11%|███████████████▌                                                                                                                          | 169/1496 [11:02<1:01:37,  2.79s/it][A
Sampling news batches:  11%|███████████████▉                                                                                                                            | 170/1496 [11:05<59:25,  2.69s/it][A
Sampling news batches:  11%|████████████████                                                                                                                            | 171/1496 [11:06<51:05,  2.31s/it][A
Sampling news batches:  11%|████████████████                                                                                                                            | 172/1496 [11:07<44:53,  2.03s/it][A
Sampling news batches:  12%|████████████████▏                                                                                                                           | 173/1496 [11:10<49:41,  2.25s/it][A
Sampling news batches:  12%|████████████████▎                                                                                                                           | 174/1496 [11:13<55:07,  2.50s/it][A
Sampling news batches:  12%|████████████████▍                                                                                                                           | 175/1496 [11:15<47:27,  2.16s/it][A
Sampling news batches:  12%|████████████████▍                                                                                                                           | 176/1496 [11:17<46:22,  2.11s/it][A
Sampling news batches:  12%|████████████████▌                                                                                                                           | 177/1496 [11:19<47:03,  2.14s/it][A
Sampling news batches:  12%|████████████████▋                                                                                                                           | 178/1496 [11:22<51:29,  2.34s/it][A
Sampling news batches:  12%|████████████████▊                                                                                                                           | 179/1496 [11:23<44:35,  2.03s/it][A
Sampling news batches:  12%|████████████████▊                                                                                                                           | 180/1496 [11:25<48:19,  2.20s/it][A
Sampling news batches:  12%|████████████████▉                                                                                                                           | 181/1496 [11:28<47:24,  2.16s/it][A
Sampling news batches:  12%|█████████████████                                                                                                                           | 182/1496 [11:28<38:41,  1.77s/it][A
Sampling news batches:  12%|█████████████████▏                                                                                                                          | 183/1496 [11:30<36:12,  1.65s/it][A
Sampling news batches:  12%|█████████████████▏                                                                                                                          | 184/1496 [11:32<39:08,  1.79s/it][A
Sampling news batches:  12%|█████████████████▎                                                                                                                          | 185/1496 [11:36<54:21,  2.49s/it][A
Sampling news batches:  12%|█████████████████▍                                                                                                                          | 186/1496 [11:38<51:01,  2.34s/it][A
Sampling news batches:  12%|█████████████████▌                                                                                                                          | 187/1496 [11:39<44:05,  2.02s/it][A
Sampling news batches:  13%|█████████████████▌                                                                                                                          | 188/1496 [11:41<41:02,  1.88s/it][A
Sampling news batches:  13%|█████████████████▋                                                                                                                          | 189/1496 [11:43<45:27,  2.09s/it][A
Sampling news batches:  13%|█████████████████▊                                                                                                                          | 190/1496 [11:45<43:43,  2.01s/it][A
Sampling news batches:  13%|█████████████████▌                                                                                                                        | 191/1496 [11:50<1:00:48,  2.80s/it][A
Sampling news batches:  13%|█████████████████▉                                                                                                                          | 192/1496 [11:51<52:22,  2.41s/it][A
Sampling news batches:  13%|██████████████████                                                                                                                          | 193/1496 [11:55<57:33,  2.65s/it][A
Sampling news batches:  13%|██████████████████▏                                                                                                                         | 194/1496 [11:56<48:05,  2.22s/it][A
Sampling news batches:  13%|██████████████████▏                                                                                                                         | 195/1496 [11:59<54:31,  2.51s/it][A
Sampling news batches:  13%|██████████████████▎                                                                                                                         | 196/1496 [12:02<55:02,  2.54s/it][A
Sampling news batches:  13%|██████████████████▏                                                                                                                       | 197/1496 [12:05<1:00:18,  2.79s/it][A
Sampling news batches:  13%|██████████████████▌                                                                                                                         | 198/1496 [12:07<54:08,  2.50s/it][A
Sampling news batches:  13%|██████████████████▌                                                                                                                         | 199/1496 [12:09<50:54,  2.36s/it][A
Sampling news batches:  13%|██████████████████▋                                                                                                                         | 200/1496 [12:12<55:34,  2.57s/it][A{'grad': 4.9329670667648315, 'context_loss': 7.753278076648712, 'stance_loss': 1.3840364027023315, 'news_loss': 0.6159432033697764}


Validating rep learning:   0%|                                                                                                                                                    | 0/2211 [00:00<?, ?it/s][A[A

Validating rep learning:   8%|███████████▏                                                                                                                            | 182/2211 [00:00<00:01, 1815.88it/s][A[A

Validating rep learning:  16%|█████████████████████▏                                                                                                                  | 344/2211 [00:00<00:01, 1750.86it/s][A[A

Validating rep learning:  24%|████████████████████████████████▋                                                                                                       | 532/2211 [00:00<00:00, 1787.67it/s][A[A

Validating rep learning:  33%|████████████████████████████████████████████▌                                                                                           | 724/2211 [00:00<00:00, 1823.90it/s][A[A

Validating rep learning:  41%|███████████████████████████████████████████████████████▉                                                                                | 909/2211 [00:00<00:00, 1830.88it/s][A[A

Validating rep learning:  50%|███████████████████████████████████████████████████████████████████                                                                    | 1098/2211 [00:00<00:00, 1846.11it/s][A[A

Validating rep learning:  58%|██████████████████████████████████████████████████████████████████████████████▎                                                        | 1282/2211 [00:00<00:00, 1842.21it/s][A[A

Validating rep learning:  66%|█████████████████████████████████████████████████████████████████████████████████████████▌                                             | 1466/2211 [00:00<00:00, 1839.91it/s][A[A

Validating rep learning:  75%|████████████████████████████████████████████████████████████████████████████████████████████████████▋                                  | 1650/2211 [00:00<00:00, 1838.94it/s][A[A

Validating rep learning:  83%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████▉                       | 1833/2211 [00:01<00:00, 1833.37it/s][A[A

Validating rep learning:  91%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▏           | 2017/2211 [00:01<00:00, 1833.07it/s][A[A

Validating rep learning: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▍| 2201/2211 [00:01<00:00, 1835.12it/s][A[AValidating rep learning: 100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 2211/2211 [00:01<00:00, 1828.93it/s]
{'stance_avg_closed_ratio': 0.9736574598524016, 'stance_avg_far_ratio': 0.9669821473179687, 'other_avg_closed_ratio': 0.9076455076127621, 'other_avg_far_ratio': 0.0}

Sampling news batches:  13%|██████████████████▌                                                                                                                       | 201/1496 [13:13<7:17:40, 20.28s/it][A
Sampling news batches:  14%|██████████████████▋                                                                                                                       | 202/1496 [13:14<5:12:04, 14.47s/it][A
Sampling news batches:  14%|██████████████████▋                                                                                                                       | 203/1496 [13:17<3:52:24, 10.78s/it][A
Sampling news batches:  14%|██████████████████▊                                                                                                                       | 204/1496 [13:18<2:51:41,  7.97s/it][A
Sampling news batches:  14%|██████████████████▉                                                                                                                       | 205/1496 [13:20<2:13:50,  6.22s/it][A
Sampling news batches:  14%|███████████████████                                                                                                                       | 206/1496 [13:23<1:49:47,  5.11s/it][A
Sampling news batches:  14%|███████████████████                                                                                                                       | 207/1496 [13:24<1:28:28,  4.12s/it][A
Sampling news batches:  14%|███████████████████▏                                                                                                                      | 208/1496 [13:26<1:12:18,  3.37s/it][A
Sampling news batches:  14%|███████████████████▎                                                                                                                      | 209/1496 [13:29<1:08:21,  3.19s/it][A
Sampling news batches:  14%|███████████████████▋                                                                                                                        | 210/1496 [13:31<58:49,  2.74s/it][A
Sampling news batches:  14%|███████████████████▋                                                                                                                        | 211/1496 [13:32<48:55,  2.28s/it][A
Sampling news batches:  14%|███████████████████▌                                                                                                                      | 212/1496 [13:38<1:11:27,  3.34s/it][A
Sampling news batches:  14%|███████████████████▉                                                                                                                        | 213/1496 [13:39<56:39,  2.65s/it][A
Sampling news batches:  14%|████████████████████                                                                                                                        | 214/1496 [13:41<53:06,  2.49s/it][A
Sampling news batches:  14%|████████████████████                                                                                                                        | 215/1496 [13:43<50:58,  2.39s/it][A
Sampling news batches:  14%|████████████████████▏                                                                                                                       | 216/1496 [13:45<47:50,  2.24s/it][A
Sampling news batches:  15%|████████████████████▎                                                                                                                       | 217/1496 [13:46<43:33,  2.04s/it][A
Sampling news batches:  15%|████████████████████▍                                                                                                                       | 218/1496 [13:49<50:35,  2.38s/it][A
Sampling news batches:  15%|████████████████████▍                                                                                                                       | 219/1496 [13:51<46:19,  2.18s/it][A
Sampling news batches:  15%|████████████████████▌                                                                                                                       | 220/1496 [13:54<47:17,  2.22s/it][A
Sampling news batches:  15%|████████████████████▋                                                                                                                       | 221/1496 [13:55<45:33,  2.14s/it][A
Sampling news batches:  15%|████████████████████▊                                                                                                                       | 222/1496 [13:57<44:12,  2.08s/it][A
Sampling news batches:  15%|████████████████████▊                                                                                                                       | 223/1496 [13:59<40:47,  1.92s/it][A
Sampling news batches:  15%|████████████████████▉                                                                                                                       | 224/1496 [14:00<34:57,  1.65s/it][A
Sampling news batches:  15%|█████████████████████                                                                                                                       | 225/1496 [14:01<33:10,  1.57s/it][A
Sampling news batches:  15%|█████████████████████▏                                                                                                                      | 226/1496 [14:03<32:58,  1.56s/it][A
Sampling news batches:  15%|█████████████████████▏                                                                                                                      | 227/1496 [14:06<45:54,  2.17s/it][A
Sampling news batches:  15%|█████████████████████▎                                                                                                                      | 228/1496 [14:08<44:34,  2.11s/it][A
Sampling news batches:  15%|█████████████████████▍                                                                                                                      | 229/1496 [14:11<47:19,  2.24s/it][A
Sampling news batches:  15%|█████████████████████▌                                                                                                                      | 230/1496 [14:12<39:34,  1.88s/it][A
Sampling news batches:  15%|█████████████████████▌                                                                                                                      | 231/1496 [14:14<39:56,  1.89s/it][A
Sampling news batches:  16%|█████████████████████▋                                                                                                                      | 232/1496 [14:18<52:38,  2.50s/it][A
Sampling news batches:  16%|█████████████████████▊                                                                                                                      | 233/1496 [14:20<51:45,  2.46s/it][A
Sampling news batches:  16%|█████████████████████▌                                                                                                                    | 234/1496 [14:25<1:07:49,  3.22s/it][A
Sampling news batches:  16%|█████████████████████▉                                                                                                                      | 235/1496 [14:27<59:25,  2.83s/it][A
Sampling news batches:  16%|██████████████████████                                                                                                                      | 236/1496 [14:29<52:42,  2.51s/it][A
Sampling news batches:  16%|██████████████████████▏                                                                                                                     | 237/1496 [14:30<45:01,  2.15s/it][A
Sampling news batches:  16%|██████████████████████▎                                                                                                                     | 238/1496 [14:32<39:52,  1.90s/it][A
Sampling news batches:  16%|██████████████████████▎                                                                                                                     | 239/1496 [14:35<49:09,  2.35s/it][A
Sampling news batches:  16%|██████████████████████▍                                                                                                                     | 240/1496 [14:37<46:11,  2.21s/it][A{'grad': 6.540302753448486, 'context_loss': 7.7382091879844666, 'stance_loss': nan, 'news_loss': 0.5516657292842865}


Validating rep learning:   0%|                                                                                                                                                    | 0/2211 [00:00<?, ?it/s][A[A

Validating rep learning:   8%|███████████▏                                                                                                                            | 181/2211 [00:00<00:01, 1807.03it/s][A[A

Validating rep learning:  18%|████████████████████████▏                                                                                                               | 393/2211 [00:00<00:00, 1890.42it/s][A[A

Validating rep learning:  26%|███████████████████████████████████▊                                                                                                    | 582/2211 [00:00<00:00, 1889.52it/s][A[A

Validating rep learning:  35%|███████████████████████████████████████████████▉                                                                                        | 779/2211 [00:00<00:00, 1911.66it/s][A[A

Validating rep learning:  44%|███████████████████████████████████████████████████████████▌                                                                            | 968/2211 [00:00<00:00, 1902.19it/s][A[A

Validating rep learning:  52%|██████████████████████████████████████████████████████████████████████▍                                                                | 1154/2211 [00:00<00:00, 1889.12it/s][A[A

Validating rep learning:  60%|█████████████████████████████████████████████████████████████████████████████████▋                                                     | 1337/2211 [00:00<00:00, 1869.75it/s][A[A

Validating rep learning:  69%|████████████████████████████████████████████████████████████████████████████████████████████▊                                          | 1520/2211 [00:00<00:00, 1856.85it/s][A[A

Validating rep learning:  77%|███████████████████████████████████████████████████████████████████████████████████████████████████████▉                               | 1703/2211 [00:00<00:00, 1847.68it/s][A[A

Validating rep learning:  85%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████▏                   | 1886/2211 [00:01<00:00, 1840.67it/s][A[A

Validating rep learning:  94%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▎        | 2069/2211 [00:01<00:00, 1836.60it/s][A[AValidating rep learning: 100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 2211/2211 [00:01<00:00, 1873.51it/s]
{'stance_avg_closed_ratio': 0.9821332120976699, 'stance_avg_far_ratio': 0.9722472203254677, 'other_avg_closed_ratio': 1.0844494724113383, 'other_avg_far_ratio': 0.0}

Sampling news batches:  16%|██████████████████████▏                                                                                                                   | 241/1496 [15:41<7:15:37, 20.83s/it][A
Sampling news batches:  16%|██████████████████████▎                                                                                                                   | 242/1496 [15:43<5:16:55, 15.16s/it][A
Sampling news batches:  16%|██████████████████████▍                                                                                                                   | 243/1496 [15:45<3:54:51, 11.25s/it][A
Sampling news batches:  16%|██████████████████████▌                                                                                                                   | 244/1496 [15:46<2:51:31,  8.22s/it][A
Sampling news batches:  16%|██████████████████████▌                                                                                                                   | 245/1496 [15:50<2:23:11,  6.87s/it][A
Sampling news batches:  16%|██████████████████████▋                                                                                                                   | 246/1496 [15:52<1:50:13,  5.29s/it][A
Sampling news batches:  17%|██████████████████████▊                                                                                                                   | 247/1496 [15:54<1:29:45,  4.31s/it][A
Sampling news batches:  17%|██████████████████████▉                                                                                                                   | 248/1496 [15:56<1:18:11,  3.76s/it][A
Sampling news batches:  17%|██████████████████████▉                                                                                                                   | 249/1496 [15:58<1:08:39,  3.30s/it][A
Sampling news batches:  17%|███████████████████████▍                                                                                                                    | 250/1496 [16:00<55:31,  2.67s/it][A
Sampling news batches:  17%|███████████████████████▍                                                                                                                    | 251/1496 [16:01<48:10,  2.32s/it][A
Sampling news batches:  17%|███████████████████████▌                                                                                                                    | 252/1496 [16:04<54:07,  2.61s/it][A
Sampling news batches:  17%|███████████████████████▋                                                                                                                    | 253/1496 [16:07<51:45,  2.50s/it][A
Sampling news batches:  17%|███████████████████████▊                                                                                                                    | 254/1496 [16:08<48:09,  2.33s/it][A
Sampling news batches:  17%|███████████████████████▊                                                                                                                    | 255/1496 [16:10<44:22,  2.15s/it][A
Sampling news batches:  17%|███████████████████████▉                                                                                                                    | 256/1496 [16:13<46:13,  2.24s/it][A
Sampling news batches:  17%|████████████████████████                                                                                                                    | 257/1496 [16:14<40:26,  1.96s/it][A
Sampling news batches:  17%|████████████████████████▏                                                                                                                   | 258/1496 [16:16<40:01,  1.94s/it][A
Sampling news batches:  17%|████████████████████████▏                                                                                                                   | 259/1496 [16:18<38:57,  1.89s/it][A
Sampling news batches:  17%|████████████████████████▎                                                                                                                   | 260/1496 [16:18<30:16,  1.47s/it][A
Sampling news batches:  17%|████████████████████████▍                                                                                                                   | 261/1496 [16:20<30:38,  1.49s/it][A
Sampling news batches:  18%|████████████████████████▌                                                                                                                   | 262/1496 [16:22<36:12,  1.76s/it][A
Sampling news batches:  18%|████████████████████████▌                                                                                                                   | 263/1496 [16:24<37:07,  1.81s/it][A
Sampling news batches:  18%|████████████████████████▎                                                                                                                 | 264/1496 [16:30<1:05:21,  3.18s/it][A
Sampling news batches:  18%|████████████████████████▍                                                                                                                 | 265/1496 [16:33<1:02:04,  3.03s/it][A
Sampling news batches:  18%|████████████████████████▉                                                                                                                   | 266/1496 [16:35<57:15,  2.79s/it][A
Sampling news batches:  18%|████████████████████████▉                                                                                                                   | 267/1496 [16:38<53:54,  2.63s/it][A
Sampling news batches:  18%|█████████████████████████                                                                                                                   | 268/1496 [16:39<47:07,  2.30s/it][A
Sampling news batches:  18%|█████████████████████████▏                                                                                                                  | 269/1496 [16:43<56:10,  2.75s/it][A
Sampling news batches:  18%|█████████████████████████▎                                                                                                                  | 270/1496 [16:45<50:03,  2.45s/it][A
Sampling news batches:  18%|█████████████████████████▎                                                                                                                  | 271/1496 [16:46<46:14,  2.26s/it][A
Sampling news batches:  18%|█████████████████████████▍                                                                                                                  | 272/1496 [16:48<44:33,  2.18s/it][A
Sampling news batches:  18%|█████████████████████████▌                                                                                                                  | 273/1496 [16:51<45:12,  2.22s/it][A
Sampling news batches:  18%|█████████████████████████▋                                                                                                                  | 274/1496 [16:52<42:00,  2.06s/it][A
Sampling news batches:  18%|█████████████████████████▋                                                                                                                  | 275/1496 [16:54<37:42,  1.85s/it][A
Sampling news batches:  18%|█████████████████████████▊                                                                                                                  | 276/1496 [16:56<38:53,  1.91s/it][A
Sampling news batches:  19%|█████████████████████████▉                                                                                                                  | 277/1496 [16:57<37:07,  1.83s/it][A
Sampling news batches:  19%|██████████████████████████                                                                                                                  | 278/1496 [16:58<31:28,  1.55s/it][A
Sampling news batches:  19%|██████████████████████████                                                                                                                  | 279/1496 [17:01<37:51,  1.87s/it][A
Sampling news batches:  19%|██████████████████████████▏                                                                                                                 | 280/1496 [17:03<40:02,  1.98s/it][A{'grad': 4.303432047367096, 'context_loss': 7.73528037071228, 'stance_loss': nan}


Validating rep learning:   0%|                                                                                                                                                    | 0/2211 [00:00<?, ?it/s][A[A

Validating rep learning:   8%|███████████▏                                                                                                                            | 182/2211 [00:00<00:01, 1812.34it/s][A[A

Validating rep learning:  18%|████████████████████████▏                                                                                                               | 394/2211 [00:00<00:00, 1894.67it/s][A[A

Validating rep learning:  26%|███████████████████████████████████▊                                                                                                    | 582/2211 [00:00<00:00, 1888.70it/s][A[A

Validating rep learning:  35%|███████████████████████████████████████████████▊                                                                                        | 778/2211 [00:00<00:00, 1909.52it/s][A[A

Validating rep learning:  44%|███████████████████████████████████████████████████████████▍                                                                            | 966/2211 [00:00<00:00, 1899.89it/s][A[A

Validating rep learning:  52%|██████████████████████████████████████████████████████████████████████▎                                                                | 1151/2211 [00:00<00:00, 1884.49it/s][A[A

Validating rep learning:  60%|█████████████████████████████████████████████████████████████████████████████████▍                                                     | 1334/2211 [00:00<00:00, 1866.35it/s][A[A

Validating rep learning:  69%|████████████████████████████████████████████████████████████████████████████████████████████▌                                          | 1516/2211 [00:00<00:00, 1850.21it/s][A[A

Validating rep learning:  77%|███████████████████████████████████████████████████████████████████████████████████████████████████████▋                               | 1698/2211 [00:00<00:00, 1839.54it/s][A[A

Validating rep learning:  85%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████▊                    | 1880/2211 [00:01<00:00, 1833.40it/s][A[A

Validating rep learning:  93%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▉         | 2063/2211 [00:01<00:00, 1831.55it/s][A[AValidating rep learning: 100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 2211/2211 [00:01<00:00, 1867.62it/s]
{'stance_avg_closed_ratio': 0.9767708208330799, 'stance_avg_far_ratio': 0.9604915098091485, 'other_avg_closed_ratio': 0.994145337642933, 'other_avg_far_ratio': 0.0}

Sampling news batches:  19%|█████████████████████████▉                                                                                                                | 281/1496 [18:09<7:05:17, 21.00s/it][A
Sampling news batches:  19%|██████████████████████████                                                                                                                | 282/1496 [18:10<5:08:43, 15.26s/it][A
Sampling news batches:  19%|██████████████████████████                                                                                                                | 283/1496 [18:13<3:48:37, 11.31s/it][A
Sampling news batches:  19%|██████████████████████████▏                                                                                                               | 284/1496 [18:13<2:43:52,  8.11s/it][A
Sampling news batches:  19%|██████████████████████████▎                                                                                                               | 285/1496 [18:14<1:57:21,  5.81s/it][A
Sampling news batches:  19%|██████████████████████████▍                                                                                                               | 286/1496 [18:15<1:28:13,  4.37s/it][A
Sampling news batches:  19%|██████████████████████████▍                                                                                                               | 287/1496 [18:16<1:11:32,  3.55s/it][A
Sampling news batches:  19%|██████████████████████████▌                                                                                                               | 288/1496 [18:18<1:03:11,  3.14s/it][A
Sampling news batches:  19%|███████████████████████████                                                                                                                 | 289/1496 [18:20<52:30,  2.61s/it][A
Sampling news batches:  19%|███████████████████████████▏                                                                                                                | 290/1496 [18:22<46:46,  2.33s/it][A
Sampling news batches:  19%|███████████████████████████▏                                                                                                                | 291/1496 [18:24<46:49,  2.33s/it][A
Sampling news batches:  20%|███████████████████████████▎                                                                                                                | 292/1496 [18:26<43:40,  2.18s/it][A
Sampling news batches:  20%|███████████████████████████▍                                                                                                                | 293/1496 [18:26<31:48,  1.59s/it][A
Sampling news batches:  20%|███████████████████████████▌                                                                                                                | 294/1496 [18:28<33:10,  1.66s/it][A
Sampling news batches:  20%|███████████████████████████▌                                                                                                                | 295/1496 [18:30<39:42,  1.98s/it][A
Sampling news batches:  20%|███████████████████████████▋                                                                                                                | 296/1496 [18:33<40:27,  2.02s/it][A
Sampling news batches:  20%|███████████████████████████▊                                                                                                                | 297/1496 [18:34<36:16,  1.82s/it][A
Sampling news batches:  20%|███████████████████████████▉                                                                                                                | 298/1496 [18:36<40:49,  2.04s/it][A
Sampling news batches:  20%|███████████████████████████▉                                                                                                                | 299/1496 [18:37<33:25,  1.68s/it][A
Sampling news batches:  20%|████████████████████████████                                                                                                                | 300/1496 [18:40<39:12,  1.97s/it][A
Sampling news batches:  20%|████████████████████████████▏                                                                                                               | 301/1496 [18:43<43:21,  2.18s/it][A
Sampling news batches:  20%|████████████████████████████▎                                                                                                               | 302/1496 [18:45<45:26,  2.28s/it][A
Sampling news batches:  20%|████████████████████████████▎                                                                                                               | 303/1496 [18:46<37:39,  1.89s/it][A
Sampling news batches:  20%|████████████████████████████▍                                                                                                               | 304/1496 [18:48<40:13,  2.02s/it][A
Sampling news batches:  20%|████████████████████████████▌                                                                                                               | 305/1496 [18:51<41:51,  2.11s/it][A
Sampling news batches:  20%|████████████████████████████▋                                                                                                               | 306/1496 [18:53<41:59,  2.12s/it][A
Sampling news batches:  21%|████████████████████████████▋                                                                                                               | 307/1496 [18:55<40:45,  2.06s/it][A
Sampling news batches:  21%|████████████████████████████▊                                                                                                               | 308/1496 [18:57<41:38,  2.10s/it][A
Sampling news batches:  21%|████████████████████████████▉                                                                                                               | 309/1496 [19:00<46:47,  2.37s/it][A
Sampling news batches:  21%|█████████████████████████████                                                                                                               | 310/1496 [19:01<37:34,  1.90s/it][A
Sampling news batches:  21%|█████████████████████████████                                                                                                               | 311/1496 [19:02<33:37,  1.70s/it][A
Sampling news batches:  21%|█████████████████████████████▏                                                                                                              | 312/1496 [19:03<30:22,  1.54s/it][A
Sampling news batches:  21%|█████████████████████████████▎                                                                                                              | 313/1496 [19:05<29:30,  1.50s/it][A
Sampling news batches:  21%|█████████████████████████████▍                                                                                                              | 314/1496 [19:06<29:22,  1.49s/it][A
Sampling news batches:  21%|█████████████████████████████▍                                                                                                              | 315/1496 [19:09<38:18,  1.95s/it][A
Sampling news batches:  21%|█████████████████████████████▌                                                                                                              | 316/1496 [19:11<37:01,  1.88s/it][A
Sampling news batches:  21%|█████████████████████████████▋                                                                                                              | 317/1496 [19:13<38:16,  1.95s/it][A
Sampling news batches:  21%|█████████████████████████████▊                                                                                                              | 318/1496 [19:14<34:17,  1.75s/it][A
Sampling news batches:  21%|█████████████████████████████▊                                                                                                              | 319/1496 [19:17<42:58,  2.19s/it][A
Sampling news batches:  21%|█████████████████████████████▉                                                                                                              | 320/1496 [19:19<40:02,  2.04s/it][A{'grad': 6.398523569107056, 'context_loss': 7.745546567440033, 'stance_loss': 1.3774034210613795, 'news_loss': 0.4651587188243866}


Validating rep learning:   0%|                                                                                                                                                    | 0/2211 [00:00<?, ?it/s][A[A

Validating rep learning:   8%|███████████                                                                                                                             | 180/2211 [00:00<00:01, 1796.48it/s][A[A

Validating rep learning:  18%|████████████████████████                                                                                                                | 392/2211 [00:00<00:00, 1880.53it/s][A[A

Validating rep learning:  26%|███████████████████████████████████▌                                                                                                    | 578/2211 [00:00<00:00, 1872.54it/s][A[A

Validating rep learning:  35%|███████████████████████████████████████████████▍                                                                                        | 772/2211 [00:00<00:00, 1890.22it/s][A[A

Validating rep learning:  43%|██████████████████████████████████████████████████████████▉                                                                             | 959/2211 [00:00<00:00, 1882.60it/s][A[A

Validating rep learning:  52%|█████████████████████████████████████████████████████████████████████▊                                                                 | 1144/2211 [00:00<00:00, 1870.23it/s][A[A

Validating rep learning:  60%|████████████████████████████████████████████████████████████████████████████████▉                                                      | 1325/2211 [00:00<00:00, 1849.05it/s][A[A

Validating rep learning:  68%|████████████████████████████████████████████████████████████████████████████████████████████                                           | 1507/2211 [00:00<00:00, 1838.21it/s][A[A

Validating rep learning:  76%|███████████████████████████████████████████████████████████████████████████████████████████████████████                                | 1688/2211 [00:00<00:00, 1827.35it/s][A[A

Validating rep learning:  85%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████▏                    | 1870/2211 [00:01<00:00, 1822.45it/s][A[A

Validating rep learning:  93%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▎         | 2053/2211 [00:01<00:00, 1822.23it/s][A[AValidating rep learning: 100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 2211/2211 [00:01<00:00, 1855.09it/s]
{'stance_avg_closed_ratio': 0.9778640118339565, 'stance_avg_far_ratio': 1.005783972158601, 'other_avg_closed_ratio': 1.0378198036292736, 'other_avg_far_ratio': 0.0}

Sampling news batches:  21%|█████████████████████████████▌                                                                                                            | 321/1496 [20:23<6:41:18, 20.49s/it][A
Sampling news batches:  22%|█████████████████████████████▋                                                                                                            | 322/1496 [20:24<4:48:56, 14.77s/it][A
Sampling news batches:  22%|█████████████████████████████▊                                                                                                            | 323/1496 [20:26<3:33:39, 10.93s/it][A
Sampling news batches:  22%|█████████████████████████████▉                                                                                                            | 324/1496 [20:29<2:44:44,  8.43s/it][A
Sampling news batches:  22%|█████████████████████████████▉                                                                                                            | 325/1496 [20:31<2:10:25,  6.68s/it][A
Sampling news batches:  22%|██████████████████████████████                                                                                                            | 326/1496 [20:34<1:45:06,  5.39s/it][A
Sampling news batches:  22%|██████████████████████████████▏                                                                                                           | 327/1496 [20:35<1:21:42,  4.19s/it][A
Sampling news batches:  22%|██████████████████████████████▎                                                                                                           | 328/1496 [20:37<1:06:55,  3.44s/it][A
Sampling news batches:  22%|██████████████████████████████▊                                                                                                             | 329/1496 [20:38<55:13,  2.84s/it][A
Sampling news batches:  22%|██████████████████████████████▉                                                                                                             | 330/1496 [20:40<49:11,  2.53s/it][A
Sampling news batches:  22%|██████████████████████████████▉                                                                                                             | 331/1496 [20:43<50:06,  2.58s/it][A
Sampling news batches:  22%|███████████████████████████████                                                                                                             | 332/1496 [20:44<44:29,  2.29s/it][A
Sampling news batches:  22%|███████████████████████████████▏                                                                                                            | 333/1496 [20:46<40:02,  2.07s/it][A
Sampling news batches:  22%|███████████████████████████████▎                                                                                                            | 334/1496 [20:48<42:00,  2.17s/it][A
Sampling news batches:  22%|███████████████████████████████▎                                                                                                            | 335/1496 [20:50<41:03,  2.12s/it][A
Sampling news batches:  22%|███████████████████████████████▍                                                                                                            | 336/1496 [20:52<36:52,  1.91s/it][A
Sampling news batches:  23%|███████████████████████████████▌                                                                                                            | 337/1496 [20:54<37:50,  1.96s/it][A
Sampling news batches:  23%|███████████████████████████████▋                                                                                                            | 338/1496 [20:57<43:07,  2.23s/it][A
Sampling news batches:  23%|███████████████████████████████▋                                                                                                            | 339/1496 [20:59<44:52,  2.33s/it][A
Sampling news batches:  23%|███████████████████████████████▎                                                                                                          | 340/1496 [21:05<1:03:37,  3.30s/it][A
Sampling news batches:  23%|███████████████████████████████▉                                                                                                            | 341/1496 [21:07<56:16,  2.92s/it][A
Sampling news batches:  23%|████████████████████████████████                                                                                                            | 342/1496 [21:09<52:02,  2.71s/it][A
Sampling news batches:  23%|████████████████████████████████                                                                                                            | 343/1496 [21:11<50:06,  2.61s/it][A
Sampling news batches:  23%|████████████████████████████████▏                                                                                                           | 344/1496 [21:14<51:08,  2.66s/it][A
Sampling news batches:  23%|████████████████████████████████▎                                                                                                           | 345/1496 [21:16<43:29,  2.27s/it][A
Sampling news batches:  23%|████████████████████████████████▍                                                                                                           | 346/1496 [21:19<51:14,  2.67s/it][A
Sampling news batches:  23%|████████████████████████████████▍                                                                                                           | 347/1496 [21:22<50:44,  2.65s/it][A
Sampling news batches:  23%|████████████████████████████████▌                                                                                                           | 348/1496 [21:24<47:25,  2.48s/it][A
Sampling news batches:  23%|████████████████████████████████▋                                                                                                           | 349/1496 [21:25<42:39,  2.23s/it][A
Sampling news batches:  23%|████████████████████████████████▊                                                                                                           | 350/1496 [21:28<42:53,  2.25s/it][A
Sampling news batches:  23%|████████████████████████████████▊                                                                                                           | 351/1496 [21:30<40:25,  2.12s/it][A
Sampling news batches:  24%|████████████████████████████████▉                                                                                                           | 352/1496 [21:32<41:53,  2.20s/it][A
Sampling news batches:  24%|█████████████████████████████████                                                                                                           | 353/1496 [21:33<36:06,  1.90s/it][A
Sampling news batches:  24%|█████████████████████████████████▏                                                                                                          | 354/1496 [21:35<34:10,  1.80s/it][A
Sampling news batches:  24%|█████████████████████████████████▏                                                                                                          | 355/1496 [21:37<34:36,  1.82s/it][A
Sampling news batches:  24%|█████████████████████████████████▎                                                                                                          | 356/1496 [21:39<40:34,  2.14s/it][A
Sampling news batches:  24%|█████████████████████████████████▍                                                                                                          | 357/1496 [21:41<37:07,  1.96s/it][A
Sampling news batches:  24%|█████████████████████████████████▌                                                                                                          | 358/1496 [21:43<38:01,  2.00s/it][A
Sampling news batches:  24%|█████████████████████████████████▌                                                                                                          | 359/1496 [21:47<50:30,  2.67s/it][A
Sampling news batches:  24%|█████████████████████████████████▋                                                                                                          | 360/1496 [21:48<38:40,  2.04s/it][A{'grad': 4.162670791149139, 'context_loss': 7.767438769340515, 'stance_loss': nan, 'news_loss': 0.7407757043838501}


Validating rep learning:   0%|                                                                                                                                                    | 0/2211 [00:00<?, ?it/s][A[A

Validating rep learning:   9%|███████████▌                                                                                                                            | 188/2211 [00:00<00:01, 1871.84it/s][A[A

Validating rep learning:  17%|███████████████████████▋                                                                                                                | 385/2211 [00:00<00:00, 1899.50it/s][A[A

Validating rep learning:  26%|███████████████████████████████████▎                                                                                                    | 574/2211 [00:00<00:00, 1895.17it/s][A[A

Validating rep learning:  35%|███████████████████████████████████████████████▍                                                                                        | 771/2211 [00:00<00:00, 1915.95it/s][A[A

Validating rep learning:  43%|███████████████████████████████████████████████████████████                                                                             | 960/2211 [00:00<00:00, 1905.27it/s][A[A

Validating rep learning:  52%|██████████████████████████████████████████████████████████████████████                                                                 | 1147/2211 [00:00<00:00, 1893.51it/s][A[A

Validating rep learning:  60%|█████████████████████████████████████████████████████████████████████████████████▏                                                     | 1330/2211 [00:00<00:00, 1873.97it/s][A[A

Validating rep learning:  68%|████████████████████████████████████████████████████████████████████████████████████████████▍                                          | 1514/2211 [00:00<00:00, 1862.07it/s][A[A

Validating rep learning:  77%|███████████████████████████████████████████████████████████████████████████████████████████████████████▋                               | 1698/2211 [00:00<00:00, 1852.68it/s][A[A

Validating rep learning:  85%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████▉                    | 1882/2211 [00:01<00:00, 1846.39it/s][A[A

Validating rep learning:  93%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▏        | 2066/2211 [00:01<00:00, 1843.68it/s][A[AValidating rep learning: 100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 2211/2211 [00:01<00:00, 1869.62it/s]
{'stance_avg_closed_ratio': 0.9796187930650436, 'stance_avg_far_ratio': 0.982638853504064, 'other_avg_closed_ratio': 0.9947176308794866, 'other_avg_far_ratio': 0.0}

Sampling news batches:  24%|█████████████████████████████████▎                                                                                                        | 361/1496 [22:53<6:38:50, 21.08s/it][A
Sampling news batches:  24%|█████████████████████████████████▍                                                                                                        | 362/1496 [22:55<4:48:35, 15.27s/it][A
Sampling news batches:  24%|█████████████████████████████████▍                                                                                                        | 363/1496 [22:56<3:27:11, 10.97s/it][A
Sampling news batches:  24%|█████████████████████████████████▌                                                                                                        | 364/1496 [22:58<2:33:23,  8.13s/it][A
Sampling news batches:  24%|█████████████████████████████████▋                                                                                                        | 365/1496 [22:59<1:56:07,  6.16s/it][A
Sampling news batches:  24%|█████████████████████████████████▊                                                                                                        | 366/1496 [23:01<1:31:45,  4.87s/it][A
Sampling news batches:  25%|█████████████████████████████████▊                                                                                                        | 367/1496 [23:03<1:15:09,  3.99s/it][A
Sampling news batches:  25%|██████████████████████████████████▍                                                                                                         | 368/1496 [23:04<57:54,  3.08s/it][A
Sampling news batches:  25%|██████████████████████████████████▌                                                                                                         | 369/1496 [23:05<49:38,  2.64s/it][A
Sampling news batches:  25%|██████████████████████████████████▋                                                                                                         | 370/1496 [23:09<51:56,  2.77s/it][A
Sampling news batches:  25%|██████████████████████████████████▋                                                                                                         | 371/1496 [23:10<45:17,  2.42s/it][A
Sampling news batches:  25%|██████████████████████████████████▊                                                                                                         | 372/1496 [23:12<44:14,  2.36s/it][A
Sampling news batches:  25%|██████████████████████████████████▉                                                                                                         | 373/1496 [23:15<45:24,  2.43s/it][A
Sampling news batches:  25%|███████████████████████████████████                                                                                                         | 374/1496 [23:17<41:38,  2.23s/it][A
Sampling news batches:  25%|███████████████████████████████████                                                                                                         | 375/1496 [23:20<48:12,  2.58s/it][A
Sampling news batches:  25%|███████████████████████████████████▏                                                                                                        | 376/1496 [23:22<43:43,  2.34s/it][A
Sampling news batches:  25%|███████████████████████████████████▎                                                                                                        | 377/1496 [23:23<39:08,  2.10s/it][A
Sampling news batches:  25%|███████████████████████████████████▎                                                                                                        | 378/1496 [23:25<35:00,  1.88s/it][A
Sampling news batches:  25%|███████████████████████████████████▍                                                                                                        | 379/1496 [23:25<25:57,  1.39s/it][A
Sampling news batches:  25%|███████████████████████████████████▌                                                                                                        | 380/1496 [23:26<24:42,  1.33s/it][A
Sampling news batches:  25%|███████████████████████████████████▋                                                                                                        | 381/1496 [23:29<32:41,  1.76s/it][A
Sampling news batches:  26%|███████████████████████████████████▋                                                                                                        | 382/1496 [23:31<32:40,  1.76s/it][A
Sampling news batches:  26%|███████████████████████████████████▊                                                                                                        | 383/1496 [23:33<33:29,  1.81s/it][A
Sampling news batches:  26%|███████████████████████████████████▉                                                                                                        | 384/1496 [23:35<35:44,  1.93s/it][A
Sampling news batches:  26%|████████████████████████████████████                                                                                                        | 385/1496 [23:37<39:04,  2.11s/it][A
Sampling news batches:  26%|████████████████████████████████████                                                                                                        | 386/1496 [23:39<38:43,  2.09s/it][A
Sampling news batches:  26%|████████████████████████████████████▏                                                                                                       | 387/1496 [23:41<36:34,  1.98s/it][A
Sampling news batches:  26%|████████████████████████████████████▎                                                                                                       | 388/1496 [23:43<34:55,  1.89s/it][A
Sampling news batches:  26%|████████████████████████████████████▍                                                                                                       | 389/1496 [23:44<30:21,  1.65s/it][A
Sampling news batches:  26%|████████████████████████████████████▍                                                                                                       | 390/1496 [23:45<27:41,  1.50s/it][A
Sampling news batches:  26%|████████████████████████████████████▌                                                                                                       | 391/1496 [23:47<30:53,  1.68s/it][A
Sampling news batches:  26%|████████████████████████████████████▋                                                                                                       | 392/1496 [23:49<31:49,  1.73s/it][A
Sampling news batches:  26%|████████████████████████████████████▊                                                                                                       | 393/1496 [23:50<28:34,  1.55s/it][A
Sampling news batches:  26%|████████████████████████████████████▊                                                                                                       | 394/1496 [23:53<33:18,  1.81s/it][A
Sampling news batches:  26%|████████████████████████████████████▉                                                                                                       | 395/1496 [23:55<34:15,  1.87s/it][A
Sampling news batches:  26%|█████████████████████████████████████                                                                                                       | 396/1496 [23:56<33:43,  1.84s/it][A
Sampling news batches:  27%|█████████████████████████████████████▏                                                                                                      | 397/1496 [23:58<31:35,  1.73s/it][A
Sampling news batches:  27%|█████████████████████████████████████▏                                                                                                      | 398/1496 [23:59<25:55,  1.42s/it][A
Sampling news batches:  27%|█████████████████████████████████████▎                                                                                                      | 399/1496 [24:00<28:02,  1.53s/it][A
Sampling news batches:  27%|█████████████████████████████████████▍                                                                                                      | 400/1496 [24:04<39:09,  2.14s/it][A{'grad': 3.851461887359619, 'context_loss': 7.716159868240356, 'stance_loss': 1.3699433370070024, 'news_loss': 0.6743042916059494}


Validating rep learning:   0%|                                                                                                                                                    | 0/2211 [00:00<?, ?it/s][A[A

Validating rep learning:   4%|█████▋                                                                                                                                    | 91/2211 [00:00<00:02, 883.17it/s][A[A

Validating rep learning:  10%|██████████████▍                                                                                                                          | 232/2211 [00:00<00:01, 993.79it/s][A[A

Validating rep learning:  20%|███████████████████████████▎                                                                                                            | 444/2211 [00:00<00:01, 1181.67it/s][A[A

Validating rep learning:  29%|███████████████████████████████████████▎                                                                                                | 640/2211 [00:00<00:01, 1340.37it/s][A[A

Validating rep learning:  37%|██████████████████████████████████████████████████▉                                                                                     | 829/2211 [00:00<00:00, 1467.92it/s][A[A

Validating rep learning:  46%|██████████████████████████████████████████████████████████████                                                                         | 1016/2211 [00:00<00:00, 1568.16it/s][A[A

Validating rep learning:  54%|█████████████████████████████████████████████████████████████████████████                                                              | 1197/2211 [00:00<00:00, 1631.45it/s][A[A

Validating rep learning:  62%|███████████████████████████████████████████████████████████████████████████████████▉                                                   | 1375/2211 [00:00<00:00, 1672.42it/s][A[A

Validating rep learning:  70%|███████████████████████████████████████████████████████████████████████████████████████████████▏                                       | 1558/2211 [00:00<00:00, 1714.66it/s][A[A

Validating rep learning:  79%|██████████████████████████████████████████████████████████████████████████████████████████████████████████▏                            | 1740/2211 [00:01<00:00, 1744.52it/s][A[A

Validating rep learning:  87%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▎                 | 1922/2211 [00:01<00:00, 1764.53it/s][A[A

Validating rep learning:  95%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▌      | 2105/2211 [00:01<00:00, 1781.53it/s][A[AValidating rep learning: 100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 2211/2211 [00:01<00:00, 1747.76it/s]
{'stance_avg_closed_ratio': 0.9727727124364878, 'stance_avg_far_ratio': 0.9864074936562512, 'other_avg_closed_ratio': 0.986078419229962, 'other_avg_far_ratio': 0.0}

Sampling news batches:  27%|████████████████████████████████████▉                                                                                                     | 401/1496 [25:09<6:24:11, 21.05s/it][A
Sampling news batches:  27%|█████████████████████████████████████                                                                                                     | 402/1496 [25:13<4:51:02, 15.96s/it][A
Sampling news batches:  27%|█████████████████████████████████████▏                                                                                                    | 403/1496 [25:17<3:42:32, 12.22s/it][A
Sampling news batches:  27%|█████████████████████████████████████▎                                                                                                    | 404/1496 [25:18<2:43:04,  8.96s/it][A
Sampling news batches:  27%|█████████████████████████████████████▎                                                                                                    | 405/1496 [25:21<2:08:36,  7.07s/it][A
Sampling news batches:  27%|█████████████████████████████████████▍                                                                                                    | 406/1496 [25:22<1:36:10,  5.29s/it][A
Sampling news batches:  27%|█████████████████████████████████████▌                                                                                                    | 407/1496 [25:24<1:16:21,  4.21s/it][A
Sampling news batches:  27%|██████████████████████████████████████▏                                                                                                     | 408/1496 [25:24<58:43,  3.24s/it][A
Sampling news batches:  27%|██████████████████████████████████████▎                                                                                                     | 409/1496 [25:26<49:33,  2.74s/it][A
Sampling news batches:  27%|██████████████████████████████████████▎                                                                                                     | 410/1496 [25:31<59:11,  3.27s/it][A
Sampling news batches:  27%|██████████████████████████████████████▍                                                                                                     | 411/1496 [25:33<57:13,  3.16s/it][A
Sampling news batches:  28%|██████████████████████████████████████▌                                                                                                     | 412/1496 [25:35<49:42,  2.75s/it][A
Sampling news batches:  28%|██████████████████████████████████████▋                                                                                                     | 413/1496 [25:37<45:22,  2.51s/it][A
Sampling news batches:  28%|██████████████████████████████████████▋                                                                                                     | 414/1496 [25:38<38:24,  2.13s/it][A
Sampling news batches:  28%|██████████████████████████████████████▊                                                                                                     | 415/1496 [25:40<33:54,  1.88s/it][A
Sampling news batches:  28%|██████████████████████████████████████▉                                                                                                     | 416/1496 [25:42<36:42,  2.04s/it][A
Sampling news batches:  28%|███████████████████████████████████████                                                                                                     | 417/1496 [25:48<54:31,  3.03s/it][A
Sampling news batches:  28%|███████████████████████████████████████                                                                                                     | 418/1496 [25:49<47:41,  2.65s/it][A
Sampling news batches:  28%|███████████████████████████████████████▏                                                                                                    | 419/1496 [25:51<45:12,  2.52s/it][A
Sampling news batches:  28%|███████████████████████████████████████▎                                                                                                    | 420/1496 [25:53<38:47,  2.16s/it][A
Sampling news batches:  28%|███████████████████████████████████████▍                                                                                                    | 421/1496 [25:55<38:12,  2.13s/it][A
Sampling news batches:  28%|███████████████████████████████████████▍                                                                                                    | 422/1496 [25:57<39:30,  2.21s/it][A
Sampling news batches:  28%|███████████████████████████████████████▌                                                                                                    | 423/1496 [25:59<38:50,  2.17s/it][A
Sampling news batches:  28%|███████████████████████████████████████▋                                                                                                    | 424/1496 [26:01<34:40,  1.94s/it][A
Sampling news batches:  28%|███████████████████████████████████████▊                                                                                                    | 425/1496 [26:02<32:52,  1.84s/it][A
Sampling news batches:  28%|███████████████████████████████████████▊                                                                                                    | 426/1496 [26:04<29:05,  1.63s/it][A
Sampling news batches:  29%|███████████████████████████████████████▉                                                                                                    | 427/1496 [26:06<31:35,  1.77s/it][A
Sampling news batches:  29%|████████████████████████████████████████                                                                                                    | 428/1496 [26:07<30:02,  1.69s/it][A
Sampling news batches:  29%|████████████████████████████████████████▏                                                                                                   | 429/1496 [26:08<24:51,  1.40s/it][A
Sampling news batches:  29%|████████████████████████████████████████▏                                                                                                   | 430/1496 [26:09<23:49,  1.34s/it][A
Sampling news batches:  29%|████████████████████████████████████████▎                                                                                                   | 431/1496 [26:11<26:39,  1.50s/it][A
Sampling news batches:  29%|████████████████████████████████████████▍                                                                                                   | 432/1496 [26:12<24:13,  1.37s/it][A
Sampling news batches:  29%|████████████████████████████████████████▌                                                                                                   | 433/1496 [26:15<31:00,  1.75s/it][A
Sampling news batches:  29%|████████████████████████████████████████▌                                                                                                   | 434/1496 [26:17<33:38,  1.90s/it][A
Sampling news batches:  29%|████████████████████████████████████████▋                                                                                                   | 435/1496 [26:20<42:04,  2.38s/it][A
Sampling news batches:  29%|████████████████████████████████████████▊                                                                                                   | 436/1496 [26:23<41:45,  2.36s/it][A
Sampling news batches:  29%|████████████████████████████████████████▉                                                                                                   | 437/1496 [26:24<37:00,  2.10s/it][A
Sampling news batches:  29%|████████████████████████████████████████▉                                                                                                   | 438/1496 [26:27<38:44,  2.20s/it][A
Sampling news batches:  29%|█████████████████████████████████████████                                                                                                   | 439/1496 [26:29<39:20,  2.23s/it][A
Sampling news batches:  29%|█████████████████████████████████████████▏                                                                                                  | 440/1496 [26:31<38:05,  2.16s/it][A{'grad': 3.9272711277008057, 'context_loss': 7.754254221916199, 'stance_loss': 1.3613755168585941}


Validating rep learning:   0%|                                                                                                                                                    | 0/2211 [00:00<?, ?it/s][A[A

Validating rep learning:   8%|███████████▏                                                                                                                            | 182/2211 [00:00<00:01, 1815.38it/s][A[A

Validating rep learning:  18%|███████████████████████▉                                                                                                                | 389/2211 [00:00<00:00, 1883.06it/s][A[A

Validating rep learning:  26%|███████████████████████████████████▍                                                                                                    | 577/2211 [00:00<00:00, 1880.64it/s][A[A

Validating rep learning:  35%|███████████████████████████████████████████████▋                                                                                        | 775/2211 [00:00<00:00, 1907.53it/s][A[A

Validating rep learning:  43%|███████████████████████████████████████████████████████████                                                                             | 960/2211 [00:00<00:00, 1888.12it/s][A[A

Validating rep learning:  52%|█████████████████████████████████████████████████████████████████████▋                                                                 | 1141/2211 [00:00<00:00, 1861.34it/s][A[A

Validating rep learning:  60%|████████████████████████████████████████████████████████████████████████████████▋                                                      | 1322/2211 [00:00<00:00, 1844.18it/s][A[A

Validating rep learning:  68%|███████████████████████████████████████████████████████████████████████████████████████████▊                                           | 1503/2211 [00:00<00:00, 1833.08it/s][A[A

Validating rep learning:  76%|██████████████████████████████████████████████████████████████████████████████████████████████████████▉                                | 1685/2211 [00:00<00:00, 1828.26it/s][A[A

Validating rep learning:  84%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████▉                     | 1867/2211 [00:01<00:00, 1825.50it/s][A[A

Validating rep learning:  93%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████          | 2049/2211 [00:01<00:00, 1822.04it/s][A[AValidating rep learning: 100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 2211/2211 [00:01<00:00, 1855.70it/s]
{'stance_avg_closed_ratio': 0.9744259896457682, 'stance_avg_far_ratio': 0.991254899430475, 'other_avg_closed_ratio': 0.9387102824739897, 'other_avg_far_ratio': 0.0}

Sampling news batches:  29%|████████████████████████████████████████▋                                                                                                 | 441/1496 [27:37<6:14:27, 21.30s/it][A
Sampling news batches:  30%|████████████████████████████████████████▊                                                                                                 | 442/1496 [27:39<4:31:46, 15.47s/it][A
Sampling news batches:  30%|████████████████████████████████████████▊                                                                                                 | 443/1496 [27:42<3:27:33, 11.83s/it][A
Sampling news batches:  30%|████████████████████████████████████████▉                                                                                                 | 444/1496 [27:44<2:34:33,  8.82s/it][A
Sampling news batches:  30%|█████████████████████████████████████████                                                                                                 | 445/1496 [27:46<1:58:56,  6.79s/it][A
Sampling news batches:  30%|█████████████████████████████████████████▏                                                                                                | 446/1496 [27:47<1:27:39,  5.01s/it][A
Sampling news batches:  30%|█████████████████████████████████████████▏                                                                                                | 447/1496 [27:48<1:09:50,  4.00s/it][A
Sampling news batches:  30%|█████████████████████████████████████████▉                                                                                                  | 448/1496 [27:50<57:44,  3.31s/it][A
Sampling news batches:  30%|██████████████████████████████████████████                                                                                                  | 449/1496 [27:53<54:14,  3.11s/it][A
Sampling news batches:  30%|██████████████████████████████████████████                                                                                                  | 450/1496 [27:56<55:54,  3.21s/it][A
Sampling news batches:  30%|██████████████████████████████████████████▏                                                                                                 | 451/1496 [27:58<49:50,  2.86s/it][A
Sampling news batches:  30%|██████████████████████████████████████████▎                                                                                                 | 452/1496 [28:01<50:22,  2.89s/it][A
Sampling news batches:  30%|██████████████████████████████████████████▍                                                                                                 | 453/1496 [28:02<39:23,  2.27s/it][A
Sampling news batches:  30%|██████████████████████████████████████████▍                                                                                                 | 454/1496 [28:04<36:07,  2.08s/it][A
Sampling news batches:  30%|██████████████████████████████████████████▌                                                                                                 | 455/1496 [28:05<34:32,  1.99s/it][A
Sampling news batches:  30%|██████████████████████████████████████████▋                                                                                                 | 456/1496 [28:07<33:35,  1.94s/it][A
Sampling news batches:  31%|██████████████████████████████████████████▊                                                                                                 | 457/1496 [28:09<34:01,  1.97s/it][A
Sampling news batches:  31%|██████████████████████████████████████████▊                                                                                                 | 458/1496 [28:11<31:50,  1.84s/it][A
Sampling news batches:  31%|██████████████████████████████████████████▉                                                                                                 | 459/1496 [28:13<32:25,  1.88s/it][A
Sampling news batches:  31%|███████████████████████████████████████████                                                                                                 | 460/1496 [28:15<34:11,  1.98s/it][A
Sampling news batches:  31%|███████████████████████████████████████████▏                                                                                                | 461/1496 [28:16<31:08,  1.81s/it][A
Sampling news batches:  31%|███████████████████████████████████████████▏                                                                                                | 462/1496 [28:17<24:32,  1.42s/it][A
Sampling news batches:  31%|███████████████████████████████████████████▎                                                                                                | 463/1496 [28:18<22:55,  1.33s/it][A
Sampling news batches:  31%|███████████████████████████████████████████▍                                                                                                | 464/1496 [28:19<21:06,  1.23s/it][A
Sampling news batches:  31%|███████████████████████████████████████████▌                                                                                                | 465/1496 [28:22<28:10,  1.64s/it][A
Sampling news batches:  31%|███████████████████████████████████████████▌                                                                                                | 466/1496 [28:23<25:10,  1.47s/it][A
Sampling news batches:  31%|███████████████████████████████████████████▋                                                                                                | 467/1496 [28:24<24:12,  1.41s/it][A
Sampling news batches:  31%|███████████████████████████████████████████▊                                                                                                | 468/1496 [28:25<21:14,  1.24s/it][A
Sampling news batches:  31%|███████████████████████████████████████████▉                                                                                                | 469/1496 [28:26<23:24,  1.37s/it][A
Sampling news batches:  31%|███████████████████████████████████████████▉                                                                                                | 470/1496 [28:30<34:50,  2.04s/it][A
Sampling news batches:  31%|████████████████████████████████████████████                                                                                                | 471/1496 [28:32<34:17,  2.01s/it][A
Sampling news batches:  32%|████████████████████████████████████████████▏                                                                                               | 472/1496 [28:34<33:23,  1.96s/it][A
Sampling news batches:  32%|████████████████████████████████████████████▎                                                                                               | 473/1496 [28:35<30:05,  1.76s/it][A
Sampling news batches:  32%|████████████████████████████████████████████▎                                                                                               | 474/1496 [28:36<27:03,  1.59s/it][A
Sampling news batches:  32%|████████████████████████████████████████████▍                                                                                               | 475/1496 [28:38<27:43,  1.63s/it][A
Sampling news batches:  32%|████████████████████████████████████████████▌                                                                                               | 476/1496 [28:39<25:37,  1.51s/it][A
Sampling news batches:  32%|████████████████████████████████████████████▋                                                                                               | 477/1496 [28:41<26:36,  1.57s/it][A
Sampling news batches:  32%|████████████████████████████████████████████▋                                                                                               | 478/1496 [28:43<30:10,  1.78s/it][A
Sampling news batches:  32%|████████████████████████████████████████████▊                                                                                               | 479/1496 [28:44<26:34,  1.57s/it][A
Sampling news batches:  32%|████████████████████████████████████████████▉                                                                                               | 480/1496 [28:46<29:26,  1.74s/it][A{'grad': 5.7904908657073975, 'context_loss': 7.694008457660675, 'stance_loss': nan, 'news_loss': 0.7547347843647003}


Validating rep learning:   0%|                                                                                                                                                    | 0/2211 [00:00<?, ?it/s][A[A

Validating rep learning:   8%|███████████                                                                                                                             | 180/2211 [00:00<00:01, 1796.12it/s][A[A

Validating rep learning:  18%|███████████████████████▊                                                                                                                | 387/2211 [00:00<00:00, 1868.81it/s][A[A

Validating rep learning:  26%|███████████████████████████████████▎                                                                                                    | 574/2211 [00:00<00:00, 1867.76it/s][A[A

Validating rep learning:  35%|███████████████████████████████████████████████▎                                                                                        | 770/2211 [00:00<00:00, 1891.65it/s][A[A

Validating rep learning:  43%|██████████████████████████████████████████████████████████▊                                                                             | 957/2211 [00:00<00:00, 1882.03it/s][A[A

Validating rep learning:  52%|█████████████████████████████████████████████████████████████████████▋                                                                 | 1142/2211 [00:00<00:00, 1870.66it/s][A[A

Validating rep learning:  60%|████████████████████████████████████████████████████████████████████████████████▊                                                      | 1323/2211 [00:00<00:00, 1851.88it/s][A[A

Validating rep learning:  68%|███████████████████████████████████████████████████████████████████████████████████████████▊                                           | 1504/2211 [00:00<00:00, 1837.05it/s][A[A

Validating rep learning:  76%|██████████████████████████████████████████████████████████████████████████████████████████████████████▊                                | 1683/2211 [00:00<00:00, 1819.97it/s][A[A

Validating rep learning:  84%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████▌                     | 1860/2211 [00:01<00:00, 1802.66it/s][A[A

Validating rep learning:  92%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▋          | 2042/2211 [00:01<00:00, 1804.96it/s][A[AValidating rep learning: 100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 2211/2211 [00:01<00:00, 1847.25it/s]
{'stance_avg_closed_ratio': 0.9816887038787203, 'stance_avg_far_ratio': 0.9802686108873917, 'other_avg_closed_ratio': 1.013708124355518, 'other_avg_far_ratio': 0.0}

Sampling news batches:  32%|████████████████████████████████████████████▎                                                                                             | 481/1496 [29:51<5:48:30, 20.60s/it][A
Sampling news batches:  32%|████████████████████████████████████████████▍                                                                                             | 482/1496 [29:53<4:11:21, 14.87s/it][A
Sampling news batches:  32%|████████████████████████████████████████████▌                                                                                             | 483/1496 [29:55<3:05:50, 11.01s/it][A
Sampling news batches:  32%|████████████████████████████████████████████▋                                                                                             | 484/1496 [29:57<2:20:00,  8.30s/it][A
Sampling news batches:  32%|████████████████████████████████████████████▋                                                                                             | 485/1496 [30:00<1:54:05,  6.77s/it][A
Sampling news batches:  32%|████████████████████████████████████████████▊                                                                                             | 486/1496 [30:01<1:26:31,  5.14s/it][A
Sampling news batches:  33%|████████████████████████████████████████████▉                                                                                             | 487/1496 [30:04<1:16:28,  4.55s/it][A
Sampling news batches:  33%|█████████████████████████████████████████████                                                                                             | 488/1496 [30:08<1:10:22,  4.19s/it][A
Sampling news batches:  33%|█████████████████████████████████████████████▊                                                                                              | 489/1496 [30:09<55:58,  3.34s/it][A
Sampling news batches:  33%|█████████████████████████████████████████████▊                                                                                              | 490/1496 [30:11<51:18,  3.06s/it][A
Sampling news batches:  33%|█████████████████████████████████████████████▉                                                                                              | 491/1496 [30:13<44:23,  2.65s/it][A
Sampling news batches:  33%|██████████████████████████████████████████████                                                                                              | 492/1496 [30:15<38:22,  2.29s/it][A
Sampling news batches:  33%|██████████████████████████████████████████████▏                                                                                             | 493/1496 [30:16<31:56,  1.91s/it][A
Sampling news batches:  33%|██████████████████████████████████████████████▏                                                                                             | 494/1496 [30:18<32:09,  1.93s/it][A
Sampling news batches:  33%|██████████████████████████████████████████████▎                                                                                             | 495/1496 [30:19<28:34,  1.71s/it][A
Sampling news batches:  33%|██████████████████████████████████████████████▍                                                                                             | 496/1496 [30:21<28:45,  1.73s/it][A
Sampling news batches:  33%|██████████████████████████████████████████████▌                                                                                             | 497/1496 [30:26<49:15,  2.96s/it][A
Sampling news batches:  33%|██████████████████████████████████████████████▌                                                                                             | 498/1496 [30:28<42:19,  2.54s/it][A
Sampling news batches:  33%|██████████████████████████████████████████████▋                                                                                             | 499/1496 [30:30<41:05,  2.47s/it][A
Sampling news batches:  33%|██████████████████████████████████████████████▊                                                                                             | 500/1496 [30:32<37:56,  2.29s/it][A
Sampling news batches:  33%|██████████████████████████████████████████████▉                                                                                             | 501/1496 [30:33<32:09,  1.94s/it][A
Sampling news batches:  34%|██████████████████████████████████████████████▉                                                                                             | 502/1496 [30:35<31:30,  1.90s/it][A
Sampling news batches:  34%|███████████████████████████████████████████████                                                                                             | 503/1496 [30:37<32:00,  1.93s/it][A
Sampling news batches:  34%|███████████████████████████████████████████████▏                                                                                            | 504/1496 [30:42<47:55,  2.90s/it][A
Sampling news batches:  34%|███████████████████████████████████████████████▎                                                                                            | 505/1496 [30:45<45:51,  2.78s/it][A
Sampling news batches:  34%|███████████████████████████████████████████████▎                                                                                            | 506/1496 [30:46<40:27,  2.45s/it][A
Sampling news batches:  34%|███████████████████████████████████████████████▍                                                                                            | 507/1496 [30:48<37:40,  2.29s/it][A
Sampling news batches:  34%|███████████████████████████████████████████████▌                                                                                            | 508/1496 [30:50<35:51,  2.18s/it][A
Sampling news batches:  34%|███████████████████████████████████████████████▋                                                                                            | 509/1496 [30:52<33:40,  2.05s/it][A
Sampling news batches:  34%|███████████████████████████████████████████████▋                                                                                            | 510/1496 [30:56<42:24,  2.58s/it][A
Sampling news batches:  34%|███████████████████████████████████████████████▊                                                                                            | 511/1496 [30:58<40:58,  2.50s/it][A
Sampling news batches:  34%|███████████████████████████████████████████████▉                                                                                            | 512/1496 [31:00<36:54,  2.25s/it][A
Sampling news batches:  34%|████████████████████████████████████████████████                                                                                            | 513/1496 [31:01<31:49,  1.94s/it][A
Sampling news batches:  34%|████████████████████████████████████████████████                                                                                            | 514/1496 [31:03<34:06,  2.08s/it][A
Sampling news batches:  34%|████████████████████████████████████████████████▏                                                                                           | 515/1496 [31:05<33:12,  2.03s/it][A
Sampling news batches:  34%|████████████████████████████████████████████████▎                                                                                           | 516/1496 [31:07<31:33,  1.93s/it][A
Sampling news batches:  35%|████████████████████████████████████████████████▍                                                                                           | 517/1496 [31:10<35:53,  2.20s/it][A
Sampling news batches:  35%|████████████████████████████████████████████████▍                                                                                           | 518/1496 [31:11<31:53,  1.96s/it][A
Sampling news batches:  35%|████████████████████████████████████████████████▌                                                                                           | 519/1496 [31:12<28:25,  1.75s/it][A
Sampling news batches:  35%|████████████████████████████████████████████████▋                                                                                           | 520/1496 [31:15<34:00,  2.09s/it][A{'grad': 4.98761260509491, 'context_loss': 7.675924801826477, 'stance_loss': 1.3560616846742302, 'news_loss': 0.568276584148407}


Validating rep learning:   0%|                                                                                                                                                    | 0/2211 [00:00<?, ?it/s][A[A

Validating rep learning:   8%|███████████                                                                                                                             | 180/2211 [00:00<00:01, 1794.39it/s][A[A

Validating rep learning:  18%|████████████████████████                                                                                                                | 391/2211 [00:00<00:00, 1877.23it/s][A[A

Validating rep learning:  26%|███████████████████████████████████▌                                                                                                    | 579/2211 [00:00<00:00, 1875.22it/s][A[A

Validating rep learning:  35%|███████████████████████████████████████████████▋                                                                                        | 775/2211 [00:00<00:00, 1898.55it/s][A[A

Validating rep learning:  44%|███████████████████████████████████████████████████████████▏                                                                            | 962/2211 [00:00<00:00, 1886.97it/s][A[A

Validating rep learning:  52%|█████████████████████████████████████████████████████████████████████▉                                                                 | 1146/2211 [00:00<00:00, 1871.24it/s][A[A

Validating rep learning:  60%|█████████████████████████████████████████████████████████████████████████████████                                                      | 1328/2211 [00:00<00:00, 1854.02it/s][A[A

Validating rep learning:  68%|████████████████████████████████████████████████████████████████████████████████████████████▏                                          | 1510/2211 [00:00<00:00, 1840.58it/s][A[A

Validating rep learning:  77%|███████████████████████████████████████████████████████████████████████████████████████████████████████▎                               | 1692/2211 [00:00<00:00, 1832.41it/s][A[A

Validating rep learning:  85%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████▍                    | 1874/2211 [00:01<00:00, 1827.78it/s][A[A

Validating rep learning:  93%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▌         | 2057/2211 [00:01<00:00, 1825.77it/s][A[AValidating rep learning: 100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 2211/2211 [00:01<00:00, 1859.82it/s]
{'stance_avg_closed_ratio': 0.9792026394140937, 'stance_avg_far_ratio': 0.9702029286024024, 'other_avg_closed_ratio': 1.00662022616141, 'other_avg_far_ratio': 0.0}

Sampling news batches:  35%|████████████████████████████████████████████████                                                                                          | 521/1496 [32:20<5:38:19, 20.82s/it][A
Sampling news batches:  35%|████████████████████████████████████████████████▏                                                                                         | 522/1496 [32:22<4:07:50, 15.27s/it][A
Sampling news batches:  35%|████████████████████████████████████████████████▏                                                                                         | 523/1496 [32:24<3:03:41, 11.33s/it][A
Sampling news batches:  35%|████████████████████████████████████████████████▎                                                                                         | 524/1496 [32:26<2:17:20,  8.48s/it][A
Sampling news batches:  35%|████████████████████████████████████████████████▍                                                                                         | 525/1496 [32:28<1:47:31,  6.64s/it][A
Sampling news batches:  35%|████████████████████████████████████████████████▌                                                                                         | 526/1496 [32:31<1:26:48,  5.37s/it][A
Sampling news batches:  35%|████████████████████████████████████████████████▌                                                                                         | 527/1496 [32:34<1:14:55,  4.64s/it][A
Sampling news batches:  35%|████████████████████████████████████████████████▋                                                                                         | 528/1496 [32:36<1:00:49,  3.77s/it][A
Sampling news batches:  35%|█████████████████████████████████████████████████▌                                                                                          | 529/1496 [32:38<54:15,  3.37s/it][A
Sampling news batches:  35%|█████████████████████████████████████████████████▌                                                                                          | 530/1496 [32:40<47:15,  2.93s/it][A
Sampling news batches:  35%|█████████████████████████████████████████████████▋                                                                                          | 531/1496 [32:42<41:52,  2.60s/it][A
Sampling news batches:  36%|█████████████████████████████████████████████████▊                                                                                          | 532/1496 [32:44<38:32,  2.40s/it][A
Sampling news batches:  36%|█████████████████████████████████████████████████▉                                                                                          | 533/1496 [32:47<41:01,  2.56s/it][A
Sampling news batches:  36%|█████████████████████████████████████████████████▉                                                                                          | 534/1496 [32:49<39:06,  2.44s/it][A
Sampling news batches:  36%|██████████████████████████████████████████████████                                                                                          | 535/1496 [32:51<36:01,  2.25s/it][A
Sampling news batches:  36%|██████████████████████████████████████████████████▏                                                                                         | 536/1496 [32:53<35:38,  2.23s/it][A
Sampling news batches:  36%|██████████████████████████████████████████████████▎                                                                                         | 537/1496 [32:53<28:12,  1.77s/it][A
Sampling news batches:  36%|██████████████████████████████████████████████████▎                                                                                         | 538/1496 [32:55<29:03,  1.82s/it][A
Sampling news batches:  36%|██████████████████████████████████████████████████▍                                                                                         | 539/1496 [32:57<26:41,  1.67s/it][A
Sampling news batches:  36%|██████████████████████████████████████████████████▌                                                                                         | 540/1496 [32:59<30:20,  1.90s/it][A
Sampling news batches:  36%|██████████████████████████████████████████████████▋                                                                                         | 541/1496 [33:00<26:00,  1.63s/it][A
Sampling news batches:  36%|██████████████████████████████████████████████████▋                                                                                         | 542/1496 [33:02<26:30,  1.67s/it][A
Sampling news batches:  36%|██████████████████████████████████████████████████▊                                                                                         | 543/1496 [33:06<36:27,  2.30s/it][A
Sampling news batches:  36%|██████████████████████████████████████████████████▉                                                                                         | 544/1496 [33:11<49:52,  3.14s/it][A
Sampling news batches:  36%|███████████████████████████████████████████████████                                                                                         | 545/1496 [33:12<41:05,  2.59s/it][A
Sampling news batches:  36%|███████████████████████████████████████████████████                                                                                         | 546/1496 [33:14<37:34,  2.37s/it][A
Sampling news batches:  37%|███████████████████████████████████████████████████▏                                                                                        | 547/1496 [33:16<36:18,  2.30s/it][A
Sampling news batches:  37%|███████████████████████████████████████████████████▎                                                                                        | 548/1496 [33:17<30:14,  1.91s/it][A
Sampling news batches:  37%|███████████████████████████████████████████████████▍                                                                                        | 549/1496 [33:20<34:34,  2.19s/it][A
Sampling news batches:  37%|███████████████████████████████████████████████████▍                                                                                        | 550/1496 [33:22<36:01,  2.29s/it][A
Sampling news batches:  37%|███████████████████████████████████████████████████▌                                                                                        | 551/1496 [33:24<33:51,  2.15s/it][A
Sampling news batches:  37%|███████████████████████████████████████████████████▋                                                                                        | 552/1496 [33:26<29:57,  1.90s/it][A
Sampling news batches:  37%|███████████████████████████████████████████████████▊                                                                                        | 553/1496 [33:28<33:02,  2.10s/it][A
Sampling news batches:  37%|███████████████████████████████████████████████████▊                                                                                        | 554/1496 [33:29<28:39,  1.83s/it][A
Sampling news batches:  37%|███████████████████████████████████████████████████▉                                                                                        | 555/1496 [33:31<27:10,  1.73s/it][A
Sampling news batches:  37%|████████████████████████████████████████████████████                                                                                        | 556/1496 [33:33<27:30,  1.76s/it][A
Sampling news batches:  37%|████████████████████████████████████████████████████▏                                                                                       | 557/1496 [33:35<31:08,  1.99s/it][A
Sampling news batches:  37%|████████████████████████████████████████████████████▏                                                                                       | 558/1496 [33:38<32:59,  2.11s/it][A
Sampling news batches:  37%|████████████████████████████████████████████████████▎                                                                                       | 559/1496 [33:39<31:56,  2.05s/it][A
Sampling news batches:  37%|████████████████████████████████████████████████████▍                                                                                       | 560/1496 [33:42<32:04,  2.06s/it][A{'grad': 5.578487157821655, 'context_loss': 7.681968784332275, 'stance_loss': 1.3551274044760342, 'news_loss': 0.825993150472641}


Validating rep learning:   0%|                                                                                                                                                    | 0/2211 [00:00<?, ?it/s][A[A

Validating rep learning:   8%|███████████▏                                                                                                                            | 181/2211 [00:00<00:01, 1804.06it/s][A[A

Validating rep learning:  18%|███████████████████████▉                                                                                                                | 390/2211 [00:00<00:00, 1880.44it/s][A[A

Validating rep learning:  26%|███████████████████████████████████▋                                                                                                    | 580/2211 [00:00<00:00, 1885.54it/s][A[A

Validating rep learning:  35%|███████████████████████████████████████████████▊                                                                                        | 777/2211 [00:00<00:00, 1907.35it/s][A[A

Validating rep learning:  44%|███████████████████████████████████████████████████████████▎                                                                            | 965/2211 [00:00<00:00, 1896.46it/s][A[A

Validating rep learning:  52%|██████████████████████████████████████████████████████████████████████▎                                                                | 1152/2211 [00:00<00:00, 1885.51it/s][A[A

Validating rep learning:  60%|█████████████████████████████████████████████████████████████████████████████████▍                                                     | 1334/2211 [00:00<00:00, 1863.75it/s][A[A

Validating rep learning:  69%|████████████████████████████████████████████████████████████████████████████████████████████▋                                          | 1517/2211 [00:00<00:00, 1852.89it/s][A[A

Validating rep learning:  77%|███████████████████████████████████████████████████████████████████████████████████████████████████████▊                               | 1700/2211 [00:00<00:00, 1844.65it/s][A[A

Validating rep learning:  85%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████▉                    | 1882/2211 [00:01<00:00, 1836.36it/s][A[A

Validating rep learning:  93%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████         | 2065/2211 [00:01<00:00, 1833.32it/s][A[AValidating rep learning: 100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 2211/2211 [00:01<00:00, 1869.09it/s]
{'stance_avg_closed_ratio': 0.9724549033192111, 'stance_avg_far_ratio': 0.9661661443071805, 'other_avg_closed_ratio': 0.959709187596223, 'other_avg_far_ratio': 0.0}

Sampling news batches:  38%|███████████████████████████████████████████████████▊                                                                                      | 561/1496 [34:47<5:29:59, 21.18s/it][A
Sampling news batches:  38%|███████████████████████████████████████████████████▊                                                                                      | 562/1496 [34:49<3:59:26, 15.38s/it][A
Sampling news batches:  38%|███████████████████████████████████████████████████▉                                                                                      | 563/1496 [34:51<2:56:29, 11.35s/it][A
Sampling news batches:  38%|████████████████████████████████████████████████████                                                                                      | 564/1496 [34:53<2:13:45,  8.61s/it][A
Sampling news batches:  38%|████████████████████████████████████████████████████                                                                                      | 565/1496 [34:55<1:41:31,  6.54s/it][A
Sampling news batches:  38%|████████████████████████████████████████████████████▏                                                                                     | 566/1496 [34:57<1:19:59,  5.16s/it][A
Sampling news batches:  38%|████████████████████████████████████████████████████▎                                                                                     | 567/1496 [35:00<1:07:33,  4.36s/it][A
Sampling news batches:  38%|█████████████████████████████████████████████████████▏                                                                                      | 568/1496 [35:00<51:21,  3.32s/it][A
Sampling news batches:  38%|█████████████████████████████████████████████████████▏                                                                                      | 569/1496 [35:03<45:50,  2.97s/it][A
Sampling news batches:  38%|█████████████████████████████████████████████████████▎                                                                                      | 570/1496 [35:05<41:27,  2.69s/it][A
Sampling news batches:  38%|█████████████████████████████████████████████████████▍                                                                                      | 571/1496 [35:06<36:19,  2.36s/it][A
Sampling news batches:  38%|█████████████████████████████████████████████████████▌                                                                                      | 572/1496 [35:08<33:03,  2.15s/it][A
Sampling news batches:  38%|█████████████████████████████████████████████████████▌                                                                                      | 573/1496 [35:09<30:41,  1.99s/it][A
Sampling news batches:  38%|█████████████████████████████████████████████████████▋                                                                                      | 574/1496 [35:10<25:52,  1.68s/it][A
Sampling news batches:  38%|█████████████████████████████████████████████████████▊                                                                                      | 575/1496 [35:11<21:20,  1.39s/it][A
Sampling news batches:  39%|█████████████████████████████████████████████████████▉                                                                                      | 576/1496 [35:13<21:39,  1.41s/it][A
Sampling news batches:  39%|█████████████████████████████████████████████████████▉                                                                                      | 577/1496 [35:14<23:16,  1.52s/it][A
Sampling news batches:  39%|██████████████████████████████████████████████████████                                                                                      | 578/1496 [35:16<23:39,  1.55s/it][A
Sampling news batches:  39%|██████████████████████████████████████████████████████▏                                                                                     | 579/1496 [35:18<26:37,  1.74s/it][A
Sampling news batches:  39%|██████████████████████████████████████████████████████▎                                                                                     | 580/1496 [35:21<30:26,  1.99s/it][A
Sampling news batches:  39%|██████████████████████████████████████████████████████▎                                                                                     | 581/1496 [35:22<29:08,  1.91s/it][A
Sampling news batches:  39%|██████████████████████████████████████████████████████▍                                                                                     | 582/1496 [35:25<32:05,  2.11s/it][A
Sampling news batches:  39%|██████████████████████████████████████████████████████▌                                                                                     | 583/1496 [35:26<27:11,  1.79s/it][A
Sampling news batches:  39%|██████████████████████████████████████████████████████▋                                                                                     | 584/1496 [35:28<29:03,  1.91s/it][A
Sampling news batches:  39%|██████████████████████████████████████████████████████▋                                                                                     | 585/1496 [35:30<28:51,  1.90s/it][A
Sampling news batches:  39%|██████████████████████████████████████████████████████▊                                                                                     | 586/1496 [35:32<28:30,  1.88s/it][A
Sampling news batches:  39%|██████████████████████████████████████████████████████▉                                                                                     | 587/1496 [35:34<29:09,  1.92s/it][A
Sampling news batches:  39%|███████████████████████████████████████████████████████                                                                                     | 588/1496 [35:35<25:42,  1.70s/it][A
Sampling news batches:  39%|███████████████████████████████████████████████████████                                                                                     | 589/1496 [35:37<25:28,  1.68s/it][A
Sampling news batches:  39%|███████████████████████████████████████████████████████▏                                                                                    | 590/1496 [35:38<24:28,  1.62s/it][A
Sampling news batches:  40%|███████████████████████████████████████████████████████▎                                                                                    | 591/1496 [35:41<27:59,  1.86s/it][A
Sampling news batches:  40%|███████████████████████████████████████████████████████▍                                                                                    | 592/1496 [35:42<24:30,  1.63s/it][A
Sampling news batches:  40%|███████████████████████████████████████████████████████▍                                                                                    | 593/1496 [35:44<24:59,  1.66s/it][A
Sampling news batches:  40%|███████████████████████████████████████████████████████▌                                                                                    | 594/1496 [35:45<23:28,  1.56s/it][A
Sampling news batches:  40%|███████████████████████████████████████████████████████▋                                                                                    | 595/1496 [35:47<24:01,  1.60s/it][A
Sampling news batches:  40%|███████████████████████████████████████████████████████▊                                                                                    | 596/1496 [35:47<20:50,  1.39s/it][A
Sampling news batches:  40%|███████████████████████████████████████████████████████▊                                                                                    | 597/1496 [35:49<20:31,  1.37s/it][A
Sampling news batches:  40%|███████████████████████████████████████████████████████▉                                                                                    | 598/1496 [35:51<22:04,  1.47s/it][A
Sampling news batches:  40%|████████████████████████████████████████████████████████                                                                                    | 599/1496 [35:52<23:33,  1.58s/it][A
Sampling news batches:  40%|████████████████████████████████████████████████████████▏                                                                                   | 600/1496 [35:54<23:32,  1.58s/it][A{'grad': 6.127577185630798, 'context_loss': 7.6429825067520145, 'stance_loss': nan, 'news_loss': 0.48561158776283264}


Validating rep learning:   0%|                                                                                                                                                    | 0/2211 [00:00<?, ?it/s][A[A

Validating rep learning:   8%|███████████▏                                                                                                                            | 182/2211 [00:00<00:01, 1815.76it/s][A[A

Validating rep learning:  18%|████████████████████████▎                                                                                                               | 395/2211 [00:00<00:00, 1897.61it/s][A[A

Validating rep learning:  26%|███████████████████████████████████▉                                                                                                    | 585/2211 [00:00<00:00, 1896.78it/s][A[A

Validating rep learning:  35%|████████████████████████████████████████████████                                                                                        | 782/2211 [00:00<00:00, 1916.42it/s][A[A

Validating rep learning:  44%|███████████████████████████████████████████████████████████▋                                                                            | 971/2211 [00:00<00:00, 1906.71it/s][A[A

Validating rep learning:  52%|██████████████████████████████████████████████████████████████████████▋                                                                | 1157/2211 [00:00<00:00, 1891.92it/s][A[A

Validating rep learning:  61%|█████████████████████████████████████████████████████████████████████████████████▉                                                     | 1341/2211 [00:00<00:00, 1873.90it/s][A[A

Validating rep learning:  69%|█████████████████████████████████████████████████████████████████████████████████████████████                                          | 1524/2211 [00:00<00:00, 1860.18it/s][A[A

Validating rep learning:  77%|████████████████████████████████████████████████████████████████████████████████████████████████████████▏                              | 1706/2211 [00:00<00:00, 1847.64it/s][A[A

Validating rep learning:  85%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████▍                   | 1890/2211 [00:01<00:00, 1844.34it/s][A[A

Validating rep learning:  94%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▋        | 2075/2211 [00:01<00:00, 1843.36it/s][A[AValidating rep learning: 100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 2211/2211 [00:01<00:00, 1876.46it/s]
{'stance_avg_closed_ratio': 0.9902070795665281, 'stance_avg_far_ratio': 0.9836083446711091, 'other_avg_closed_ratio': 0.9851126409995373, 'other_avg_far_ratio': 0.0}

Sampling news batches:  40%|███████████████████████████████████████████████████████▍                                                                                  | 601/1496 [36:58<5:05:25, 20.48s/it][A
Sampling news batches:  40%|███████████████████████████████████████████████████████▌                                                                                  | 602/1496 [37:00<3:39:42, 14.75s/it][A
Sampling news batches:  40%|███████████████████████████████████████████████████████▌                                                                                  | 603/1496 [37:01<2:40:13, 10.77s/it][A
Sampling news batches:  40%|███████████████████████████████████████████████████████▋                                                                                  | 604/1496 [37:03<1:57:27,  7.90s/it][A
Sampling news batches:  40%|███████████████████████████████████████████████████████▊                                                                                  | 605/1496 [37:05<1:33:35,  6.30s/it][A
Sampling news batches:  41%|███████████████████████████████████████████████████████▉                                                                                  | 606/1496 [37:07<1:13:03,  4.93s/it][A
Sampling news batches:  41%|███████████████████████████████████████████████████████▉                                                                                  | 607/1496 [37:09<1:01:27,  4.15s/it][A
Sampling news batches:  41%|████████████████████████████████████████████████████████▉                                                                                   | 608/1496 [37:11<51:42,  3.49s/it][A
Sampling news batches:  41%|████████████████████████████████████████████████████████▉                                                                                   | 609/1496 [37:13<44:02,  2.98s/it][A
Sampling news batches:  41%|█████████████████████████████████████████████████████████                                                                                   | 610/1496 [37:15<38:41,  2.62s/it][A
Sampling news batches:  41%|█████████████████████████████████████████████████████████▏                                                                                  | 611/1496 [37:17<36:10,  2.45s/it][A
Sampling news batches:  41%|█████████████████████████████████████████████████████████▎                                                                                  | 612/1496 [37:18<31:15,  2.12s/it][A
Sampling news batches:  41%|█████████████████████████████████████████████████████████▎                                                                                  | 613/1496 [37:21<36:21,  2.47s/it][A
Sampling news batches:  41%|█████████████████████████████████████████████████████████▍                                                                                  | 614/1496 [37:23<31:12,  2.12s/it][A
Sampling news batches:  41%|█████████████████████████████████████████████████████████▌                                                                                  | 615/1496 [37:24<28:40,  1.95s/it][A
Sampling news batches:  41%|█████████████████████████████████████████████████████████▋                                                                                  | 616/1496 [37:26<26:49,  1.83s/it][A
Sampling news batches:  41%|█████████████████████████████████████████████████████████▋                                                                                  | 617/1496 [37:27<25:51,  1.76s/it][A
Sampling news batches:  41%|█████████████████████████████████████████████████████████▊                                                                                  | 618/1496 [37:30<27:58,  1.91s/it][A
Sampling news batches:  41%|█████████████████████████████████████████████████████████▉                                                                                  | 619/1496 [37:31<27:23,  1.87s/it][A
Sampling news batches:  41%|██████████████████████████████████████████████████████████                                                                                  | 620/1496 [37:33<26:58,  1.85s/it][A
Sampling news batches:  42%|██████████████████████████████████████████████████████████                                                                                  | 621/1496 [37:35<27:13,  1.87s/it][A
Sampling news batches:  42%|██████████████████████████████████████████████████████████▏                                                                                 | 622/1496 [37:37<27:19,  1.88s/it][A
Sampling news batches:  42%|██████████████████████████████████████████████████████████▎                                                                                 | 623/1496 [37:38<23:08,  1.59s/it][A
Sampling news batches:  42%|██████████████████████████████████████████████████████████▍                                                                                 | 624/1496 [37:42<33:45,  2.32s/it][A
Sampling news batches:  42%|██████████████████████████████████████████████████████████▍                                                                                 | 625/1496 [37:44<31:18,  2.16s/it][A
Sampling news batches:  42%|██████████████████████████████████████████████████████████▌                                                                                 | 626/1496 [37:45<26:53,  1.85s/it][A
Sampling news batches:  42%|██████████████████████████████████████████████████████████▋                                                                                 | 627/1496 [37:48<31:23,  2.17s/it][A
Sampling news batches:  42%|██████████████████████████████████████████████████████████▊                                                                                 | 628/1496 [37:51<34:15,  2.37s/it][A
Sampling news batches:  42%|██████████████████████████████████████████████████████████▊                                                                                 | 629/1496 [37:53<32:40,  2.26s/it][A
Sampling news batches:  42%|██████████████████████████████████████████████████████████▉                                                                                 | 630/1496 [37:54<30:23,  2.11s/it][A
Sampling news batches:  42%|███████████████████████████████████████████████████████████                                                                                 | 631/1496 [37:56<29:16,  2.03s/it][A
Sampling news batches:  42%|███████████████████████████████████████████████████████████▏                                                                                | 632/1496 [38:01<42:39,  2.96s/it][A
Sampling news batches:  42%|███████████████████████████████████████████████████████████▏                                                                                | 633/1496 [38:04<40:44,  2.83s/it][A
Sampling news batches:  42%|███████████████████████████████████████████████████████████▎                                                                                | 634/1496 [38:06<38:57,  2.71s/it][A
Sampling news batches:  42%|███████████████████████████████████████████████████████████▍                                                                                | 635/1496 [38:08<35:52,  2.50s/it][A
Sampling news batches:  43%|███████████████████████████████████████████████████████████▌                                                                                | 636/1496 [38:09<29:15,  2.04s/it][A
Sampling news batches:  43%|███████████████████████████████████████████████████████████▌                                                                                | 637/1496 [38:11<27:44,  1.94s/it][A
Sampling news batches:  43%|███████████████████████████████████████████████████████████▋                                                                                | 638/1496 [38:13<27:31,  1.92s/it][A
Sampling news batches:  43%|███████████████████████████████████████████████████████████▊                                                                                | 639/1496 [38:16<33:09,  2.32s/it][A
Sampling news batches:  43%|███████████████████████████████████████████████████████████▉                                                                                | 640/1496 [38:18<29:33,  2.07s/it][A{'grad': 3.4584800601005554, 'context_loss': 7.745257377624512, 'stance_loss': 1.36153640285615, 'news_loss': 0.5716097056865692}


Validating rep learning:   0%|                                                                                                                                                    | 0/2211 [00:00<?, ?it/s][A[A

Validating rep learning:   8%|███████████▏                                                                                                                            | 181/2211 [00:00<00:01, 1809.84it/s][A[A

Validating rep learning:  17%|███████████████████████▋                                                                                                                | 385/2211 [00:00<00:00, 1872.92it/s][A[A

Validating rep learning:  26%|███████████████████████████████████▏                                                                                                    | 573/2211 [00:00<00:00, 1874.16it/s][A[A

Validating rep learning:  35%|███████████████████████████████████████████████▎                                                                                        | 769/2211 [00:00<00:00, 1897.89it/s][A[A

Validating rep learning:  43%|██████████████████████████████████████████████████████████▊                                                                             | 956/2211 [00:00<00:00, 1888.16it/s][A[A

Validating rep learning:  51%|█████████████████████████████████████████████████████████████████████▎                                                                 | 1136/2211 [00:00<00:00, 1860.40it/s][A[A

Validating rep learning:  59%|████████████████████████████████████████████████████████████████████████████████▏                                                      | 1314/2211 [00:00<00:00, 1833.93it/s][A[A

Validating rep learning:  68%|███████████████████████████████████████████████████████████████████████████████████████████▎                                           | 1495/2211 [00:00<00:00, 1826.30it/s][A[A

Validating rep learning:  76%|██████████████████████████████████████████████████████████████████████████████████████████████████████▍                                | 1677/2211 [00:00<00:00, 1822.17it/s][A[A

Validating rep learning:  84%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████▌                     | 1859/2211 [00:01<00:00, 1820.05it/s][A[A

Validating rep learning:  92%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▌          | 2040/2211 [00:01<00:00, 1815.05it/s][A[AValidating rep learning: 100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 2211/2211 [00:01<00:00, 1847.77it/s]
{'stance_avg_closed_ratio': 0.9606431223098338, 'stance_avg_far_ratio': 0.9655980694567515, 'other_avg_closed_ratio': 0.8533212118452005, 'other_avg_far_ratio': 0.0}

Sampling news batches:  43%|███████████████████████████████████████████████████████████▏                                                                              | 641/1496 [39:19<4:44:20, 19.95s/it][A
Sampling news batches:  43%|███████████████████████████████████████████████████████████▏                                                                              | 642/1496 [39:21<3:25:16, 14.42s/it][A
Sampling news batches:  43%|███████████████████████████████████████████████████████████▎                                                                              | 643/1496 [39:22<2:29:00, 10.48s/it][A
Sampling news batches:  43%|███████████████████████████████████████████████████████████▍                                                                              | 644/1496 [39:23<1:48:14,  7.62s/it][A
Sampling news batches:  43%|███████████████████████████████████████████████████████████▍                                                                              | 645/1496 [39:26<1:30:02,  6.35s/it][A
Sampling news batches:  43%|███████████████████████████████████████████████████████████▌                                                                              | 646/1496 [39:28<1:09:19,  4.89s/it][A
Sampling news batches:  43%|████████████████████████████████████████████████████████████▌                                                                               | 647/1496 [39:29<50:48,  3.59s/it][A
Sampling news batches:  43%|████████████████████████████████████████████████████████████▋                                                                               | 648/1496 [39:29<37:59,  2.69s/it][A
Sampling news batches:  43%|████████████████████████████████████████████████████████████▋                                                                               | 649/1496 [39:31<35:38,  2.52s/it][A
Sampling news batches:  43%|████████████████████████████████████████████████████████████▊                                                                               | 650/1496 [39:33<32:45,  2.32s/it][A
Sampling news batches:  44%|████████████████████████████████████████████████████████████▉                                                                               | 651/1496 [39:35<29:00,  2.06s/it][A
Sampling news batches:  44%|█████████████████████████████████████████████████████████████                                                                               | 652/1496 [39:40<43:18,  3.08s/it][A
Sampling news batches:  44%|█████████████████████████████████████████████████████████████                                                                               | 653/1496 [39:43<41:18,  2.94s/it][A
Sampling news batches:  44%|█████████████████████████████████████████████████████████████▏                                                                              | 654/1496 [39:45<37:21,  2.66s/it][A
Sampling news batches:  44%|█████████████████████████████████████████████████████████████▎                                                                              | 655/1496 [39:47<36:42,  2.62s/it][A
Sampling news batches:  44%|█████████████████████████████████████████████████████████████▍                                                                              | 656/1496 [39:49<34:29,  2.46s/it][A
Sampling news batches:  44%|█████████████████████████████████████████████████████████████▍                                                                              | 657/1496 [39:52<35:31,  2.54s/it][A
Sampling news batches:  44%|█████████████████████████████████████████████████████████████▌                                                                              | 658/1496 [39:54<33:22,  2.39s/it][A
Sampling news batches:  44%|█████████████████████████████████████████████████████████████▋                                                                              | 659/1496 [39:55<29:25,  2.11s/it][A
Sampling news batches:  44%|█████████████████████████████████████████████████████████████▊                                                                              | 660/1496 [39:58<30:36,  2.20s/it][A
Sampling news batches:  44%|█████████████████████████████████████████████████████████████▊                                                                              | 661/1496 [40:00<29:22,  2.11s/it][A
Sampling news batches:  44%|█████████████████████████████████████████████████████████████▉                                                                              | 662/1496 [40:02<28:47,  2.07s/it][A
Sampling news batches:  44%|██████████████████████████████████████████████████████████████                                                                              | 663/1496 [40:03<26:31,  1.91s/it][A
Sampling news batches:  44%|██████████████████████████████████████████████████████████████▏                                                                             | 664/1496 [40:06<31:47,  2.29s/it][A
Sampling news batches:  44%|██████████████████████████████████████████████████████████████▏                                                                             | 665/1496 [40:08<29:58,  2.16s/it][A
Sampling news batches:  45%|██████████████████████████████████████████████████████████████▎                                                                             | 666/1496 [40:11<30:16,  2.19s/it][A
Sampling news batches:  45%|██████████████████████████████████████████████████████████████▍                                                                             | 667/1496 [40:13<29:27,  2.13s/it][A
Sampling news batches:  45%|██████████████████████████████████████████████████████████████▌                                                                             | 668/1496 [40:15<29:04,  2.11s/it][A
Sampling news batches:  45%|██████████████████████████████████████████████████████████████▌                                                                             | 669/1496 [40:17<29:24,  2.13s/it][A
Sampling news batches:  45%|██████████████████████████████████████████████████████████████▋                                                                             | 670/1496 [40:18<26:34,  1.93s/it][A
Sampling news batches:  45%|██████████████████████████████████████████████████████████████▊                                                                             | 671/1496 [40:20<26:18,  1.91s/it][A
Sampling news batches:  45%|██████████████████████████████████████████████████████████████▉                                                                             | 672/1496 [40:22<23:58,  1.75s/it][A
Sampling news batches:  45%|██████████████████████████████████████████████████████████████▉                                                                             | 673/1496 [40:23<21:14,  1.55s/it][A
Sampling news batches:  45%|███████████████████████████████████████████████████████████████                                                                             | 674/1496 [40:25<24:11,  1.77s/it][A
Sampling news batches:  45%|███████████████████████████████████████████████████████████████▏                                                                            | 675/1496 [40:28<27:55,  2.04s/it][A
Sampling news batches:  45%|███████████████████████████████████████████████████████████████▎                                                                            | 676/1496 [40:29<25:33,  1.87s/it][A
Sampling news batches:  45%|███████████████████████████████████████████████████████████████▎                                                                            | 677/1496 [40:32<29:18,  2.15s/it][A
Sampling news batches:  45%|███████████████████████████████████████████████████████████████▍                                                                            | 678/1496 [40:33<25:32,  1.87s/it][A
Sampling news batches:  45%|███████████████████████████████████████████████████████████████▌                                                                            | 679/1496 [40:35<25:49,  1.90s/it][A
Sampling news batches:  45%|███████████████████████████████████████████████████████████████▋                                                                            | 680/1496 [40:36<23:40,  1.74s/it][A{'grad': 3.6904050707817078, 'context_loss': 7.70283659696579, 'stance_loss': nan, 'news_loss': 1.0852065682411194}


Validating rep learning:   0%|                                                                                                                                                    | 0/2211 [00:00<?, ?it/s][A[A

Validating rep learning:   8%|███████████▏                                                                                                                            | 182/2211 [00:00<00:01, 1819.01it/s][A[A

Validating rep learning:  18%|███████████████████████▉                                                                                                                | 390/2211 [00:00<00:00, 1887.21it/s][A[A

Validating rep learning:  26%|███████████████████████████████████▋                                                                                                    | 580/2211 [00:00<00:00, 1890.16it/s][A[A

Validating rep learning:  35%|███████████████████████████████████████████████▊                                                                                        | 778/2211 [00:00<00:00, 1913.81it/s][A[A

Validating rep learning:  44%|███████████████████████████████████████████████████████████▍                                                                            | 967/2211 [00:00<00:00, 1904.28it/s][A[A

Validating rep learning:  52%|██████████████████████████████████████████████████████████████████████▍                                                                | 1154/2211 [00:00<00:00, 1891.63it/s][A[A

Validating rep learning:  60%|█████████████████████████████████████████████████████████████████████████████████▋                                                     | 1337/2211 [00:00<00:00, 1872.46it/s][A[A

Validating rep learning:  69%|████████████████████████████████████████████████████████████████████████████████████████████▊                                          | 1520/2211 [00:00<00:00, 1858.47it/s][A[A

Validating rep learning:  77%|████████████████████████████████████████████████████████████████████████████████████████████████████████                               | 1704/2211 [00:00<00:00, 1851.68it/s][A[A

Validating rep learning:  85%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████▎                   | 1888/2211 [00:01<00:00, 1847.44it/s][A[A

Validating rep learning:  94%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▌        | 2072/2211 [00:01<00:00, 1842.38it/s][A[AValidating rep learning: 100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 2211/2211 [00:01<00:00, 1875.39it/s]
{'stance_avg_closed_ratio': 0.9844872344329811, 'stance_avg_far_ratio': 0.9958327936099843, 'other_avg_closed_ratio': 0.9409390831873976, 'other_avg_far_ratio': 0.0}

Sampling news batches:  46%|██████████████████████████████████████████████████████████████▊                                                                           | 681/1496 [41:41<4:38:11, 20.48s/it][A
Sampling news batches:  46%|██████████████████████████████████████████████████████████████▉                                                                           | 682/1496 [41:42<3:21:22, 14.84s/it][A
Sampling news batches:  46%|███████████████████████████████████████████████████████████████                                                                           | 683/1496 [41:44<2:26:42, 10.83s/it][A
Sampling news batches:  46%|███████████████████████████████████████████████████████████████                                                                           | 684/1496 [41:46<1:50:08,  8.14s/it][A
Sampling news batches:  46%|███████████████████████████████████████████████████████████████▏                                                                          | 685/1496 [41:47<1:21:06,  6.00s/it][A
Sampling news batches:  46%|███████████████████████████████████████████████████████████████▎                                                                          | 686/1496 [41:53<1:23:45,  6.20s/it][A
Sampling news batches:  46%|███████████████████████████████████████████████████████████████▎                                                                          | 687/1496 [41:55<1:05:46,  4.88s/it][A
Sampling news batches:  46%|████████████████████████████████████████████████████████████████▍                                                                           | 688/1496 [41:57<53:33,  3.98s/it][A
Sampling news batches:  46%|████████████████████████████████████████████████████████████████▍                                                                           | 689/1496 [41:59<44:43,  3.32s/it][A
Sampling news batches:  46%|████████████████████████████████████████████████████████████████▌                                                                           | 690/1496 [42:00<37:30,  2.79s/it][A
Sampling news batches:  46%|████████████████████████████████████████████████████████████████▋                                                                           | 691/1496 [42:02<33:12,  2.47s/it][A
Sampling news batches:  46%|████████████████████████████████████████████████████████████████▊                                                                           | 692/1496 [42:03<28:52,  2.15s/it][A
Sampling news batches:  46%|████████████████████████████████████████████████████████████████▊                                                                           | 693/1496 [42:06<30:12,  2.26s/it][A
Sampling news batches:  46%|████████████████████████████████████████████████████████████████▉                                                                           | 694/1496 [42:08<28:19,  2.12s/it][A
Sampling news batches:  46%|█████████████████████████████████████████████████████████████████                                                                           | 695/1496 [42:10<29:26,  2.21s/it][A
Sampling news batches:  47%|█████████████████████████████████████████████████████████████████▏                                                                          | 696/1496 [42:12<28:26,  2.13s/it][A
Sampling news batches:  47%|█████████████████████████████████████████████████████████████████▏                                                                          | 697/1496 [42:13<24:59,  1.88s/it][A
Sampling news batches:  47%|█████████████████████████████████████████████████████████████████▎                                                                          | 698/1496 [42:15<25:07,  1.89s/it][A
Sampling news batches:  47%|█████████████████████████████████████████████████████████████████▍                                                                          | 699/1496 [42:16<21:51,  1.65s/it][A
Sampling news batches:  47%|█████████████████████████████████████████████████████████████████▌                                                                          | 700/1496 [42:19<24:00,  1.81s/it][A
Sampling news batches:  47%|█████████████████████████████████████████████████████████████████▌                                                                          | 701/1496 [42:21<26:33,  2.00s/it][A
Sampling news batches:  47%|█████████████████████████████████████████████████████████████████▋                                                                          | 702/1496 [42:27<43:36,  3.30s/it][A
Sampling news batches:  47%|█████████████████████████████████████████████████████████████████▊                                                                          | 703/1496 [42:29<37:21,  2.83s/it][A
Sampling news batches:  47%|█████████████████████████████████████████████████████████████████▉                                                                          | 704/1496 [42:31<35:08,  2.66s/it][A
Sampling news batches:  47%|█████████████████████████████████████████████████████████████████▉                                                                          | 705/1496 [42:33<30:35,  2.32s/it][A
Sampling news batches:  47%|██████████████████████████████████████████████████████████████████                                                                          | 706/1496 [42:35<28:45,  2.18s/it][A
Sampling news batches:  47%|██████████████████████████████████████████████████████████████████▏                                                                         | 707/1496 [42:38<33:34,  2.55s/it][A
Sampling news batches:  47%|██████████████████████████████████████████████████████████████████▎                                                                         | 708/1496 [42:40<31:06,  2.37s/it][A
Sampling news batches:  47%|██████████████████████████████████████████████████████████████████▎                                                                         | 709/1496 [42:42<30:05,  2.29s/it][A
Sampling news batches:  47%|██████████████████████████████████████████████████████████████████▍                                                                         | 710/1496 [42:45<31:22,  2.39s/it][A
Sampling news batches:  48%|██████████████████████████████████████████████████████████████████▌                                                                         | 711/1496 [42:47<30:18,  2.32s/it][A
Sampling news batches:  48%|██████████████████████████████████████████████████████████████████▋                                                                         | 712/1496 [42:50<34:03,  2.61s/it][A
Sampling news batches:  48%|██████████████████████████████████████████████████████████████████▋                                                                         | 713/1496 [42:54<37:05,  2.84s/it][A
Sampling news batches:  48%|██████████████████████████████████████████████████████████████████▊                                                                         | 714/1496 [42:56<36:20,  2.79s/it][A
Sampling news batches:  48%|██████████████████████████████████████████████████████████████████▉                                                                         | 715/1496 [42:59<34:50,  2.68s/it][A
Sampling news batches:  48%|███████████████████████████████████████████████████████████████████                                                                         | 716/1496 [43:00<30:04,  2.31s/it][A
Sampling news batches:  48%|███████████████████████████████████████████████████████████████████                                                                         | 717/1496 [43:01<25:11,  1.94s/it][A
Sampling news batches:  48%|███████████████████████████████████████████████████████████████████▏                                                                        | 718/1496 [43:03<24:08,  1.86s/it][A
Sampling news batches:  48%|███████████████████████████████████████████████████████████████████▎                                                                        | 719/1496 [43:05<22:59,  1.78s/it][A
Sampling news batches:  48%|███████████████████████████████████████████████████████████████████▍                                                                        | 720/1496 [43:06<23:20,  1.80s/it][A{'grad': 5.555268049240112, 'context_loss': 7.721163022518158, 'stance_loss': 1.3262441525092492, 'news_loss': 0.66515611410141}


Validating rep learning:   0%|                                                                                                                                                    | 0/2211 [00:00<?, ?it/s][A[A

Validating rep learning:   8%|██████████▊                                                                                                                             | 176/2211 [00:00<00:01, 1757.04it/s][A[A

Validating rep learning:  17%|███████████████████████▋                                                                                                                | 385/2211 [00:00<00:00, 1844.38it/s][A[A

Validating rep learning:  26%|███████████████████████████████████▏                                                                                                    | 573/2211 [00:00<00:00, 1853.68it/s][A[A

Validating rep learning:  35%|███████████████████████████████████████████████▎                                                                                        | 769/2211 [00:00<00:00, 1883.54it/s][A[A

Validating rep learning:  43%|██████████████████████████████████████████████████████████▋                                                                             | 955/2211 [00:00<00:00, 1874.88it/s][A[A

Validating rep learning:  52%|█████████████████████████████████████████████████████████████████████▋                                                                 | 1141/2211 [00:00<00:00, 1869.33it/s][A[A

Validating rep learning:  60%|████████████████████████████████████████████████████████████████████████████████▊                                                      | 1323/2211 [00:00<00:00, 1851.75it/s][A[A

Validating rep learning:  68%|███████████████████████████████████████████████████████████████████████████████████████████▊                                           | 1504/2211 [00:00<00:00, 1837.77it/s][A[A

Validating rep learning:  76%|██████████████████████████████████████████████████████████████████████████████████████████████████████▉                                | 1686/2211 [00:00<00:00, 1829.65it/s][A[A

Validating rep learning:  84%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████                     | 1868/2211 [00:01<00:00, 1825.25it/s][A[A

Validating rep learning:  93%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▏         | 2050/2211 [00:01<00:00, 1821.30it/s][A[AValidating rep learning: 100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 2211/2211 [00:01<00:00, 1855.44it/s]
{'stance_avg_closed_ratio': 0.976668102087682, 'stance_avg_far_ratio': 0.9671230966425235, 'other_avg_closed_ratio': 0.9715062002249333, 'other_avg_far_ratio': 0.0}

Sampling news batches:  48%|██████████████████████████████████████████████████████████████████▌                                                                       | 721/1496 [44:12<4:28:44, 20.81s/it][A
Sampling news batches:  48%|██████████████████████████████████████████████████████████████████▌                                                                       | 722/1496 [44:14<3:17:13, 15.29s/it][A
Sampling news batches:  48%|██████████████████████████████████████████████████████████████████▋                                                                       | 723/1496 [44:17<2:27:42, 11.46s/it][A
Sampling news batches:  48%|██████████████████████████████████████████████████████████████████▊                                                                       | 724/1496 [44:18<1:48:39,  8.45s/it][A
Sampling news batches:  48%|██████████████████████████████████████████████████████████████████▉                                                                       | 725/1496 [44:20<1:22:20,  6.41s/it][A
Sampling news batches:  49%|██████████████████████████████████████████████████████████████████▉                                                                       | 726/1496 [44:25<1:19:41,  6.21s/it][A
Sampling news batches:  49%|███████████████████████████████████████████████████████████████████                                                                       | 727/1496 [44:27<1:02:46,  4.90s/it][A
Sampling news batches:  49%|████████████████████████████████████████████████████████████████████▏                                                                       | 728/1496 [44:28<48:43,  3.81s/it][A
Sampling news batches:  49%|████████████████████████████████████████████████████████████████████▏                                                                       | 729/1496 [44:29<37:50,  2.96s/it][A
Sampling news batches:  49%|████████████████████████████████████████████████████████████████████▎                                                                       | 730/1496 [44:31<31:45,  2.49s/it][A
Sampling news batches:  49%|████████████████████████████████████████████████████████████████████▍                                                                       | 731/1496 [44:32<28:11,  2.21s/it][A
Sampling news batches:  49%|████████████████████████████████████████████████████████████████████▌                                                                       | 732/1496 [44:35<28:18,  2.22s/it][A
Sampling news batches:  49%|████████████████████████████████████████████████████████████████████▌                                                                       | 733/1496 [44:37<27:58,  2.20s/it][A
Sampling news batches:  49%|████████████████████████████████████████████████████████████████████▋                                                                       | 734/1496 [44:39<26:24,  2.08s/it][A
Sampling news batches:  49%|████████████████████████████████████████████████████████████████████▊                                                                       | 735/1496 [44:40<22:22,  1.76s/it][A
Sampling news batches:  49%|████████████████████████████████████████████████████████████████████▉                                                                       | 736/1496 [44:41<22:23,  1.77s/it][A
Sampling news batches:  49%|████████████████████████████████████████████████████████████████████▉                                                                       | 737/1496 [44:43<21:34,  1.71s/it][A
Sampling news batches:  49%|█████████████████████████████████████████████████████████████████████                                                                       | 738/1496 [44:44<20:47,  1.65s/it][A
Sampling news batches:  49%|█████████████████████████████████████████████████████████████████████▏                                                                      | 739/1496 [44:47<24:02,  1.90s/it][A
Sampling news batches:  49%|█████████████████████████████████████████████████████████████████████▎                                                                      | 740/1496 [44:48<21:55,  1.74s/it][A
Sampling news batches:  50%|█████████████████████████████████████████████████████████████████████▎                                                                      | 741/1496 [44:51<26:15,  2.09s/it][A
Sampling news batches:  50%|█████████████████████████████████████████████████████████████████████▍                                                                      | 742/1496 [44:53<24:51,  1.98s/it][A
Sampling news batches:  50%|█████████████████████████████████████████████████████████████████████▌                                                                      | 743/1496 [44:56<29:00,  2.31s/it][A
Sampling news batches:  50%|█████████████████████████████████████████████████████████████████████▋                                                                      | 744/1496 [44:58<28:02,  2.24s/it][A
Sampling news batches:  50%|█████████████████████████████████████████████████████████████████████▋                                                                      | 745/1496 [44:59<22:48,  1.82s/it][A
Sampling news batches:  50%|█████████████████████████████████████████████████████████████████████▊                                                                      | 746/1496 [45:00<20:02,  1.60s/it][A
Sampling news batches:  50%|█████████████████████████████████████████████████████████████████████▉                                                                      | 747/1496 [45:02<20:48,  1.67s/it][A
Sampling news batches:  50%|██████████████████████████████████████████████████████████████████████                                                                      | 748/1496 [45:03<20:31,  1.65s/it][A
Sampling news batches:  50%|██████████████████████████████████████████████████████████████████████                                                                      | 749/1496 [45:06<22:10,  1.78s/it][A
Sampling news batches:  50%|██████████████████████████████████████████████████████████████████████▏                                                                     | 750/1496 [45:06<18:32,  1.49s/it][A
Sampling news batches:  50%|██████████████████████████████████████████████████████████████████████▎                                                                     | 751/1496 [45:08<20:43,  1.67s/it][A
Sampling news batches:  50%|██████████████████████████████████████████████████████████████████████▎                                                                     | 752/1496 [45:11<23:06,  1.86s/it][A
Sampling news batches:  50%|██████████████████████████████████████████████████████████████████████▍                                                                     | 753/1496 [45:12<21:59,  1.78s/it][A
Sampling news batches:  50%|██████████████████████████████████████████████████████████████████████▌                                                                     | 754/1496 [45:15<25:13,  2.04s/it][A
Sampling news batches:  50%|██████████████████████████████████████████████████████████████████████▋                                                                     | 755/1496 [45:17<25:23,  2.06s/it][A
Sampling news batches:  51%|██████████████████████████████████████████████████████████████████████▋                                                                     | 756/1496 [45:22<37:50,  3.07s/it][A
Sampling news batches:  51%|██████████████████████████████████████████████████████████████████████▊                                                                     | 757/1496 [45:26<40:23,  3.28s/it][A
Sampling news batches:  51%|██████████████████████████████████████████████████████████████████████▉                                                                     | 758/1496 [45:28<34:58,  2.84s/it][A
Sampling news batches:  51%|███████████████████████████████████████████████████████████████████████                                                                     | 759/1496 [45:30<31:10,  2.54s/it][A
Sampling news batches:  51%|███████████████████████████████████████████████████████████████████████                                                                     | 760/1496 [45:33<32:31,  2.65s/it][A{'grad': 6.099563717842102, 'context_loss': 7.769013035297394, 'stance_loss': 1.3357222984577048, 'news_loss': 0.6824324727058411}


Validating rep learning:   0%|                                                                                                                                                    | 0/2211 [00:00<?, ?it/s][A[A

Validating rep learning:   8%|██████████▉                                                                                                                             | 178/2211 [00:00<00:01, 1776.94it/s][A[A

Validating rep learning:  18%|███████████████████████▉                                                                                                                | 389/2211 [00:00<00:00, 1863.98it/s][A[A

Validating rep learning:  26%|███████████████████████████████████▍                                                                                                    | 576/2211 [00:00<00:00, 1864.31it/s][A[A

Validating rep learning:  35%|███████████████████████████████████████████████▌                                                                                        | 773/2211 [00:00<00:00, 1893.28it/s][A[A

Validating rep learning:  43%|██████████████████████████████████████████████████████████▉                                                                             | 959/2211 [00:00<00:00, 1883.14it/s][A[A

Validating rep learning:  52%|█████████████████████████████████████████████████████████████████████▉                                                                 | 1145/2211 [00:00<00:00, 1874.99it/s][A[A

Validating rep learning:  60%|████████████████████████████████████████████████████████████████████████████████▉                                                      | 1326/2211 [00:00<00:00, 1851.99it/s][A[A

Validating rep learning:  68%|████████████████████████████████████████████████████████████████████████████████████████████                                           | 1507/2211 [00:00<00:00, 1838.10it/s][A[A

Validating rep learning:  76%|███████████████████████████████████████████████████████████████████████████████████████████████████████                                | 1688/2211 [00:00<00:00, 1829.22it/s][A[A

Validating rep learning:  85%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████▏                    | 1870/2211 [00:01<00:00, 1825.89it/s][A[A

Validating rep learning:  93%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████          | 2049/2211 [00:01<00:00, 1814.67it/s][A[AValidating rep learning: 100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 2211/2211 [00:01<00:00, 1852.65it/s]
{'stance_avg_closed_ratio': 0.9741432500305399, 'stance_avg_far_ratio': 0.9693938809981244, 'other_avg_closed_ratio': 0.9550093918925657, 'other_avg_far_ratio': 0.0}

Sampling news batches:  51%|██████████████████████████████████████████████████████████████████████▏                                                                   | 761/1496 [46:34<4:06:05, 20.09s/it][A
Sampling news batches:  51%|██████████████████████████████████████████████████████████████████████▎                                                                   | 762/1496 [46:35<2:57:09, 14.48s/it][A
Sampling news batches:  51%|██████████████████████████████████████████████████████████████████████▍                                                                   | 763/1496 [46:37<2:12:06, 10.81s/it][A
Sampling news batches:  51%|██████████████████████████████████████████████████████████████████████▍                                                                   | 764/1496 [46:39<1:38:23,  8.07s/it][A
Sampling news batches:  51%|██████████████████████████████████████████████████████████████████████▌                                                                   | 765/1496 [46:41<1:18:07,  6.41s/it][A
Sampling news batches:  51%|███████████████████████████████████████████████████████████████████████▋                                                                    | 766/1496 [46:43<58:54,  4.84s/it][A
Sampling news batches:  51%|███████████████████████████████████████████████████████████████████████▊                                                                    | 767/1496 [46:46<53:04,  4.37s/it][A
Sampling news batches:  51%|███████████████████████████████████████████████████████████████████████▊                                                                    | 768/1496 [46:48<43:38,  3.60s/it][A
Sampling news batches:  51%|███████████████████████████████████████████████████████████████████████▉                                                                    | 769/1496 [46:49<35:03,  2.89s/it][A
Sampling news batches:  51%|████████████████████████████████████████████████████████████████████████                                                                    | 770/1496 [46:50<28:03,  2.32s/it][A
Sampling news batches:  52%|████████████████████████████████████████████████████████████████████████▏                                                                   | 771/1496 [46:56<40:18,  3.34s/it][A
Sampling news batches:  52%|████████████████████████████████████████████████████████████████████████▏                                                                   | 772/1496 [46:57<34:39,  2.87s/it][A
Sampling news batches:  52%|████████████████████████████████████████████████████████████████████████▎                                                                   | 773/1496 [47:01<36:49,  3.06s/it][A
Sampling news batches:  52%|████████████████████████████████████████████████████████████████████████▍                                                                   | 774/1496 [47:03<33:25,  2.78s/it][A
Sampling news batches:  52%|████████████████████████████████████████████████████████████████████████▌                                                                   | 775/1496 [47:07<36:16,  3.02s/it][A
Sampling news batches:  52%|████████████████████████████████████████████████████████████████████████▌                                                                   | 776/1496 [47:08<30:10,  2.51s/it][A
Sampling news batches:  52%|████████████████████████████████████████████████████████████████████████▋                                                                   | 777/1496 [47:10<26:58,  2.25s/it][A
Sampling news batches:  52%|████████████████████████████████████████████████████████████████████████▊                                                                   | 778/1496 [47:11<23:00,  1.92s/it][A
Sampling news batches:  52%|████████████████████████████████████████████████████████████████████████▉                                                                   | 779/1496 [47:14<27:11,  2.27s/it][A
Sampling news batches:  52%|████████████████████████████████████████████████████████████████████████▉                                                                   | 780/1496 [47:16<26:09,  2.19s/it][A
Sampling news batches:  52%|█████████████████████████████████████████████████████████████████████████                                                                   | 781/1496 [47:17<22:34,  1.89s/it][A
Sampling news batches:  52%|█████████████████████████████████████████████████████████████████████████▏                                                                  | 782/1496 [47:19<22:03,  1.85s/it][A
Sampling news batches:  52%|█████████████████████████████████████████████████████████████████████████▎                                                                  | 783/1496 [47:21<24:32,  2.07s/it][A
Sampling news batches:  52%|█████████████████████████████████████████████████████████████████████████▎                                                                  | 784/1496 [47:22<19:46,  1.67s/it][A
Sampling news batches:  52%|█████████████████████████████████████████████████████████████████████████▍                                                                  | 785/1496 [47:25<22:25,  1.89s/it][A
Sampling news batches:  53%|█████████████████████████████████████████████████████████████████████████▌                                                                  | 786/1496 [47:26<20:45,  1.75s/it][A
Sampling news batches:  53%|█████████████████████████████████████████████████████████████████████████▋                                                                  | 787/1496 [47:29<26:41,  2.26s/it][A
Sampling news batches:  53%|█████████████████████████████████████████████████████████████████████████▋                                                                  | 788/1496 [47:30<21:38,  1.83s/it][A
Sampling news batches:  53%|█████████████████████████████████████████████████████████████████████████▊                                                                  | 789/1496 [47:32<20:34,  1.75s/it][A
Sampling news batches:  53%|█████████████████████████████████████████████████████████████████████████▉                                                                  | 790/1496 [47:35<24:20,  2.07s/it][A
Sampling news batches:  53%|██████████████████████████████████████████████████████████████████████████                                                                  | 791/1496 [47:36<21:32,  1.83s/it][A
Sampling news batches:  53%|██████████████████████████████████████████████████████████████████████████                                                                  | 792/1496 [47:39<24:29,  2.09s/it][A
Sampling news batches:  53%|██████████████████████████████████████████████████████████████████████████▏                                                                 | 793/1496 [47:40<20:31,  1.75s/it][A
Sampling news batches:  53%|██████████████████████████████████████████████████████████████████████████▎                                                                 | 794/1496 [47:42<21:52,  1.87s/it][A
Sampling news batches:  53%|██████████████████████████████████████████████████████████████████████████▍                                                                 | 795/1496 [47:43<21:30,  1.84s/it][A
Sampling news batches:  53%|██████████████████████████████████████████████████████████████████████████▍                                                                 | 796/1496 [47:46<24:07,  2.07s/it][A
Sampling news batches:  53%|██████████████████████████████████████████████████████████████████████████▌                                                                 | 797/1496 [47:48<22:00,  1.89s/it][A
Sampling news batches:  53%|██████████████████████████████████████████████████████████████████████████▋                                                                 | 798/1496 [47:49<21:07,  1.82s/it][A
Sampling news batches:  53%|██████████████████████████████████████████████████████████████████████████▊                                                                 | 799/1496 [47:51<22:54,  1.97s/it][A
Sampling news batches:  53%|██████████████████████████████████████████████████████████████████████████▊                                                                 | 800/1496 [47:53<22:48,  1.97s/it][A{'grad': 4.538019418716431, 'context_loss': 7.70804363489151, 'stance_loss': 1.3205205840723855, 'news_loss': 0.7567887817110334}


Validating rep learning:   0%|                                                                                                                                                    | 0/2211 [00:00<?, ?it/s][A[A

Validating rep learning:   8%|███████████                                                                                                                             | 180/2211 [00:00<00:01, 1792.18it/s][A[A

Validating rep learning:  18%|███████████████████████▉                                                                                                                | 389/2211 [00:00<00:00, 1871.75it/s][A[A

Validating rep learning:  26%|███████████████████████████████████▎                                                                                                    | 575/2211 [00:00<00:00, 1866.50it/s][A[A

Validating rep learning:  35%|███████████████████████████████████████████████▍                                                                                        | 772/2211 [00:00<00:00, 1894.71it/s][A[A

Validating rep learning:  43%|██████████████████████████████████████████████████████████▊                                                                             | 957/2211 [00:00<00:00, 1880.04it/s][A[A

Validating rep learning:  52%|█████████████████████████████████████████████████████████████████████▊                                                                 | 1143/2211 [00:00<00:00, 1873.10it/s][A[A

Validating rep learning:  60%|████████████████████████████████████████████████████████████████████████████████▉                                                      | 1325/2211 [00:00<00:00, 1855.56it/s][A[A

Validating rep learning:  68%|████████████████████████████████████████████████████████████████████████████████████████████                                           | 1507/2211 [00:00<00:00, 1844.12it/s][A[A

Validating rep learning:  76%|███████████████████████████████████████████████████████████████████████████████████████████████████████▏                               | 1689/2211 [00:00<00:00, 1835.93it/s][A[A

Validating rep learning:  85%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████▎                    | 1872/2211 [00:01<00:00, 1832.16it/s][A[A

Validating rep learning:  93%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▎         | 2053/2211 [00:01<00:00, 1824.85it/s][A[AValidating rep learning: 100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 2211/2211 [00:01<00:00, 1858.56it/s]
{'stance_avg_closed_ratio': 0.9662256267171577, 'stance_avg_far_ratio': 0.9957399943157567, 'other_avg_closed_ratio': 0.9375080218288803, 'other_avg_far_ratio': 0.0}

Sampling news batches:  54%|█████████████████████████████████████████████████████████████████████████▉                                                                | 801/1496 [48:57<3:58:06, 20.56s/it][A
Sampling news batches:  54%|█████████████████████████████████████████████████████████████████████████▉                                                                | 802/1496 [48:58<2:49:08, 14.62s/it][A
Sampling news batches:  54%|██████████████████████████████████████████████████████████████████████████                                                                | 803/1496 [49:00<2:03:27, 10.69s/it][A
Sampling news batches:  54%|██████████████████████████████████████████████████████████████████████████▏                                                               | 804/1496 [49:03<1:37:30,  8.46s/it][A
Sampling news batches:  54%|██████████████████████████████████████████████████████████████████████████▎                                                               | 805/1496 [49:05<1:15:02,  6.52s/it][A
Sampling news batches:  54%|███████████████████████████████████████████████████████████████████████████▍                                                                | 806/1496 [49:06<55:24,  4.82s/it][A
Sampling news batches:  54%|███████████████████████████████████████████████████████████████████████████▌                                                                | 807/1496 [49:07<44:44,  3.90s/it][A
Sampling news batches:  54%|███████████████████████████████████████████████████████████████████████████▌                                                                | 808/1496 [49:10<41:06,  3.58s/it][A
Sampling news batches:  54%|███████████████████████████████████████████████████████████████████████████▋                                                                | 809/1496 [49:12<35:55,  3.14s/it][A
Sampling news batches:  54%|███████████████████████████████████████████████████████████████████████████▊                                                                | 810/1496 [49:13<28:18,  2.48s/it][A
Sampling news batches:  54%|███████████████████████████████████████████████████████████████████████████▉                                                                | 811/1496 [49:15<25:56,  2.27s/it][A
Sampling news batches:  54%|███████████████████████████████████████████████████████████████████████████▉                                                                | 812/1496 [49:17<23:35,  2.07s/it][A
Sampling news batches:  54%|████████████████████████████████████████████████████████████████████████████                                                                | 813/1496 [49:19<22:41,  1.99s/it][A
Sampling news batches:  54%|████████████████████████████████████████████████████████████████████████████▏                                                               | 814/1496 [49:20<22:12,  1.95s/it][A
Sampling news batches:  54%|████████████████████████████████████████████████████████████████████████████▎                                                               | 815/1496 [49:22<21:06,  1.86s/it][A
Sampling news batches:  55%|████████████████████████████████████████████████████████████████████████████▎                                                               | 816/1496 [49:23<17:34,  1.55s/it][A
Sampling news batches:  55%|████████████████████████████████████████████████████████████████████████████▍                                                               | 817/1496 [49:24<16:58,  1.50s/it][A
Sampling news batches:  55%|████████████████████████████████████████████████████████████████████████████▌                                                               | 818/1496 [49:27<22:16,  1.97s/it][A
Sampling news batches:  55%|████████████████████████████████████████████████████████████████████████████▋                                                               | 819/1496 [49:29<20:58,  1.86s/it][A
Sampling news batches:  55%|████████████████████████████████████████████████████████████████████████████▋                                                               | 820/1496 [49:31<20:36,  1.83s/it][A
Sampling news batches:  55%|████████████████████████████████████████████████████████████████████████████▊                                                               | 821/1496 [49:31<16:15,  1.45s/it][A
Sampling news batches:  55%|████████████████████████████████████████████████████████████████████████████▉                                                               | 822/1496 [49:34<19:48,  1.76s/it][A
Sampling news batches:  55%|█████████████████████████████████████████████████████████████████████████████                                                               | 823/1496 [49:40<33:29,  2.99s/it][A
Sampling news batches:  55%|█████████████████████████████████████████████████████████████████████████████                                                               | 824/1496 [49:41<28:00,  2.50s/it][A
Sampling news batches:  55%|█████████████████████████████████████████████████████████████████████████████▏                                                              | 825/1496 [49:43<26:23,  2.36s/it][A
Sampling news batches:  55%|█████████████████████████████████████████████████████████████████████████████▎                                                              | 826/1496 [49:45<23:44,  2.13s/it][A
Sampling news batches:  55%|█████████████████████████████████████████████████████████████████████████████▍                                                              | 827/1496 [49:45<18:30,  1.66s/it][A
Sampling news batches:  55%|█████████████████████████████████████████████████████████████████████████████▍                                                              | 828/1496 [49:46<16:57,  1.52s/it][A
Sampling news batches:  55%|█████████████████████████████████████████████████████████████████████████████▌                                                              | 829/1496 [49:48<16:14,  1.46s/it][A
Sampling news batches:  55%|█████████████████████████████████████████████████████████████████████████████▋                                                              | 830/1496 [49:50<18:02,  1.63s/it][A
Sampling news batches:  56%|█████████████████████████████████████████████████████████████████████████████▊                                                              | 831/1496 [49:52<21:03,  1.90s/it][A
Sampling news batches:  56%|█████████████████████████████████████████████████████████████████████████████▊                                                              | 832/1496 [49:54<20:09,  1.82s/it][A
Sampling news batches:  56%|█████████████████████████████████████████████████████████████████████████████▉                                                              | 833/1496 [49:57<24:37,  2.23s/it][A
Sampling news batches:  56%|██████████████████████████████████████████████████████████████████████████████                                                              | 834/1496 [49:59<24:44,  2.24s/it][A
Sampling news batches:  56%|██████████████████████████████████████████████████████████████████████████████▏                                                             | 835/1496 [50:03<30:10,  2.74s/it][A
Sampling news batches:  56%|██████████████████████████████████████████████████████████████████████████████▏                                                             | 836/1496 [50:05<25:58,  2.36s/it][A
Sampling news batches:  56%|██████████████████████████████████████████████████████████████████████████████▎                                                             | 837/1496 [50:07<27:16,  2.48s/it][A
Sampling news batches:  56%|██████████████████████████████████████████████████████████████████████████████▍                                                             | 838/1496 [50:09<23:15,  2.12s/it][A
Sampling news batches:  56%|██████████████████████████████████████████████████████████████████████████████▌                                                             | 839/1496 [50:10<19:37,  1.79s/it][A
Sampling news batches:  56%|██████████████████████████████████████████████████████████████████████████████▌                                                             | 840/1496 [50:12<20:28,  1.87s/it][A{'grad': 4.08071106672287, 'context_loss': 7.644770419597625, 'stance_loss': 1.318197801709175, 'news_loss': 0.7088707983493805}


Validating rep learning:   0%|                                                                                                                                                    | 0/2211 [00:00<?, ?it/s][A[A

Validating rep learning:   8%|██████████▉                                                                                                                             | 177/2211 [00:00<00:01, 1764.71it/s][A[A

Validating rep learning:  17%|███████████████████████▌                                                                                                                | 383/2211 [00:00<00:00, 1843.08it/s][A[A

Validating rep learning:  26%|███████████████████████████████████                                                                                                     | 570/2211 [00:00<00:00, 1848.84it/s][A[A

Validating rep learning:  35%|███████████████████████████████████████████████                                                                                         | 765/2211 [00:00<00:00, 1876.52it/s][A[A

Validating rep learning:  43%|██████████████████████████████████████████████████████████▍                                                                             | 951/2211 [00:00<00:00, 1869.69it/s][A[A

Validating rep learning:  51%|█████████████████████████████████████████████████████████████████████▎                                                                 | 1135/2211 [00:00<00:00, 1858.33it/s][A[A

Validating rep learning:  59%|████████████████████████████████████████████████████████████████████████████████▏                                                      | 1314/2211 [00:00<00:00, 1836.41it/s][A[A

Validating rep learning:  68%|███████████████████████████████████████████████████████████████████████████████████████████▎                                           | 1495/2211 [00:00<00:00, 1827.84it/s][A[A

Validating rep learning:  76%|██████████████████████████████████████████████████████████████████████████████████████████████████████▎                                | 1676/2211 [00:00<00:00, 1820.04it/s][A[A

Validating rep learning:  84%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████▍                     | 1857/2211 [00:01<00:00, 1815.86it/s][A[A

Validating rep learning:  92%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▍          | 2038/2211 [00:01<00:00, 1814.03it/s][A[AValidating rep learning: 100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 2211/2211 [00:01<00:00, 1844.23it/s]
{'stance_avg_closed_ratio': 0.9685678684235498, 'stance_avg_far_ratio': 0.9920728280360428, 'other_avg_closed_ratio': 0.8541797826195738, 'other_avg_far_ratio': 0.0}

Sampling news batches:  56%|█████████████████████████████████████████████████████████████████████████████▌                                                            | 841/1496 [51:12<3:32:28, 19.46s/it][A
Sampling news batches:  56%|█████████████████████████████████████████████████████████████████████████████▋                                                            | 842/1496 [51:13<2:32:09, 13.96s/it][A
Sampling news batches:  56%|█████████████████████████████████████████████████████████████████████████████▊                                                            | 843/1496 [51:20<2:07:37, 11.73s/it][A
Sampling news batches:  56%|█████████████████████████████████████████████████████████████████████████████▊                                                            | 844/1496 [51:22<1:36:55,  8.92s/it][A
Sampling news batches:  56%|█████████████████████████████████████████████████████████████████████████████▉                                                            | 845/1496 [51:24<1:14:41,  6.88s/it][A
Sampling news batches:  57%|███████████████████████████████████████████████████████████████████████████████▏                                                            | 846/1496 [51:26<58:10,  5.37s/it][A
Sampling news batches:  57%|███████████████████████████████████████████████████████████████████████████████▎                                                            | 847/1496 [51:28<45:24,  4.20s/it][A
Sampling news batches:  57%|███████████████████████████████████████████████████████████████████████████████▎                                                            | 848/1496 [51:29<37:05,  3.43s/it][A
Sampling news batches:  57%|███████████████████████████████████████████████████████████████████████████████▍                                                            | 849/1496 [51:31<31:29,  2.92s/it][A
Sampling news batches:  57%|███████████████████████████████████████████████████████████████████████████████▌                                                            | 850/1496 [51:33<28:22,  2.64s/it][A
Sampling news batches:  57%|███████████████████████████████████████████████████████████████████████████████▋                                                            | 851/1496 [51:35<26:14,  2.44s/it][A
Sampling news batches:  57%|███████████████████████████████████████████████████████████████████████████████▋                                                            | 852/1496 [51:37<24:00,  2.24s/it][A
Sampling news batches:  57%|███████████████████████████████████████████████████████████████████████████████▊                                                            | 853/1496 [51:39<24:55,  2.33s/it][A
Sampling news batches:  57%|███████████████████████████████████████████████████████████████████████████████▉                                                            | 854/1496 [51:41<24:02,  2.25s/it][A
Sampling news batches:  57%|████████████████████████████████████████████████████████████████████████████████                                                            | 855/1496 [51:43<22:52,  2.14s/it][A
Sampling news batches:  57%|████████████████████████████████████████████████████████████████████████████████                                                            | 856/1496 [51:45<20:57,  1.96s/it][A
Sampling news batches:  57%|████████████████████████████████████████████████████████████████████████████████▏                                                           | 857/1496 [51:47<20:15,  1.90s/it][A
Sampling news batches:  57%|████████████████████████████████████████████████████████████████████████████████▎                                                           | 858/1496 [51:49<21:12,  2.00s/it][A
Sampling news batches:  57%|████████████████████████████████████████████████████████████████████████████████▍                                                           | 859/1496 [51:50<18:09,  1.71s/it][A
Sampling news batches:  57%|████████████████████████████████████████████████████████████████████████████████▍                                                           | 860/1496 [51:52<20:08,  1.90s/it][A
Sampling news batches:  58%|████████████████████████████████████████████████████████████████████████████████▌                                                           | 861/1496 [51:54<18:45,  1.77s/it][A
Sampling news batches:  58%|████████████████████████████████████████████████████████████████████████████████▋                                                           | 862/1496 [51:56<19:02,  1.80s/it][A
Sampling news batches:  58%|████████████████████████████████████████████████████████████████████████████████▊                                                           | 863/1496 [51:57<17:23,  1.65s/it][A
Sampling news batches:  58%|████████████████████████████████████████████████████████████████████████████████▊                                                           | 864/1496 [52:00<20:37,  1.96s/it][A
Sampling news batches:  58%|████████████████████████████████████████████████████████████████████████████████▉                                                           | 865/1496 [52:01<19:25,  1.85s/it][A
Sampling news batches:  58%|█████████████████████████████████████████████████████████████████████████████████                                                           | 866/1496 [52:02<16:26,  1.57s/it][A
Sampling news batches:  58%|█████████████████████████████████████████████████████████████████████████████████▏                                                          | 867/1496 [52:05<20:58,  2.00s/it][A
Sampling news batches:  58%|█████████████████████████████████████████████████████████████████████████████████▏                                                          | 868/1496 [52:06<19:00,  1.82s/it][A
Sampling news batches:  58%|█████████████████████████████████████████████████████████████████████████████████▎                                                          | 869/1496 [52:08<18:58,  1.82s/it][A
Sampling news batches:  58%|█████████████████████████████████████████████████████████████████████████████████▍                                                          | 870/1496 [52:10<17:59,  1.72s/it][A
Sampling news batches:  58%|█████████████████████████████████████████████████████████████████████████████████▌                                                          | 871/1496 [52:12<19:43,  1.89s/it][A
Sampling news batches:  58%|█████████████████████████████████████████████████████████████████████████████████▌                                                          | 872/1496 [52:14<21:11,  2.04s/it][A
Sampling news batches:  58%|█████████████████████████████████████████████████████████████████████████████████▋                                                          | 873/1496 [52:16<20:47,  2.00s/it][A
Sampling news batches:  58%|█████████████████████████████████████████████████████████████████████████████████▊                                                          | 874/1496 [52:18<20:10,  1.95s/it][A
Sampling news batches:  58%|█████████████████████████████████████████████████████████████████████████████████▉                                                          | 875/1496 [52:21<23:27,  2.27s/it][A
Sampling news batches:  59%|█████████████████████████████████████████████████████████████████████████████████▉                                                          | 876/1496 [52:22<19:17,  1.87s/it][A
Sampling news batches:  59%|██████████████████████████████████████████████████████████████████████████████████                                                          | 877/1496 [52:23<16:37,  1.61s/it][A
Sampling news batches:  59%|██████████████████████████████████████████████████████████████████████████████████▏                                                         | 878/1496 [52:25<18:07,  1.76s/it][A
Sampling news batches:  59%|██████████████████████████████████████████████████████████████████████████████████▎                                                         | 879/1496 [52:28<19:55,  1.94s/it][A
Sampling news batches:  59%|██████████████████████████████████████████████████████████████████████████████████▎                                                         | 880/1496 [52:33<29:53,  2.91s/it][A{'grad': 7.034195423126221, 'context_loss': 7.667944288253784, 'stance_loss': nan, 'news_loss': 0.7193922996520996}


Validating rep learning:   0%|                                                                                                                                                    | 0/2211 [00:00<?, ?it/s][A[A

Validating rep learning:   8%|███████████                                                                                                                             | 180/2211 [00:00<00:01, 1794.96it/s][A[A

Validating rep learning:  18%|████████████████████████                                                                                                                | 392/2211 [00:00<00:00, 1879.93it/s][A[A

Validating rep learning:  26%|███████████████████████████████████▋                                                                                                    | 580/2211 [00:00<00:00, 1877.46it/s][A[A

Validating rep learning:  35%|███████████████████████████████████████████████▊                                                                                        | 777/2211 [00:00<00:00, 1902.51it/s][A[A

Validating rep learning:  44%|███████████████████████████████████████████████████████████▎                                                                            | 964/2211 [00:00<00:00, 1889.89it/s][A[A

Validating rep learning:  52%|██████████████████████████████████████████████████████████████████████▏                                                                | 1149/2211 [00:00<00:00, 1875.81it/s][A[A

Validating rep learning:  60%|█████████████████████████████████████████████████████████████████████████████████▎                                                     | 1331/2211 [00:00<00:00, 1857.18it/s][A[A

Validating rep learning:  68%|████████████████████████████████████████████████████████████████████████████████████████████▎                                          | 1512/2211 [00:00<00:00, 1842.58it/s][A[A

Validating rep learning:  77%|███████████████████████████████████████████████████████████████████████████████████████████████████████▍                               | 1695/2211 [00:00<00:00, 1835.94it/s][A[A

Validating rep learning:  85%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████▋                    | 1878/2211 [00:01<00:00, 1833.30it/s][A[A

Validating rep learning:  93%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▊         | 2061/2211 [00:01<00:00, 1829.57it/s][A[AValidating rep learning: 100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 2211/2211 [00:01<00:00, 1862.89it/s]
{'stance_avg_closed_ratio': 0.9680057785097256, 'stance_avg_far_ratio': 0.9891558744040428, 'other_avg_closed_ratio': 0.943722403667112, 'other_avg_far_ratio': 0.0}

Sampling news batches:  59%|█████████████████████████████████████████████████████████████████████████████████▎                                                        | 881/1496 [53:33<3:26:15, 20.12s/it][A
Sampling news batches:  59%|█████████████████████████████████████████████████████████████████████████████████▎                                                        | 882/1496 [53:35<2:29:12, 14.58s/it][A
Sampling news batches:  59%|█████████████████████████████████████████████████████████████████████████████████▍                                                        | 883/1496 [53:38<1:55:27, 11.30s/it][A
Sampling news batches:  59%|█████████████████████████████████████████████████████████████████████████████████▌                                                        | 884/1496 [53:40<1:25:57,  8.43s/it][A
Sampling news batches:  59%|█████████████████████████████████████████████████████████████████████████████████▋                                                        | 885/1496 [53:41<1:02:01,  6.09s/it][A
Sampling news batches:  59%|██████████████████████████████████████████████████████████████████████████████████▉                                                         | 886/1496 [53:44<52:52,  5.20s/it][A
Sampling news batches:  59%|███████████████████████████████████████████████████████████████████████████████████                                                         | 887/1496 [53:45<41:15,  4.06s/it][A
Sampling news batches:  59%|███████████████████████████████████████████████████████████████████████████████████                                                         | 888/1496 [53:47<34:09,  3.37s/it][A
Sampling news batches:  59%|███████████████████████████████████████████████████████████████████████████████████▏                                                        | 889/1496 [53:49<28:51,  2.85s/it][A
Sampling news batches:  59%|███████████████████████████████████████████████████████████████████████████████████▎                                                        | 890/1496 [53:51<25:38,  2.54s/it][A
Sampling news batches:  60%|███████████████████████████████████████████████████████████████████████████████████▍                                                        | 891/1496 [53:52<21:47,  2.16s/it][A
Sampling news batches:  60%|███████████████████████████████████████████████████████████████████████████████████▍                                                        | 892/1496 [53:53<18:38,  1.85s/it][A
Sampling news batches:  60%|███████████████████████████████████████████████████████████████████████████████████▌                                                        | 893/1496 [53:55<17:53,  1.78s/it][A
Sampling news batches:  60%|███████████████████████████████████████████████████████████████████████████████████▋                                                        | 894/1496 [54:01<30:56,  3.08s/it][A
Sampling news batches:  60%|███████████████████████████████████████████████████████████████████████████████████▊                                                        | 895/1496 [54:03<27:42,  2.77s/it][A
Sampling news batches:  60%|███████████████████████████████████████████████████████████████████████████████████▊                                                        | 896/1496 [54:04<22:37,  2.26s/it][A
Sampling news batches:  60%|███████████████████████████████████████████████████████████████████████████████████▉                                                        | 897/1496 [54:05<20:12,  2.02s/it][A
Sampling news batches:  60%|████████████████████████████████████████████████████████████████████████████████████                                                        | 898/1496 [54:08<22:40,  2.27s/it][A
Sampling news batches:  60%|████████████████████████████████████████████████████████████████████████████████████▏                                                       | 899/1496 [54:10<20:21,  2.05s/it][A
Sampling news batches:  60%|████████████████████████████████████████████████████████████████████████████████████▏                                                       | 900/1496 [54:12<20:12,  2.03s/it][A
Sampling news batches:  60%|████████████████████████████████████████████████████████████████████████████████████▎                                                       | 901/1496 [54:14<20:34,  2.08s/it][A
Sampling news batches:  60%|████████████████████████████████████████████████████████████████████████████████████▍                                                       | 902/1496 [54:16<21:51,  2.21s/it][A
Sampling news batches:  60%|████████████████████████████████████████████████████████████████████████████████████▌                                                       | 903/1496 [54:19<22:28,  2.27s/it][A
Sampling news batches:  60%|████████████████████████████████████████████████████████████████████████████████████▌                                                       | 904/1496 [54:20<20:32,  2.08s/it][A
Sampling news batches:  60%|████████████████████████████████████████████████████████████████████████████████████▋                                                       | 905/1496 [54:22<18:31,  1.88s/it][A
Sampling news batches:  61%|████████████████████████████████████████████████████████████████████████████████████▊                                                       | 906/1496 [54:23<15:12,  1.55s/it][A
Sampling news batches:  61%|████████████████████████████████████████████████████████████████████████████████████▉                                                       | 907/1496 [54:24<14:49,  1.51s/it][A
Sampling news batches:  61%|████████████████████████████████████████████████████████████████████████████████████▉                                                       | 908/1496 [54:26<16:37,  1.70s/it][A
Sampling news batches:  61%|█████████████████████████████████████████████████████████████████████████████████████                                                       | 909/1496 [54:27<15:20,  1.57s/it][A
Sampling news batches:  61%|█████████████████████████████████████████████████████████████████████████████████████▏                                                      | 910/1496 [54:29<15:06,  1.55s/it][A
Sampling news batches:  61%|█████████████████████████████████████████████████████████████████████████████████████▎                                                      | 911/1496 [54:30<14:47,  1.52s/it][A
Sampling news batches:  61%|█████████████████████████████████████████████████████████████████████████████████████▎                                                      | 912/1496 [54:32<15:28,  1.59s/it][A
Sampling news batches:  61%|█████████████████████████████████████████████████████████████████████████████████████▍                                                      | 913/1496 [54:34<15:14,  1.57s/it][A
Sampling news batches:  61%|█████████████████████████████████████████████████████████████████████████████████████▌                                                      | 914/1496 [54:37<20:11,  2.08s/it][A
Sampling news batches:  61%|█████████████████████████████████████████████████████████████████████████████████████▋                                                      | 915/1496 [54:39<19:23,  2.00s/it][A
Sampling news batches:  61%|█████████████████████████████████████████████████████████████████████████████████████▋                                                      | 916/1496 [54:41<19:04,  1.97s/it][A
Sampling news batches:  61%|█████████████████████████████████████████████████████████████████████████████████████▊                                                      | 917/1496 [54:43<19:08,  1.98s/it][A
Sampling news batches:  61%|█████████████████████████████████████████████████████████████████████████████████████▉                                                      | 918/1496 [54:44<17:14,  1.79s/it][A
Sampling news batches:  61%|██████████████████████████████████████████████████████████████████████████████████████                                                      | 919/1496 [54:45<15:40,  1.63s/it][A
Sampling news batches:  61%|██████████████████████████████████████████████████████████████████████████████████████                                                      | 920/1496 [54:47<16:36,  1.73s/it][A{'grad': 6.690906524658203, 'context_loss': 7.697516584396363, 'stance_loss': 1.3120109396321433, 'news_loss': 0.7237893640995026}


Validating rep learning:   0%|                                                                                                                                                    | 0/2211 [00:00<?, ?it/s][A[A

Validating rep learning:   8%|██████████▊                                                                                                                             | 175/2211 [00:00<00:01, 1741.44it/s][A[A

Validating rep learning:  17%|███████████████████████▌                                                                                                                | 383/2211 [00:00<00:00, 1829.22it/s][A[A

Validating rep learning:  26%|███████████████████████████████████                                                                                                     | 571/2211 [00:00<00:00, 1841.07it/s][A[A

Validating rep learning:  34%|██████████████████████████████████████████████▋                                                                                         | 760/2211 [00:00<00:00, 1855.37it/s][A[A

Validating rep learning:  43%|██████████████████████████████████████████████████████████▎                                                                             | 949/2211 [00:00<00:00, 1864.60it/s][A[A

Validating rep learning:  51%|█████████████████████████████████████████████████████████████████████▍                                                                 | 1137/2211 [00:00<00:00, 1867.10it/s][A[A

Validating rep learning:  60%|████████████████████████████████████████████████████████████████████████████████▌                                                      | 1320/2211 [00:00<00:00, 1853.56it/s][A[A

Validating rep learning:  68%|███████████████████████████████████████████████████████████████████████████████████████████▊                                           | 1503/2211 [00:00<00:00, 1845.68it/s][A[A

Validating rep learning:  76%|██████████████████████████████████████████████████████████████████████████████████████████████████████▉                                | 1685/2211 [00:00<00:00, 1836.26it/s][A[A

Validating rep learning:  85%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████                     | 1869/2211 [00:01<00:00, 1834.65it/s][A[A

Validating rep learning:  93%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▏         | 2051/2211 [00:01<00:00, 1830.17it/s][A[AValidating rep learning: 100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 2211/2211 [00:01<00:00, 1856.58it/s]
{'stance_avg_closed_ratio': 0.9172402319092066, 'stance_avg_far_ratio': 0.9453319376549605, 'other_avg_closed_ratio': 0.8434462085665663, 'other_avg_far_ratio': 0.0}

Sampling news batches:  62%|████████████████████████████████████████████████████████████████████████████████████▉                                                     | 921/1496 [55:52<3:19:26, 20.81s/it][A
Sampling news batches:  62%|█████████████████████████████████████████████████████████████████████████████████████                                                     | 922/1496 [55:54<2:22:52, 14.93s/it][A
Sampling news batches:  62%|█████████████████████████████████████████████████████████████████████████████████████▏                                                    | 923/1496 [55:55<1:43:09, 10.80s/it][A
Sampling news batches:  62%|█████████████████████████████████████████████████████████████████████████████████████▏                                                    | 924/1496 [55:58<1:20:18,  8.42s/it][A
Sampling news batches:  62%|██████████████████████████████████████████████████████████████████████████████████████▌                                                     | 925/1496 [55:59<58:58,  6.20s/it][A
Sampling news batches:  62%|██████████████████████████████████████████████████████████████████████████████████████▋                                                     | 926/1496 [56:00<46:11,  4.86s/it][A
Sampling news batches:  62%|██████████████████████████████████████████████████████████████████████████████████████▊                                                     | 927/1496 [56:02<36:47,  3.88s/it][A
Sampling news batches:  62%|██████████████████████████████████████████████████████████████████████████████████████▊                                                     | 928/1496 [56:03<29:21,  3.10s/it][A
Sampling news batches:  62%|██████████████████████████████████████████████████████████████████████████████████████▉                                                     | 929/1496 [56:05<23:55,  2.53s/it][A
Sampling news batches:  62%|███████████████████████████████████████████████████████████████████████████████████████                                                     | 930/1496 [56:06<21:26,  2.27s/it][A
Sampling news batches:  62%|███████████████████████████████████████████████████████████████████████████████████████▏                                                    | 931/1496 [56:08<20:57,  2.23s/it][A
Sampling news batches:  62%|███████████████████████████████████████████████████████████████████████████████████████▏                                                    | 932/1496 [56:10<18:16,  1.94s/it][A
Sampling news batches:  62%|███████████████████████████████████████████████████████████████████████████████████████▎                                                    | 933/1496 [56:12<19:10,  2.04s/it][A
Sampling news batches:  62%|███████████████████████████████████████████████████████████████████████████████████████▍                                                    | 934/1496 [56:14<19:50,  2.12s/it][A
Sampling news batches:  62%|███████████████████████████████████████████████████████████████████████████████████████▌                                                    | 935/1496 [56:17<20:25,  2.18s/it][A
Sampling news batches:  63%|███████████████████████████████████████████████████████████████████████████████████████▌                                                    | 936/1496 [56:18<19:09,  2.05s/it][A
Sampling news batches:  63%|███████████████████████████████████████████████████████████████████████████████████████▋                                                    | 937/1496 [56:20<19:23,  2.08s/it][A
Sampling news batches:  63%|███████████████████████████████████████████████████████████████████████████████████████▊                                                    | 938/1496 [56:22<17:25,  1.87s/it][A
Sampling news batches:  63%|███████████████████████████████████████████████████████████████████████████████████████▊                                                    | 939/1496 [56:23<16:25,  1.77s/it][A
Sampling news batches:  63%|███████████████████████████████████████████████████████████████████████████████████████▉                                                    | 940/1496 [56:25<16:03,  1.73s/it][A
Sampling news batches:  63%|████████████████████████████████████████████████████████████████████████████████████████                                                    | 941/1496 [56:27<15:58,  1.73s/it][A
Sampling news batches:  63%|████████████████████████████████████████████████████████████████████████████████████████▏                                                   | 942/1496 [56:29<16:07,  1.75s/it][A
Sampling news batches:  63%|████████████████████████████████████████████████████████████████████████████████████████▏                                                   | 943/1496 [56:31<17:16,  1.87s/it][A
Sampling news batches:  63%|████████████████████████████████████████████████████████████████████████████████████████▎                                                   | 944/1496 [56:32<15:35,  1.69s/it][A
Sampling news batches:  63%|████████████████████████████████████████████████████████████████████████████████████████▍                                                   | 945/1496 [56:34<15:34,  1.70s/it][A
Sampling news batches:  63%|████████████████████████████████████████████████████████████████████████████████████████▌                                                   | 946/1496 [56:35<13:43,  1.50s/it][A
Sampling news batches:  63%|████████████████████████████████████████████████████████████████████████████████████████▌                                                   | 947/1496 [56:37<15:17,  1.67s/it][A
Sampling news batches:  63%|████████████████████████████████████████████████████████████████████████████████████████▋                                                   | 948/1496 [56:39<15:40,  1.72s/it][A
Sampling news batches:  63%|████████████████████████████████████████████████████████████████████████████████████████▊                                                   | 949/1496 [56:40<15:23,  1.69s/it][A
Sampling news batches:  64%|████████████████████████████████████████████████████████████████████████████████████████▉                                                   | 950/1496 [56:42<16:01,  1.76s/it][A
Sampling news batches:  64%|████████████████████████████████████████████████████████████████████████████████████████▉                                                   | 951/1496 [56:45<17:41,  1.95s/it][A
Sampling news batches:  64%|█████████████████████████████████████████████████████████████████████████████████████████                                                   | 952/1496 [56:46<17:04,  1.88s/it][A
Sampling news batches:  64%|█████████████████████████████████████████████████████████████████████████████████████████▏                                                  | 953/1496 [56:49<18:28,  2.04s/it][A
Sampling news batches:  64%|█████████████████████████████████████████████████████████████████████████████████████████▎                                                  | 954/1496 [56:50<16:24,  1.82s/it][A
Sampling news batches:  64%|█████████████████████████████████████████████████████████████████████████████████████████▎                                                  | 955/1496 [56:52<18:17,  2.03s/it][A
Sampling news batches:  64%|█████████████████████████████████████████████████████████████████████████████████████████▍                                                  | 956/1496 [56:56<21:41,  2.41s/it][A
Sampling news batches:  64%|█████████████████████████████████████████████████████████████████████████████████████████▌                                                  | 957/1496 [56:59<24:47,  2.76s/it][A
Sampling news batches:  64%|█████████████████████████████████████████████████████████████████████████████████████████▋                                                  | 958/1496 [57:00<19:44,  2.20s/it][A
Sampling news batches:  64%|█████████████████████████████████████████████████████████████████████████████████████████▋                                                  | 959/1496 [57:02<17:54,  2.00s/it][A
Sampling news batches:  64%|█████████████████████████████████████████████████████████████████████████████████████████▊                                                  | 960/1496 [57:08<28:49,  3.23s/it][A{'grad': 5.427282214164734, 'context_loss': 7.624135851860046, 'stance_loss': nan, 'news_loss': 0.7165617644786835}


Validating rep learning:   0%|                                                                                                                                                    | 0/2211 [00:00<?, ?it/s][A[A

Validating rep learning:   8%|███████████▏                                                                                                                            | 181/2211 [00:00<00:01, 1802.63it/s][A[A

Validating rep learning:  18%|████████████████████████▏                                                                                                               | 393/2211 [00:00<00:00, 1885.90it/s][A[A

Validating rep learning:  26%|███████████████████████████████████▊                                                                                                    | 583/2211 [00:00<00:00, 1888.19it/s][A[A

Validating rep learning:  35%|████████████████████████████████████████████████                                                                                        | 781/2211 [00:00<00:00, 1913.63it/s][A[A

Validating rep learning:  44%|███████████████████████████████████████████████████████████▋                                                                            | 971/2211 [00:00<00:00, 1906.62it/s][A[A

Validating rep learning:  52%|██████████████████████████████████████████████████████████████████████▊                                                                | 1159/2211 [00:00<00:00, 1897.78it/s][A[A

Validating rep learning:  61%|█████████████████████████████████████████████████████████████████████████████████▉                                                     | 1342/2211 [00:00<00:00, 1876.80it/s][A[A

Validating rep learning:  69%|█████████████████████████████████████████████████████████████████████████████████████████████▏                                         | 1526/2211 [00:00<00:00, 1864.51it/s][A[A

Validating rep learning:  77%|████████████████████████████████████████████████████████████████████████████████████████████████████████▍                              | 1711/2211 [00:00<00:00, 1857.33it/s][A[A

Validating rep learning:  86%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████▋                   | 1895/2211 [00:01<00:00, 1850.55it/s][A[A

Validating rep learning:  94%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▉        | 2079/2211 [00:01<00:00, 1846.41it/s][A[AValidating rep learning: 100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 2211/2211 [00:01<00:00, 1881.00it/s]
{'stance_avg_closed_ratio': 0.9463835507179058, 'stance_avg_far_ratio': 0.9522989551043523, 'other_avg_closed_ratio': 0.799939783437774, 'other_avg_far_ratio': 0.0}

Sampling news batches:  64%|████████████████████████████████████████████████████████████████████████████████████████▋                                                 | 961/1496 [58:09<3:02:52, 20.51s/it][A
Sampling news batches:  64%|████████████████████████████████████████████████████████████████████████████████████████▋                                                 | 962/1496 [58:12<2:15:44, 15.25s/it][A
Sampling news batches:  64%|████████████████████████████████████████████████████████████████████████████████████████▊                                                 | 963/1496 [58:13<1:39:15, 11.17s/it][A
Sampling news batches:  64%|████████████████████████████████████████████████████████████████████████████████████████▉                                                 | 964/1496 [58:15<1:13:37,  8.30s/it][A
Sampling news batches:  65%|██████████████████████████████████████████████████████████████████████████████████████████▎                                                 | 965/1496 [58:16<54:35,  6.17s/it][A
Sampling news batches:  65%|██████████████████████████████████████████████████████████████████████████████████████████▍                                                 | 966/1496 [58:20<47:54,  5.42s/it][A
Sampling news batches:  65%|██████████████████████████████████████████████████████████████████████████████████████████▍                                                 | 967/1496 [58:21<37:09,  4.21s/it][A
Sampling news batches:  65%|██████████████████████████████████████████████████████████████████████████████████████████▌                                                 | 968/1496 [58:23<30:54,  3.51s/it][A
Sampling news batches:  65%|██████████████████████████████████████████████████████████████████████████████████████████▋                                                 | 969/1496 [58:25<26:36,  3.03s/it][A
Sampling news batches:  65%|██████████████████████████████████████████████████████████████████████████████████████████▊                                                 | 970/1496 [58:27<22:37,  2.58s/it][A
Sampling news batches:  65%|██████████████████████████████████████████████████████████████████████████████████████████▊                                                 | 971/1496 [58:28<20:18,  2.32s/it][A
Sampling news batches:  65%|██████████████████████████████████████████████████████████████████████████████████████████▉                                                 | 972/1496 [58:30<19:10,  2.20s/it][A
Sampling news batches:  65%|███████████████████████████████████████████████████████████████████████████████████████████                                                 | 973/1496 [58:32<19:04,  2.19s/it][A
Sampling news batches:  65%|███████████████████████████████████████████████████████████████████████████████████████████▏                                                | 974/1496 [58:34<17:04,  1.96s/it][A
Sampling news batches:  65%|███████████████████████████████████████████████████████████████████████████████████████████▏                                                | 975/1496 [58:36<17:42,  2.04s/it][A
Sampling news batches:  65%|███████████████████████████████████████████████████████████████████████████████████████████▎                                                | 976/1496 [58:42<27:23,  3.16s/it][A
Sampling news batches:  65%|███████████████████████████████████████████████████████████████████████████████████████████▍                                                | 977/1496 [58:43<22:26,  2.59s/it][A
Sampling news batches:  65%|███████████████████████████████████████████████████████████████████████████████████████████▌                                                | 978/1496 [58:45<20:03,  2.32s/it][A
Sampling news batches:  65%|███████████████████████████████████████████████████████████████████████████████████████████▌                                                | 979/1496 [58:50<26:22,  3.06s/it][A
Sampling news batches:  66%|███████████████████████████████████████████████████████████████████████████████████████████▋                                                | 980/1496 [58:51<23:19,  2.71s/it][A
Sampling news batches:  66%|███████████████████████████████████████████████████████████████████████████████████████████▊                                                | 981/1496 [58:53<20:55,  2.44s/it][A
Sampling news batches:  66%|███████████████████████████████████████████████████████████████████████████████████████████▉                                                | 982/1496 [58:56<22:50,  2.67s/it][A
Sampling news batches:  66%|███████████████████████████████████████████████████████████████████████████████████████████▉                                                | 983/1496 [59:00<25:50,  3.02s/it][A
Sampling news batches:  66%|████████████████████████████████████████████████████████████████████████████████████████████                                                | 984/1496 [59:02<23:16,  2.73s/it][A
Sampling news batches:  66%|████████████████████████████████████████████████████████████████████████████████████████████▏                                               | 985/1496 [59:04<19:33,  2.30s/it][A
Sampling news batches:  66%|████████████████████████████████████████████████████████████████████████████████████████████▎                                               | 986/1496 [59:06<20:03,  2.36s/it][A
Sampling news batches:  66%|████████████████████████████████████████████████████████████████████████████████████████████▎                                               | 987/1496 [59:08<18:07,  2.14s/it][A
Sampling news batches:  66%|████████████████████████████████████████████████████████████████████████████████████████████▍                                               | 988/1496 [59:09<15:43,  1.86s/it][A
Sampling news batches:  66%|████████████████████████████████████████████████████████████████████████████████████████████▌                                               | 989/1496 [59:10<13:50,  1.64s/it][A
Sampling news batches:  66%|████████████████████████████████████████████████████████████████████████████████████████████▋                                               | 990/1496 [59:18<30:27,  3.61s/it][A
Sampling news batches:  66%|████████████████████████████████████████████████████████████████████████████████████████████▋                                               | 991/1496 [59:21<27:37,  3.28s/it][A
Sampling news batches:  66%|████████████████████████████████████████████████████████████████████████████████████████████▊                                               | 992/1496 [59:24<26:31,  3.16s/it][A
Sampling news batches:  66%|████████████████████████████████████████████████████████████████████████████████████████████▉                                               | 993/1496 [59:25<22:29,  2.68s/it][A
Sampling news batches:  66%|█████████████████████████████████████████████████████████████████████████████████████████████                                               | 994/1496 [59:28<23:10,  2.77s/it][A
Sampling news batches:  67%|█████████████████████████████████████████████████████████████████████████████████████████████                                               | 995/1496 [59:30<19:48,  2.37s/it][A
Sampling news batches:  67%|█████████████████████████████████████████████████████████████████████████████████████████████▏                                              | 996/1496 [59:33<21:20,  2.56s/it][A
Sampling news batches:  67%|█████████████████████████████████████████████████████████████████████████████████████████████▎                                              | 997/1496 [59:34<18:50,  2.27s/it][A
Sampling news batches:  67%|█████████████████████████████████████████████████████████████████████████████████████████████▍                                              | 998/1496 [59:36<17:02,  2.05s/it][A
Sampling news batches:  67%|█████████████████████████████████████████████████████████████████████████████████████████████▍                                              | 999/1496 [59:37<14:55,  1.80s/it][A
Sampling news batches:  67%|████████████████████████████████████████████████████████████████████████████████████████████▉                                              | 1000/1496 [59:39<14:27,  1.75s/it][A{'grad': 4.395693302154541, 'context_loss': 7.741002333164215, 'stance_loss': 1.2009788546068916, 'news_loss': 0.6870599389076233}


Validating rep learning:   0%|                                                                                                                                                    | 0/2211 [00:00<?, ?it/s][A[A

Validating rep learning:   8%|███████████                                                                                                                             | 180/2211 [00:00<00:01, 1793.53it/s][A[A

Validating rep learning:  18%|████████████████████████                                                                                                                | 392/2211 [00:00<00:00, 1879.06it/s][A[A

Validating rep learning:  26%|███████████████████████████████████▊                                                                                                    | 582/2211 [00:00<00:00, 1884.05it/s][A[A

Validating rep learning:  35%|████████████████████████████████████████████████                                                                                        | 781/2211 [00:00<00:00, 1912.46it/s][A[A

Validating rep learning:  44%|███████████████████████████████████████████████████████████▌                                                                            | 969/2211 [00:00<00:00, 1900.05it/s][A[A

Validating rep learning:  52%|██████████████████████████████████████████████████████████████████████▌                                                                | 1156/2211 [00:00<00:00, 1886.74it/s][A[A

Validating rep learning:  61%|█████████████████████████████████████████████████████████████████████████████████▊                                                     | 1339/2211 [00:00<00:00, 1867.52it/s][A[A

Validating rep learning:  69%|████████████████████████████████████████████████████████████████████████████████████████████▊                                          | 1521/2211 [00:00<00:00, 1852.14it/s][A[A

Validating rep learning:  77%|████████████████████████████████████████████████████████████████████████████████████████████████████████                               | 1705/2211 [00:00<00:00, 1846.72it/s][A[A

Validating rep learning:  85%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████▎                   | 1888/2211 [00:01<00:00, 1840.31it/s][A[A

Validating rep learning:  94%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▍        | 2071/2211 [00:01<00:00, 1835.34it/s][A[AValidating rep learning: 100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 2211/2211 [00:01<00:00, 1872.87it/s]
{'stance_avg_closed_ratio': 0.9441164007114207, 'stance_avg_far_ratio': 0.987749194869988, 'other_avg_closed_ratio': 0.7871329629807278, 'other_avg_far_ratio': 0.0}

Sampling news batches:  67%|██████████████████████████████████████████████████████████████████████████████████████████▎                                            | 1001/1496 [1:00:56<3:20:45, 24.33s/it][A
Sampling news batches:  67%|██████████████████████████████████████████████████████████████████████████████████████████▍                                            | 1002/1496 [1:00:57<2:22:32, 17.31s/it][A
Sampling news batches:  67%|██████████████████████████████████████████████████████████████████████████████████████████▌                                            | 1003/1496 [1:00:58<1:44:09, 12.68s/it][A
Sampling news batches:  67%|██████████████████████████████████████████████████████████████████████████████████████████▌                                            | 1004/1496 [1:01:00<1:17:24,  9.44s/it][A
Sampling news batches:  67%|████████████████████████████████████████████████████████████████████████████████████████████                                             | 1005/1496 [1:01:02<58:00,  7.09s/it][A
Sampling news batches:  67%|████████████████████████████████████████████████████████████████████████████████████████████▏                                            | 1006/1496 [1:01:04<46:34,  5.70s/it][A
Sampling news batches:  67%|████████████████████████████████████████████████████████████████████████████████████████████▏                                            | 1007/1496 [1:01:06<35:28,  4.35s/it][A
Sampling news batches:  67%|████████████████████████████████████████████████████████████████████████████████████████████▎                                            | 1008/1496 [1:01:07<28:35,  3.52s/it][A
Sampling news batches:  67%|████████████████████████████████████████████████████████████████████████████████████████████▍                                            | 1009/1496 [1:01:10<27:28,  3.39s/it][A
Sampling news batches:  68%|████████████████████████████████████████████████████████████████████████████████████████████▍                                            | 1010/1496 [1:01:12<22:50,  2.82s/it][A
Sampling news batches:  68%|████████████████████████████████████████████████████████████████████████████████████████████▌                                            | 1011/1496 [1:01:13<18:28,  2.28s/it][A
Sampling news batches:  68%|████████████████████████████████████████████████████████████████████████████████████████████▋                                            | 1012/1496 [1:01:14<16:58,  2.10s/it][A
Sampling news batches:  68%|████████████████████████████████████████████████████████████████████████████████████████████▊                                            | 1013/1496 [1:01:17<18:18,  2.27s/it][A
Sampling news batches:  68%|████████████████████████████████████████████████████████████████████████████████████████████▊                                            | 1014/1496 [1:01:20<19:08,  2.38s/it][A
Sampling news batches:  68%|████████████████████████████████████████████████████████████████████████████████████████████▉                                            | 1015/1496 [1:01:22<18:48,  2.35s/it][A
Sampling news batches:  68%|█████████████████████████████████████████████████████████████████████████████████████████████                                            | 1016/1496 [1:01:23<15:21,  1.92s/it][A
Sampling news batches:  68%|█████████████████████████████████████████████████████████████████████████████████████████████▏                                           | 1017/1496 [1:01:25<15:42,  1.97s/it][A
Sampling news batches:  68%|█████████████████████████████████████████████████████████████████████████████████████████████▏                                           | 1018/1496 [1:01:27<16:13,  2.04s/it][A
Sampling news batches:  68%|█████████████████████████████████████████████████████████████████████████████████████████████▎                                           | 1019/1496 [1:01:29<16:21,  2.06s/it][A
Sampling news batches:  68%|█████████████████████████████████████████████████████████████████████████████████████████████▍                                           | 1020/1496 [1:01:31<15:56,  2.01s/it][A
Sampling news batches:  68%|█████████████████████████████████████████████████████████████████████████████████████████████▌                                           | 1021/1496 [1:01:35<20:51,  2.63s/it][A
Sampling news batches:  68%|█████████████████████████████████████████████████████████████████████████████████████████████▌                                           | 1022/1496 [1:01:41<28:51,  3.65s/it][A
Sampling news batches:  68%|█████████████████████████████████████████████████████████████████████████████████████████████▋                                           | 1023/1496 [1:01:43<24:50,  3.15s/it][A
Sampling news batches:  68%|█████████████████████████████████████████████████████████████████████████████████████████████▊                                           | 1024/1496 [1:01:45<22:01,  2.80s/it][A
Sampling news batches:  69%|█████████████████████████████████████████████████████████████████████████████████████████████▊                                           | 1025/1496 [1:01:47<20:09,  2.57s/it][A
Sampling news batches:  69%|█████████████████████████████████████████████████████████████████████████████████████████████▉                                           | 1026/1496 [1:01:49<17:31,  2.24s/it][A
Sampling news batches:  69%|██████████████████████████████████████████████████████████████████████████████████████████████                                           | 1027/1496 [1:01:51<16:23,  2.10s/it][A
Sampling news batches:  69%|██████████████████████████████████████████████████████████████████████████████████████████████▏                                          | 1028/1496 [1:01:52<14:03,  1.80s/it][A
Sampling news batches:  69%|██████████████████████████████████████████████████████████████████████████████████████████████▏                                          | 1029/1496 [1:01:55<17:18,  2.22s/it][A
Sampling news batches:  69%|██████████████████████████████████████████████████████████████████████████████████████████████▎                                          | 1030/1496 [1:01:59<21:45,  2.80s/it][A
Sampling news batches:  69%|██████████████████████████████████████████████████████████████████████████████████████████████▍                                          | 1031/1496 [1:02:02<22:55,  2.96s/it][A
Sampling news batches:  69%|██████████████████████████████████████████████████████████████████████████████████████████████▌                                          | 1032/1496 [1:02:04<20:49,  2.69s/it][A
Sampling news batches:  69%|██████████████████████████████████████████████████████████████████████████████████████████████▌                                          | 1033/1496 [1:02:06<17:07,  2.22s/it][A
Sampling news batches:  69%|██████████████████████████████████████████████████████████████████████████████████████████████▋                                          | 1034/1496 [1:02:08<16:34,  2.15s/it][A
Sampling news batches:  69%|██████████████████████████████████████████████████████████████████████████████████████████████▊                                          | 1035/1496 [1:02:09<15:23,  2.00s/it][A
Sampling news batches:  69%|██████████████████████████████████████████████████████████████████████████████████████████████▊                                          | 1036/1496 [1:02:10<13:23,  1.75s/it][A
Sampling news batches:  69%|██████████████████████████████████████████████████████████████████████████████████████████████▉                                          | 1037/1496 [1:02:12<13:15,  1.73s/it][A
Sampling news batches:  69%|███████████████████████████████████████████████████████████████████████████████████████████████                                          | 1038/1496 [1:02:14<14:19,  1.88s/it][A
Sampling news batches:  69%|███████████████████████████████████████████████████████████████████████████████████████████████▏                                         | 1039/1496 [1:02:16<13:35,  1.78s/it][A
Sampling news batches:  70%|███████████████████████████████████████████████████████████████████████████████████████████████▏                                         | 1040/1496 [1:02:18<13:48,  1.82s/it][A{'grad': 3.766634464263916, 'context_loss': 7.663847637176514, 'stance_loss': 1.212000256982343, 'news_loss': 0.6612030267715454}


Validating rep learning:   0%|                                                                                                                                                    | 0/2211 [00:00<?, ?it/s][A[A

Validating rep learning:   8%|███████████▏                                                                                                                            | 181/2211 [00:00<00:01, 1806.90it/s][A[A

Validating rep learning:  18%|████████████████████████                                                                                                                | 391/2211 [00:00<00:00, 1884.87it/s][A[A

Validating rep learning:  26%|███████████████████████████████████▍                                                                                                    | 577/2211 [00:00<00:00, 1875.53it/s][A[A

Validating rep learning:  35%|███████████████████████████████████████████████▌                                                                                        | 773/2211 [00:00<00:00, 1897.76it/s][A[A

Validating rep learning:  43%|██████████████████████████████████████████████████████████▉                                                                             | 958/2211 [00:00<00:00, 1882.29it/s][A[A

Validating rep learning:  52%|█████████████████████████████████████████████████████████████████████▊                                                                 | 1144/2211 [00:00<00:00, 1873.64it/s][A[A

Validating rep learning:  60%|████████████████████████████████████████████████████████████████████████████████▉                                                      | 1326/2211 [00:00<00:00, 1854.93it/s][A[A

Validating rep learning:  68%|████████████████████████████████████████████████████████████████████████████████████████████                                           | 1507/2211 [00:00<00:00, 1840.15it/s][A[A

Validating rep learning:  76%|███████████████████████████████████████████████████████████████████████████████████████████████████████▏                               | 1689/2211 [00:00<00:00, 1831.31it/s][A[A

Validating rep learning:  85%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████▏                    | 1871/2211 [00:01<00:00, 1826.76it/s][A[A

Validating rep learning:  93%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▎         | 2052/2211 [00:01<00:00, 1820.66it/s][A[AValidating rep learning: 100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 2211/2211 [00:01<00:00, 1856.91it/s]
{'stance_avg_closed_ratio': 0.9284778701214607, 'stance_avg_far_ratio': 0.9413153164989737, 'other_avg_closed_ratio': 0.63138098219439, 'other_avg_far_ratio': 0.0}

Sampling news batches:  70%|█████████████████████████████████████████████████████████████████████████████████████████████▉                                         | 1041/1496 [1:03:23<2:38:48, 20.94s/it][A
Sampling news batches:  70%|██████████████████████████████████████████████████████████████████████████████████████████████                                         | 1042/1496 [1:03:25<1:54:32, 15.14s/it][A
Sampling news batches:  70%|██████████████████████████████████████████████████████████████████████████████████████████████                                         | 1043/1496 [1:03:26<1:22:52, 10.98s/it][A
Sampling news batches:  70%|██████████████████████████████████████████████████████████████████████████████████████████████▏                                        | 1044/1496 [1:03:27<1:00:54,  8.09s/it][A
Sampling news batches:  70%|███████████████████████████████████████████████████████████████████████████████████████████████▋                                         | 1045/1496 [1:03:30<49:09,  6.54s/it][A
Sampling news batches:  70%|███████████████████████████████████████████████████████████████████████████████████████████████▊                                         | 1046/1496 [1:03:32<37:05,  4.95s/it][A
Sampling news batches:  70%|███████████████████████████████████████████████████████████████████████████████████████████████▉                                         | 1047/1496 [1:03:33<29:04,  3.89s/it][A
Sampling news batches:  70%|███████████████████████████████████████████████████████████████████████████████████████████████▉                                         | 1048/1496 [1:03:36<27:03,  3.62s/it][A
Sampling news batches:  70%|████████████████████████████████████████████████████████████████████████████████████████████████                                         | 1049/1496 [1:03:38<22:13,  2.98s/it][A
Sampling news batches:  70%|████████████████████████████████████████████████████████████████████████████████████████████████▏                                        | 1050/1496 [1:03:39<18:18,  2.46s/it][A
Sampling news batches:  70%|████████████████████████████████████████████████████████████████████████████████████████████████▏                                        | 1051/1496 [1:03:41<17:07,  2.31s/it][A
Sampling news batches:  70%|████████████████████████████████████████████████████████████████████████████████████████████████▎                                        | 1052/1496 [1:03:43<17:26,  2.36s/it][A
Sampling news batches:  70%|████████████████████████████████████████████████████████████████████████████████████████████████▍                                        | 1053/1496 [1:03:46<18:51,  2.55s/it][A
Sampling news batches:  70%|████████████████████████████████████████████████████████████████████████████████████████████████▌                                        | 1054/1496 [1:03:49<18:26,  2.50s/it][A
Sampling news batches:  71%|████████████████████████████████████████████████████████████████████████████████████████████████▌                                        | 1055/1496 [1:03:51<17:28,  2.38s/it][A
Sampling news batches:  71%|████████████████████████████████████████████████████████████████████████████████████████████████▋                                        | 1056/1496 [1:03:52<15:37,  2.13s/it][A
Sampling news batches:  71%|████████████████████████████████████████████████████████████████████████████████████████████████▊                                        | 1057/1496 [1:03:54<14:59,  2.05s/it][A
Sampling news batches:  71%|████████████████████████████████████████████████████████████████████████████████████████████████▉                                        | 1058/1496 [1:03:57<15:50,  2.17s/it][A
Sampling news batches:  71%|████████████████████████████████████████████████████████████████████████████████████████████████▉                                        | 1059/1496 [1:03:59<16:04,  2.21s/it][A
Sampling news batches:  71%|█████████████████████████████████████████████████████████████████████████████████████████████████                                        | 1060/1496 [1:04:01<15:53,  2.19s/it][A
Sampling news batches:  71%|█████████████████████████████████████████████████████████████████████████████████████████████████▏                                       | 1061/1496 [1:04:02<13:42,  1.89s/it][A
Sampling news batches:  71%|█████████████████████████████████████████████████████████████████████████████████████████████████▎                                       | 1062/1496 [1:04:05<16:06,  2.23s/it][A
Sampling news batches:  71%|█████████████████████████████████████████████████████████████████████████████████████████████████▎                                       | 1063/1496 [1:04:07<14:35,  2.02s/it][A
Sampling news batches:  71%|█████████████████████████████████████████████████████████████████████████████████████████████████▍                                       | 1064/1496 [1:04:09<14:04,  1.95s/it][A
Sampling news batches:  71%|█████████████████████████████████████████████████████████████████████████████████████████████████▌                                       | 1065/1496 [1:04:10<13:42,  1.91s/it][A
Sampling news batches:  71%|█████████████████████████████████████████████████████████████████████████████████████████████████▌                                       | 1066/1496 [1:04:12<12:20,  1.72s/it][A
Sampling news batches:  71%|█████████████████████████████████████████████████████████████████████████████████████████████████▋                                       | 1067/1496 [1:04:13<11:41,  1.63s/it][A
Sampling news batches:  71%|█████████████████████████████████████████████████████████████████████████████████████████████████▊                                       | 1068/1496 [1:04:15<11:15,  1.58s/it][A
Sampling news batches:  71%|█████████████████████████████████████████████████████████████████████████████████████████████████▉                                       | 1069/1496 [1:04:17<13:22,  1.88s/it][A
Sampling news batches:  72%|█████████████████████████████████████████████████████████████████████████████████████████████████▉                                       | 1070/1496 [1:04:20<14:53,  2.10s/it][A
Sampling news batches:  72%|██████████████████████████████████████████████████████████████████████████████████████████████████                                       | 1071/1496 [1:04:21<13:47,  1.95s/it][A
Sampling news batches:  72%|██████████████████████████████████████████████████████████████████████████████████████████████████▏                                      | 1072/1496 [1:04:24<16:15,  2.30s/it][A
Sampling news batches:  72%|██████████████████████████████████████████████████████████████████████████████████████████████████▎                                      | 1073/1496 [1:04:26<15:10,  2.15s/it][A
Sampling news batches:  72%|██████████████████████████████████████████████████████████████████████████████████████████████████▎                                      | 1074/1496 [1:04:28<14:54,  2.12s/it][A
Sampling news batches:  72%|██████████████████████████████████████████████████████████████████████████████████████████████████▍                                      | 1075/1496 [1:04:30<12:58,  1.85s/it][A
Sampling news batches:  72%|██████████████████████████████████████████████████████████████████████████████████████████████████▌                                      | 1076/1496 [1:04:31<12:59,  1.86s/it][A
Sampling news batches:  72%|██████████████████████████████████████████████████████████████████████████████████████████████████▋                                      | 1077/1496 [1:04:34<15:30,  2.22s/it][A
Sampling news batches:  72%|██████████████████████████████████████████████████████████████████████████████████████████████████▋                                      | 1078/1496 [1:04:36<13:36,  1.95s/it][A
Sampling news batches:  72%|██████████████████████████████████████████████████████████████████████████████████████████████████▊                                      | 1079/1496 [1:04:37<12:22,  1.78s/it][A
Sampling news batches:  72%|██████████████████████████████████████████████████████████████████████████████████████████████████▉                                      | 1080/1496 [1:04:43<20:31,  2.96s/it][A{'grad': 4.330918312072754, 'context_loss': 7.706869006156921, 'stance_loss': nan, 'news_loss': 0.7249147395292918}


Validating rep learning:   0%|                                                                                                                                                    | 0/2211 [00:00<?, ?it/s][A[A

Validating rep learning:   8%|███████████▏                                                                                                                            | 181/2211 [00:00<00:01, 1804.26it/s][A[A

Validating rep learning:  16%|██████████████████████▎                                                                                                                 | 363/2211 [00:00<00:01, 1808.65it/s][A[A

Validating rep learning:  25%|█████████████████████████████████▋                                                                                                      | 548/2211 [00:00<00:00, 1820.55it/s][A[A

Validating rep learning:  34%|█████████████████████████████████████████████▊                                                                                          | 744/2211 [00:00<00:00, 1857.87it/s][A[A

Validating rep learning:  42%|█████████████████████████████████████████████████████████▎                                                                              | 931/2211 [00:00<00:00, 1859.82it/s][A[A

Validating rep learning:  51%|████████████████████████████████████████████████████████████████████▎                                                                  | 1118/2211 [00:00<00:00, 1860.36it/s][A[A

Validating rep learning:  59%|███████████████████████████████████████████████████████████████████████████████▍                                                       | 1300/2211 [00:00<00:00, 1845.01it/s][A[A

Validating rep learning:  67%|██████████████████████████████████████████████████████████████████████████████████████████▍                                            | 1481/2211 [00:00<00:00, 1833.67it/s][A[A

Validating rep learning:  75%|█████████████████████████████████████████████████████████████████████████████████████████████████████▌                                 | 1663/2211 [00:00<00:00, 1826.96it/s][A[A

Validating rep learning:  83%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████▋                      | 1845/2211 [00:01<00:00, 1823.33it/s][A[A

Validating rep learning:  92%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▊           | 2027/2211 [00:01<00:00, 1821.69it/s][A[A

Validating rep learning: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▉| 2209/2211 [00:01<00:00, 1820.54it/s][A[AValidating rep learning: 100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 2211/2211 [00:01<00:00, 1835.14it/s]
{'stance_avg_closed_ratio': 0.8993171268579552, 'stance_avg_far_ratio': 0.8975543634180767, 'other_avg_closed_ratio': 0.6137570370044966, 'other_avg_far_ratio': 0.0}

Sampling news batches:  72%|█████████████████████████████████████████████████████████████████████████████████████████████████▌                                     | 1081/1496 [1:05:44<2:21:29, 20.46s/it][A
Sampling news batches:  72%|█████████████████████████████████████████████████████████████████████████████████████████████████▋                                     | 1082/1496 [1:05:45<1:40:42, 14.59s/it][A
Sampling news batches:  72%|█████████████████████████████████████████████████████████████████████████████████████████████████▋                                     | 1083/1496 [1:05:48<1:15:58, 11.04s/it][A
Sampling news batches:  72%|███████████████████████████████████████████████████████████████████████████████████████████████████▎                                     | 1084/1496 [1:05:49<55:49,  8.13s/it][A
Sampling news batches:  73%|███████████████████████████████████████████████████████████████████████████████████████████████████▎                                     | 1085/1496 [1:05:50<41:28,  6.05s/it][A
Sampling news batches:  73%|███████████████████████████████████████████████████████████████████████████████████████████████████▍                                     | 1086/1496 [1:05:53<33:39,  4.92s/it][A
Sampling news batches:  73%|███████████████████████████████████████████████████████████████████████████████████████████████████▌                                     | 1087/1496 [1:05:55<28:26,  4.17s/it][A
Sampling news batches:  73%|███████████████████████████████████████████████████████████████████████████████████████████████████▋                                     | 1088/1496 [1:05:57<23:22,  3.44s/it][A
Sampling news batches:  73%|███████████████████████████████████████████████████████████████████████████████████████████████████▋                                     | 1089/1496 [1:05:59<21:47,  3.21s/it][A
Sampling news batches:  73%|███████████████████████████████████████████████████████████████████████████████████████████████████▊                                     | 1090/1496 [1:06:02<19:44,  2.92s/it][A
Sampling news batches:  73%|███████████████████████████████████████████████████████████████████████████████████████████████████▉                                     | 1091/1496 [1:06:03<17:21,  2.57s/it][A
Sampling news batches:  73%|████████████████████████████████████████████████████████████████████████████████████████████████████                                     | 1092/1496 [1:06:04<13:44,  2.04s/it][A
Sampling news batches:  73%|████████████████████████████████████████████████████████████████████████████████████████████████████                                     | 1093/1496 [1:06:06<13:20,  1.99s/it][A
Sampling news batches:  73%|████████████████████████████████████████████████████████████████████████████████████████████████████▏                                    | 1094/1496 [1:06:09<15:21,  2.29s/it][A
Sampling news batches:  73%|████████████████████████████████████████████████████████████████████████████████████████████████████▎                                    | 1095/1496 [1:06:12<16:36,  2.49s/it][A
Sampling news batches:  73%|████████████████████████████████████████████████████████████████████████████████████████████████████▎                                    | 1096/1496 [1:06:13<14:01,  2.10s/it][A
Sampling news batches:  73%|████████████████████████████████████████████████████████████████████████████████████████████████████▍                                    | 1097/1496 [1:06:19<22:04,  3.32s/it][A
Sampling news batches:  73%|████████████████████████████████████████████████████████████████████████████████████████████████████▌                                    | 1098/1496 [1:06:22<20:04,  3.03s/it][A
Sampling news batches:  73%|████████████████████████████████████████████████████████████████████████████████████████████████████▋                                    | 1099/1496 [1:06:24<18:23,  2.78s/it][A
Sampling news batches:  74%|████████████████████████████████████████████████████████████████████████████████████████████████████▋                                    | 1100/1496 [1:06:26<17:39,  2.68s/it][A
Sampling news batches:  74%|████████████████████████████████████████████████████████████████████████████████████████████████████▊                                    | 1101/1496 [1:06:27<14:21,  2.18s/it][A
Sampling news batches:  74%|████████████████████████████████████████████████████████████████████████████████████████████████████▉                                    | 1102/1496 [1:06:28<12:01,  1.83s/it][A
Sampling news batches:  74%|█████████████████████████████████████████████████████████████████████████████████████████████████████                                    | 1103/1496 [1:06:32<14:24,  2.20s/it][A
Sampling news batches:  74%|█████████████████████████████████████████████████████████████████████████████████████████████████████                                    | 1104/1496 [1:06:34<14:03,  2.15s/it][A
Sampling news batches:  74%|█████████████████████████████████████████████████████████████████████████████████████████████████████▏                                   | 1105/1496 [1:06:35<12:13,  1.88s/it][A
Sampling news batches:  74%|█████████████████████████████████████████████████████████████████████████████████████████████████████▎                                   | 1106/1496 [1:06:37<12:27,  1.92s/it][A
Sampling news batches:  74%|█████████████████████████████████████████████████████████████████████████████████████████████████████▍                                   | 1107/1496 [1:06:39<12:19,  1.90s/it][A
Sampling news batches:  74%|█████████████████████████████████████████████████████████████████████████████████████████████████████▍                                   | 1108/1496 [1:06:39<10:02,  1.55s/it][A
Sampling news batches:  74%|█████████████████████████████████████████████████████████████████████████████████████████████████████▌                                   | 1109/1496 [1:06:41<10:15,  1.59s/it][A
Sampling news batches:  74%|█████████████████████████████████████████████████████████████████████████████████████████████████████▋                                   | 1110/1496 [1:06:43<10:22,  1.61s/it][A
Sampling news batches:  74%|█████████████████████████████████████████████████████████████████████████████████████████████████████▋                                   | 1111/1496 [1:06:44<09:44,  1.52s/it][A
Sampling news batches:  74%|█████████████████████████████████████████████████████████████████████████████████████████████████████▊                                   | 1112/1496 [1:06:46<10:42,  1.67s/it][A
Sampling news batches:  74%|█████████████████████████████████████████████████████████████████████████████████████████████████████▉                                   | 1113/1496 [1:06:48<11:53,  1.86s/it][A
Sampling news batches:  74%|██████████████████████████████████████████████████████████████████████████████████████████████████████                                   | 1114/1496 [1:06:50<11:20,  1.78s/it][A
Sampling news batches:  75%|██████████████████████████████████████████████████████████████████████████████████████████████████████                                   | 1115/1496 [1:06:51<09:49,  1.55s/it][A
Sampling news batches:  75%|██████████████████████████████████████████████████████████████████████████████████████████████████████▏                                  | 1116/1496 [1:06:53<11:24,  1.80s/it][A
Sampling news batches:  75%|██████████████████████████████████████████████████████████████████████████████████████████████████████▎                                  | 1117/1496 [1:06:55<10:35,  1.68s/it][A
Sampling news batches:  75%|██████████████████████████████████████████████████████████████████████████████████████████████████████▍                                  | 1118/1496 [1:06:57<11:23,  1.81s/it][A
Sampling news batches:  75%|██████████████████████████████████████████████████████████████████████████████████████████████████████▍                                  | 1119/1496 [1:07:00<14:26,  2.30s/it][A
Sampling news batches:  75%|██████████████████████████████████████████████████████████████████████████████████████████████████████▌                                  | 1120/1496 [1:07:03<15:06,  2.41s/it][A{'grad': 3.6719000935554504, 'context_loss': 7.6645984768867494, 'stance_loss': nan, 'news_loss': 0.6225703954696655}


Validating rep learning:   0%|                                                                                                                                                    | 0/2211 [00:00<?, ?it/s][A[A

Validating rep learning:   8%|███████████                                                                                                                             | 179/2211 [00:00<00:01, 1785.69it/s][A[A

Validating rep learning:  18%|███████████████████████▉                                                                                                                | 390/2211 [00:00<00:00, 1869.65it/s][A[A

Validating rep learning:  26%|███████████████████████████████████▎                                                                                                    | 575/2211 [00:00<00:00, 1863.11it/s][A[A

Validating rep learning:  35%|███████████████████████████████████████████████▎                                                                                        | 769/2211 [00:00<00:00, 1883.91it/s][A[A

Validating rep learning:  43%|██████████████████████████████████████████████████████████▌                                                                             | 953/2211 [00:00<00:00, 1869.36it/s][A[A

Validating rep learning:  51%|█████████████████████████████████████████████████████████████████████▍                                                                 | 1137/2211 [00:00<00:00, 1860.12it/s][A[A

Validating rep learning:  60%|████████████████████████████████████████████████████████████████████████████████▍                                                      | 1317/2211 [00:00<00:00, 1840.69it/s][A[A

Validating rep learning:  68%|███████████████████████████████████████████████████████████████████████████████████████████▍                                           | 1497/2211 [00:00<00:00, 1828.17it/s][A[A

Validating rep learning:  76%|██████████████████████████████████████████████████████████████████████████████████████████████████████▍                                | 1678/2211 [00:00<00:00, 1819.80it/s][A[A

Validating rep learning:  84%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████▌                     | 1859/2211 [00:01<00:00, 1815.32it/s][A[A

Validating rep learning:  92%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▌          | 2040/2211 [00:01<00:00, 1811.92it/s][A[AValidating rep learning: 100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 2211/2211 [00:01<00:00, 1846.19it/s]
{'stance_avg_closed_ratio': 0.902823015508712, 'stance_avg_far_ratio': 0.9154952669320907, 'other_avg_closed_ratio': 0.5728385969150661, 'other_avg_far_ratio': 0.0}

Sampling news batches:  75%|█████████████████████████████████████████████████████████████████████████████████████████████████████▏                                 | 1121/1496 [1:08:09<2:13:58, 21.43s/it][A
Sampling news batches:  75%|█████████████████████████████████████████████████████████████████████████████████████████████████████▎                                 | 1122/1496 [1:08:10<1:35:39, 15.35s/it][A
Sampling news batches:  75%|█████████████████████████████████████████████████████████████████████████████████████████████████████▎                                 | 1123/1496 [1:08:12<1:11:23, 11.48s/it][A
Sampling news batches:  75%|██████████████████████████████████████████████████████████████████████████████████████████████████████▉                                  | 1124/1496 [1:08:15<54:23,  8.77s/it][A
Sampling news batches:  75%|███████████████████████████████████████████████████████████████████████████████████████████████████████                                  | 1125/1496 [1:08:19<45:38,  7.38s/it][A
Sampling news batches:  75%|███████████████████████████████████████████████████████████████████████████████████████████████████████                                  | 1126/1496 [1:08:21<35:12,  5.71s/it][A
Sampling news batches:  75%|███████████████████████████████████████████████████████████████████████████████████████████████████████▏                                 | 1127/1496 [1:08:23<28:53,  4.70s/it][A
Sampling news batches:  75%|███████████████████████████████████████████████████████████████████████████████████████████████████████▎                                 | 1128/1496 [1:08:25<24:06,  3.93s/it][A
Sampling news batches:  75%|███████████████████████████████████████████████████████████████████████████████████████████████████████▍                                 | 1129/1496 [1:08:30<24:36,  4.02s/it][A
Sampling news batches:  76%|███████████████████████████████████████████████████████████████████████████████████████████████████████▍                                 | 1130/1496 [1:08:32<21:46,  3.57s/it][A
Sampling news batches:  76%|███████████████████████████████████████████████████████████████████████████████████████████████████████▌                                 | 1131/1496 [1:08:35<20:28,  3.37s/it][A
Sampling news batches:  76%|███████████████████████████████████████████████████████████████████████████████████████████████████████▋                                 | 1132/1496 [1:08:38<20:42,  3.41s/it][A
Sampling news batches:  76%|███████████████████████████████████████████████████████████████████████████████████████████████████████▊                                 | 1133/1496 [1:08:42<21:00,  3.47s/it][A
Sampling news batches:  76%|███████████████████████████████████████████████████████████████████████████████████████████████████████▊                                 | 1134/1496 [1:08:43<16:40,  2.76s/it][A
Sampling news batches:  76%|███████████████████████████████████████████████████████████████████████████████████████████████████████▉                                 | 1135/1496 [1:08:45<15:03,  2.50s/it][A
Sampling news batches:  76%|████████████████████████████████████████████████████████████████████████████████████████████████████████                                 | 1136/1496 [1:08:47<13:21,  2.23s/it][A
Sampling news batches:  76%|████████████████████████████████████████████████████████████████████████████████████████████████████████                                 | 1137/1496 [1:08:49<13:01,  2.18s/it][A
Sampling news batches:  76%|████████████████████████████████████████████████████████████████████████████████████████████████████████▏                                | 1138/1496 [1:08:50<11:40,  1.96s/it][A
Sampling news batches:  76%|████████████████████████████████████████████████████████████████████████████████████████████████████████▎                                | 1139/1496 [1:08:52<11:55,  2.00s/it][A
Sampling news batches:  76%|████████████████████████████████████████████████████████████████████████████████████████████████████████▍                                | 1140/1496 [1:08:54<11:04,  1.87s/it][A
Sampling news batches:  76%|████████████████████████████████████████████████████████████████████████████████████████████████████████▍                                | 1141/1496 [1:08:55<10:39,  1.80s/it][A
Sampling news batches:  76%|████████████████████████████████████████████████████████████████████████████████████████████████████████▌                                | 1142/1496 [1:08:58<11:52,  2.01s/it][A
Sampling news batches:  76%|████████████████████████████████████████████████████████████████████████████████████████████████████████▋                                | 1143/1496 [1:09:03<17:37,  3.00s/it][A
Sampling news batches:  76%|████████████████████████████████████████████████████████████████████████████████████████████████████████▊                                | 1144/1496 [1:09:06<17:55,  3.05s/it][A
Sampling news batches:  77%|████████████████████████████████████████████████████████████████████████████████████████████████████████▊                                | 1145/1496 [1:09:08<14:50,  2.54s/it][A
Sampling news batches:  77%|████████████████████████████████████████████████████████████████████████████████████████████████████████▉                                | 1146/1496 [1:09:11<15:12,  2.61s/it][A
Sampling news batches:  77%|█████████████████████████████████████████████████████████████████████████████████████████████████████████                                | 1147/1496 [1:09:13<14:08,  2.43s/it][A
Sampling news batches:  77%|█████████████████████████████████████████████████████████████████████████████████████████████████████████▏                               | 1148/1496 [1:09:15<13:43,  2.37s/it][A
Sampling news batches:  77%|█████████████████████████████████████████████████████████████████████████████████████████████████████████▏                               | 1149/1496 [1:09:17<14:11,  2.45s/it][A
Sampling news batches:  77%|█████████████████████████████████████████████████████████████████████████████████████████████████████████▎                               | 1150/1496 [1:09:19<11:57,  2.07s/it][A
Sampling news batches:  77%|█████████████████████████████████████████████████████████████████████████████████████████████████████████▍                               | 1151/1496 [1:09:20<10:39,  1.85s/it][A
Sampling news batches:  77%|█████████████████████████████████████████████████████████████████████████████████████████████████████████▍                               | 1152/1496 [1:09:21<09:59,  1.74s/it][A
Sampling news batches:  77%|█████████████████████████████████████████████████████████████████████████████████████████████████████████▌                               | 1153/1496 [1:09:23<09:45,  1.71s/it][A
Sampling news batches:  77%|█████████████████████████████████████████████████████████████████████████████████████████████████████████▋                               | 1154/1496 [1:09:24<08:47,  1.54s/it][A
Sampling news batches:  77%|█████████████████████████████████████████████████████████████████████████████████████████████████████████▊                               | 1155/1496 [1:09:26<08:49,  1.55s/it][A
Sampling news batches:  77%|█████████████████████████████████████████████████████████████████████████████████████████████████████████▊                               | 1156/1496 [1:09:28<09:12,  1.63s/it][A
Sampling news batches:  77%|█████████████████████████████████████████████████████████████████████████████████████████████████████████▉                               | 1157/1496 [1:09:29<09:30,  1.68s/it][A
Sampling news batches:  77%|██████████████████████████████████████████████████████████████████████████████████████████████████████████                               | 1158/1496 [1:09:31<09:54,  1.76s/it][A
Sampling news batches:  77%|██████████████████████████████████████████████████████████████████████████████████████████████████████████▏                              | 1159/1496 [1:09:34<10:58,  1.95s/it][A
Sampling news batches:  78%|██████████████████████████████████████████████████████████████████████████████████████████████████████████▏                              | 1160/1496 [1:09:37<12:41,  2.27s/it][A{'grad': 6.000601291656494, 'context_loss': 7.672711420059204, 'stance_loss': nan, 'news_loss': 0.7409939765930176}


Validating rep learning:   0%|                                                                                                                                                    | 0/2211 [00:00<?, ?it/s][A[A

Validating rep learning:   8%|███████████▏                                                                                                                            | 182/2211 [00:00<00:01, 1810.54it/s][A[A

Validating rep learning:  18%|████████████████████████▎                                                                                                               | 395/2211 [00:00<00:00, 1894.39it/s][A[A

Validating rep learning:  26%|███████████████████████████████████▉                                                                                                    | 584/2211 [00:00<00:00, 1892.65it/s][A[A

Validating rep learning:  35%|████████████████████████████████████████████████                                                                                        | 782/2211 [00:00<00:00, 1916.15it/s][A[A

Validating rep learning:  44%|███████████████████████████████████████████████████████████▌                                                                            | 969/2211 [00:00<00:00, 1900.75it/s][A[A

Validating rep learning:  52%|██████████████████████████████████████████████████████████████████████▋                                                                | 1157/2211 [00:00<00:00, 1893.97it/s][A[A

Validating rep learning:  61%|█████████████████████████████████████████████████████████████████████████████████▉                                                     | 1341/2211 [00:00<00:00, 1877.33it/s][A[A

Validating rep learning:  69%|█████████████████████████████████████████████████████████████████████████████████████████████▏                                         | 1526/2211 [00:00<00:00, 1867.00it/s][A[A

Validating rep learning:  77%|████████████████████████████████████████████████████████████████████████████████████████████████████████▍                              | 1711/2211 [00:00<00:00, 1861.13it/s][A[A

Validating rep learning:  86%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████▋                   | 1895/2211 [00:01<00:00, 1852.14it/s][A[A

Validating rep learning:  94%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████        | 2081/2211 [00:01<00:00, 1852.31it/s][A[AValidating rep learning: 100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 2211/2211 [00:01<00:00, 1883.84it/s]
{'stance_avg_closed_ratio': 0.8699025952452208, 'stance_avg_far_ratio': 0.8918566942736205, 'other_avg_closed_ratio': 0.5661678145436848, 'other_avg_far_ratio': 0.0}

Sampling news batches:  78%|████████████████████████████████████████████████████████████████████████████████████████████████████████▊                              | 1161/1496 [1:10:41<1:55:47, 20.74s/it][A
Sampling news batches:  78%|████████████████████████████████████████████████████████████████████████████████████████████████████████▊                              | 1162/1496 [1:10:43<1:24:24, 15.16s/it][A
Sampling news batches:  78%|████████████████████████████████████████████████████████████████████████████████████████████████████████▉                              | 1163/1496 [1:10:45<1:03:10, 11.38s/it][A
Sampling news batches:  78%|██████████████████████████████████████████████████████████████████████████████████████████████████████████▌                              | 1164/1496 [1:10:48<48:16,  8.72s/it][A
Sampling news batches:  78%|██████████████████████████████████████████████████████████████████████████████████████████████████████████▋                              | 1165/1496 [1:10:49<36:17,  6.58s/it][A
Sampling news batches:  78%|██████████████████████████████████████████████████████████████████████████████████████████████████████████▊                              | 1166/1496 [1:10:51<28:16,  5.14s/it][A
Sampling news batches:  78%|██████████████████████████████████████████████████████████████████████████████████████████████████████████▊                              | 1167/1496 [1:10:54<23:32,  4.29s/it][A
Sampling news batches:  78%|██████████████████████████████████████████████████████████████████████████████████████████████████████████▉                              | 1168/1496 [1:10:55<19:28,  3.56s/it][A
Sampling news batches:  78%|███████████████████████████████████████████████████████████████████████████████████████████████████████████                              | 1169/1496 [1:10:58<18:24,  3.38s/it][A
Sampling news batches:  78%|███████████████████████████████████████████████████████████████████████████████████████████████████████████▏                             | 1170/1496 [1:11:00<15:47,  2.91s/it][A
Sampling news batches:  78%|███████████████████████████████████████████████████████████████████████████████████████████████████████████▏                             | 1171/1496 [1:11:01<13:11,  2.43s/it][A
Sampling news batches:  78%|███████████████████████████████████████████████████████████████████████████████████████████████████████████▎                             | 1172/1496 [1:11:03<11:33,  2.14s/it][A
Sampling news batches:  78%|███████████████████████████████████████████████████████████████████████████████████████████████████████████▍                             | 1173/1496 [1:11:06<12:16,  2.28s/it][A
Sampling news batches:  78%|███████████████████████████████████████████████████████████████████████████████████████████████████████████▌                             | 1174/1496 [1:11:06<09:51,  1.84s/it][A
Sampling news batches:  79%|███████████████████████████████████████████████████████████████████████████████████████████████████████████▌                             | 1175/1496 [1:11:08<09:56,  1.86s/it][A
Sampling news batches:  79%|███████████████████████████████████████████████████████████████████████████████████████████████████████████▋                             | 1176/1496 [1:11:10<09:41,  1.82s/it][A
Sampling news batches:  79%|███████████████████████████████████████████████████████████████████████████████████████████████████████████▊                             | 1177/1496 [1:11:11<08:34,  1.61s/it][A
Sampling news batches:  79%|███████████████████████████████████████████████████████████████████████████████████████████████████████████▉                             | 1178/1496 [1:11:13<08:42,  1.64s/it][A
Sampling news batches:  79%|███████████████████████████████████████████████████████████████████████████████████████████████████████████▉                             | 1179/1496 [1:11:14<08:00,  1.52s/it][A
Sampling news batches:  79%|████████████████████████████████████████████████████████████████████████████████████████████████████████████                             | 1180/1496 [1:11:15<07:51,  1.49s/it][A
Sampling news batches:  79%|████████████████████████████████████████████████████████████████████████████████████████████████████████████▏                            | 1181/1496 [1:11:18<08:55,  1.70s/it][A
Sampling news batches:  79%|████████████████████████████████████████████████████████████████████████████████████████████████████████████▏                            | 1182/1496 [1:11:20<10:30,  2.01s/it][A
Sampling news batches:  79%|████████████████████████████████████████████████████████████████████████████████████████████████████████████▎                            | 1183/1496 [1:11:22<09:38,  1.85s/it][A
Sampling news batches:  79%|████████████████████████████████████████████████████████████████████████████████████████████████████████████▍                            | 1184/1496 [1:11:24<09:37,  1.85s/it][A
Sampling news batches:  79%|████████████████████████████████████████████████████████████████████████████████████████████████████████████▌                            | 1185/1496 [1:11:25<09:13,  1.78s/it][A
Sampling news batches:  79%|████████████████████████████████████████████████████████████████████████████████████████████████████████████▌                            | 1186/1496 [1:11:26<07:56,  1.54s/it][A
Sampling news batches:  79%|████████████████████████████████████████████████████████████████████████████████████████████████████████████▋                            | 1187/1496 [1:11:29<08:57,  1.74s/it][A
Sampling news batches:  79%|████████████████████████████████████████████████████████████████████████████████████████████████████████████▊                            | 1188/1496 [1:11:30<09:06,  1.77s/it][A
Sampling news batches:  79%|████████████████████████████████████████████████████████████████████████████████████████████████████████████▉                            | 1189/1496 [1:11:32<08:26,  1.65s/it][A
Sampling news batches:  80%|████████████████████████████████████████████████████████████████████████████████████████████████████████████▉                            | 1190/1496 [1:11:36<12:51,  2.52s/it][A
Sampling news batches:  80%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████                            | 1191/1496 [1:11:38<11:56,  2.35s/it][A
Sampling news batches:  80%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████▏                           | 1192/1496 [1:11:40<10:48,  2.13s/it][A
Sampling news batches:  80%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████▎                           | 1193/1496 [1:11:41<09:24,  1.86s/it][A
Sampling news batches:  80%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████▎                           | 1194/1496 [1:11:51<21:27,  4.26s/it][A
Sampling news batches:  80%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████▍                           | 1195/1496 [1:11:53<17:20,  3.46s/it][A
Sampling news batches:  80%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████▌                           | 1196/1496 [1:11:54<14:50,  2.97s/it][A
Sampling news batches:  80%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████▌                           | 1197/1496 [1:11:55<11:48,  2.37s/it][A
Sampling news batches:  80%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████▋                           | 1198/1496 [1:11:56<09:00,  1.81s/it][A
Sampling news batches:  80%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████▊                           | 1199/1496 [1:11:57<07:56,  1.60s/it][A
Sampling news batches:  80%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████▉                           | 1200/1496 [1:11:59<08:05,  1.64s/it][A{'grad': 3.9258424043655396, 'context_loss': 7.690496444702148, 'stance_loss': nan, 'news_loss': 0.9491365551948547}


Validating rep learning:   0%|                                                                                                                                                    | 0/2211 [00:00<?, ?it/s][A[A

Validating rep learning:   8%|███████████                                                                                                                             | 180/2211 [00:00<00:01, 1796.28it/s][A[A

Validating rep learning:  18%|████████████████████████                                                                                                                | 391/2211 [00:00<00:00, 1878.18it/s][A[A

Validating rep learning:  26%|███████████████████████████████████▍                                                                                                    | 576/2211 [00:00<00:00, 1868.81it/s][A[A

Validating rep learning:  35%|███████████████████████████████████████████████▌                                                                                        | 773/2211 [00:00<00:00, 1895.86it/s][A[A

Validating rep learning:  43%|███████████████████████████████████████████████████████████                                                                             | 961/2211 [00:00<00:00, 1889.35it/s][A[A

Validating rep learning:  52%|██████████████████████████████████████████████████████████████████████                                                                 | 1148/2211 [00:00<00:00, 1883.08it/s][A[A

Validating rep learning:  60%|█████████████████████████████████████████████████████████████████████████████████▎                                                     | 1331/2211 [00:00<00:00, 1864.06it/s][A[A

Validating rep learning:  69%|████████████████████████████████████████████████████████████████████████████████████████████▌                                          | 1515/2211 [00:00<00:00, 1855.62it/s][A[A

Validating rep learning:  77%|███████████████████████████████████████████████████████████████████████████████████████████████████████▊                               | 1700/2211 [00:00<00:00, 1852.44it/s][A[A

Validating rep learning:  85%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████                    | 1884/2211 [00:01<00:00, 1847.88it/s][A[A

Validating rep learning:  93%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▏        | 2067/2211 [00:01<00:00, 1842.45it/s][A[AValidating rep learning: 100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 2211/2211 [00:01<00:00, 1871.60it/s]
{'stance_avg_closed_ratio': 0.9060870940162756, 'stance_avg_far_ratio': 0.9292560528088322, 'other_avg_closed_ratio': 0.5193003813070611, 'other_avg_far_ratio': 0.0}

Sampling news batches:  80%|████████████████████████████████████████████████████████████████████████████████████████████████████████████▍                          | 1201/1496 [1:13:01<1:36:55, 19.71s/it][A
Sampling news batches:  80%|████████████████████████████████████████████████████████████████████████████████████████████████████████████▍                          | 1202/1496 [1:13:04<1:12:25, 14.78s/it][A
Sampling news batches:  80%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████▏                          | 1203/1496 [1:13:06<53:47, 11.01s/it][A
Sampling news batches:  80%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████▎                          | 1204/1496 [1:13:07<39:31,  8.12s/it][A
Sampling news batches:  81%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████▎                          | 1205/1496 [1:13:10<31:10,  6.43s/it][A
Sampling news batches:  81%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████▍                          | 1206/1496 [1:13:12<25:28,  5.27s/it][A
Sampling news batches:  81%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████▌                          | 1207/1496 [1:13:15<20:46,  4.31s/it][A
Sampling news batches:  81%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████▋                          | 1208/1496 [1:13:17<18:21,  3.82s/it][A
Sampling news batches:  81%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████▋                          | 1209/1496 [1:13:19<15:14,  3.19s/it][A
Sampling news batches:  81%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████▊                          | 1210/1496 [1:13:21<12:53,  2.71s/it][A
Sampling news batches:  81%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████▉                          | 1211/1496 [1:13:22<10:43,  2.26s/it][A
Sampling news batches:  81%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████▉                          | 1212/1496 [1:13:23<09:52,  2.09s/it][A
Sampling news batches:  81%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████                          | 1213/1496 [1:13:26<09:59,  2.12s/it][A
Sampling news batches:  81%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████▏                         | 1214/1496 [1:13:32<15:36,  3.32s/it][A
Sampling news batches:  81%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████▎                         | 1215/1496 [1:13:33<12:41,  2.71s/it][A
Sampling news batches:  81%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████▎                         | 1216/1496 [1:13:34<10:00,  2.15s/it][A
Sampling news batches:  81%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████▍                         | 1217/1496 [1:13:36<10:06,  2.17s/it][A
Sampling news batches:  81%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████▌                         | 1218/1496 [1:13:38<10:15,  2.22s/it][A
Sampling news batches:  81%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████▋                         | 1219/1496 [1:13:41<10:29,  2.27s/it][A
Sampling news batches:  82%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████▋                         | 1220/1496 [1:13:42<09:23,  2.04s/it][A
Sampling news batches:  82%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████▊                         | 1221/1496 [1:13:45<09:56,  2.17s/it][A
Sampling news batches:  82%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████▉                         | 1222/1496 [1:13:47<09:48,  2.15s/it][A
Sampling news batches:  82%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████▉                         | 1223/1496 [1:13:49<09:31,  2.09s/it][A
Sampling news batches:  82%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████                         | 1224/1496 [1:13:50<08:48,  1.94s/it][A
Sampling news batches:  82%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████▏                        | 1225/1496 [1:13:51<07:33,  1.67s/it][A
Sampling news batches:  82%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████▎                        | 1226/1496 [1:13:54<09:16,  2.06s/it][A
Sampling news batches:  82%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████▎                        | 1227/1496 [1:13:57<09:19,  2.08s/it][A
Sampling news batches:  82%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████▍                        | 1228/1496 [1:13:59<09:21,  2.09s/it][A
Sampling news batches:  82%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████▌                        | 1229/1496 [1:14:00<08:17,  1.86s/it][A
Sampling news batches:  82%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████▋                        | 1230/1496 [1:14:04<10:25,  2.35s/it][A
Sampling news batches:  82%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████▋                        | 1231/1496 [1:14:05<08:37,  1.95s/it][A
Sampling news batches:  82%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████▊                        | 1232/1496 [1:14:08<10:07,  2.30s/it][A
Sampling news batches:  82%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████▉                        | 1233/1496 [1:14:12<13:01,  2.97s/it][A
Sampling news batches:  82%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████                        | 1234/1496 [1:14:15<12:47,  2.93s/it][A
Sampling news batches:  83%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████                        | 1235/1496 [1:14:17<10:54,  2.51s/it][A
Sampling news batches:  83%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████▏                       | 1236/1496 [1:14:19<10:19,  2.38s/it][A
Sampling news batches:  83%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████▎                       | 1237/1496 [1:14:20<09:25,  2.18s/it][A
Sampling news batches:  83%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████▎                       | 1238/1496 [1:14:21<07:39,  1.78s/it][A
Sampling news batches:  83%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████▍                       | 1239/1496 [1:14:23<07:17,  1.70s/it][A
Sampling news batches:  83%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████▌                       | 1240/1496 [1:14:25<08:13,  1.93s/it][A{'grad': 5.156241297721863, 'context_loss': 7.670644700527191, 'stance_loss': nan, 'news_loss': 0.718725343545278}


Validating rep learning:   0%|                                                                                                                                                    | 0/2211 [00:00<?, ?it/s][A[A

Validating rep learning:   8%|██████████▊                                                                                                                             | 176/2211 [00:00<00:01, 1758.70it/s][A[A

Validating rep learning:  17%|███████████████████████▎                                                                                                                | 378/2211 [00:00<00:01, 1829.30it/s][A[A

Validating rep learning:  26%|██████████████████████████████████▉                                                                                                     | 569/2211 [00:00<00:00, 1852.55it/s][A[A

Validating rep learning:  35%|███████████████████████████████████████████████▎                                                                                        | 769/2211 [00:00<00:00, 1894.00it/s][A[A

Validating rep learning:  43%|██████████████████████████████████████████████████████████▉                                                                             | 959/2211 [00:00<00:00, 1895.01it/s][A[A

Validating rep learning:  52%|██████████████████████████████████████████████████████████████████████                                                                 | 1148/2211 [00:00<00:00, 1891.19it/s][A[A

Validating rep learning:  60%|█████████████████████████████████████████████████████████████████████████████████▍                                                     | 1333/2211 [00:00<00:00, 1876.97it/s][A[A

Validating rep learning:  69%|████████████████████████████████████████████████████████████████████████████████████████████▋                                          | 1518/2211 [00:00<00:00, 1868.58it/s][A[A

Validating rep learning:  77%|███████████████████████████████████████████████████████████████████████████████████████████████████████▉                               | 1702/2211 [00:00<00:00, 1856.93it/s][A[A

Validating rep learning:  85%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████▏                   | 1887/2211 [00:01<00:00, 1852.71it/s][A[A

Validating rep learning:  94%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▍        | 2071/2211 [00:01<00:00, 1848.44it/s][A[AValidating rep learning: 100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 2211/2211 [00:01<00:00, 1876.79it/s]
{'stance_avg_closed_ratio': 0.8822689489661008, 'stance_avg_far_ratio': 0.8994355682481112, 'other_avg_closed_ratio': 0.5456844094986689, 'other_avg_far_ratio': 0.0}

Sampling news batches:  83%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████▉                       | 1241/1496 [1:15:31<1:30:05, 21.20s/it][A
Sampling news batches:  83%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████                       | 1242/1496 [1:15:34<1:05:46, 15.54s/it][A
Sampling news batches:  83%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████▊                       | 1243/1496 [1:15:35<47:46, 11.33s/it][A
Sampling news batches:  83%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████▉                       | 1244/1496 [1:15:38<37:18,  8.88s/it][A
Sampling news batches:  83%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████                       | 1245/1496 [1:15:41<28:53,  6.91s/it][A
Sampling news batches:  83%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████                       | 1246/1496 [1:15:43<23:25,  5.62s/it][A
Sampling news batches:  83%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████▏                      | 1247/1496 [1:15:45<18:03,  4.35s/it][A
Sampling news batches:  83%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████▎                      | 1248/1496 [1:15:47<15:01,  3.64s/it][A
Sampling news batches:  83%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████▍                      | 1249/1496 [1:15:49<13:17,  3.23s/it][A
Sampling news batches:  84%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████▍                      | 1250/1496 [1:15:53<14:01,  3.42s/it][A
Sampling news batches:  84%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████▌                      | 1251/1496 [1:15:55<12:00,  2.94s/it][A
Sampling news batches:  84%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████▋                      | 1252/1496 [1:15:56<10:30,  2.58s/it][A
Sampling news batches:  84%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████▋                      | 1253/1496 [1:15:59<10:49,  2.67s/it][A
Sampling news batches:  84%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████▊                      | 1254/1496 [1:16:00<09:00,  2.23s/it][A
Sampling news batches:  84%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████▉                      | 1255/1496 [1:16:02<07:37,  1.90s/it][A
Sampling news batches:  84%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████                      | 1256/1496 [1:16:03<06:39,  1.67s/it][A
Sampling news batches:  84%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████                      | 1257/1496 [1:16:05<07:49,  1.96s/it][A
Sampling news batches:  84%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████▏                     | 1258/1496 [1:16:07<07:03,  1.78s/it][A
Sampling news batches:  84%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████▎                     | 1259/1496 [1:16:08<07:02,  1.78s/it][A
Sampling news batches:  84%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████▍                     | 1260/1496 [1:16:11<07:34,  1.92s/it][A
Sampling news batches:  84%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████▍                     | 1261/1496 [1:16:12<06:50,  1.75s/it][A
Sampling news batches:  84%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████▌                     | 1262/1496 [1:16:14<06:51,  1.76s/it][A
Sampling news batches:  84%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████▋                     | 1263/1496 [1:16:15<06:13,  1.60s/it][A
Sampling news batches:  84%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████▊                     | 1264/1496 [1:16:16<05:58,  1.54s/it][A
Sampling news batches:  85%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████▊                     | 1265/1496 [1:16:19<06:38,  1.73s/it][A
Sampling news batches:  85%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████▉                     | 1266/1496 [1:16:22<07:56,  2.07s/it][A
Sampling news batches:  85%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████                     | 1267/1496 [1:16:24<07:54,  2.07s/it][A
Sampling news batches:  85%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████                     | 1268/1496 [1:16:25<07:04,  1.86s/it][A
Sampling news batches:  85%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▏                    | 1269/1496 [1:16:26<06:15,  1.65s/it][A
Sampling news batches:  85%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▎                    | 1270/1496 [1:16:32<11:33,  3.07s/it][A
Sampling news batches:  85%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▍                    | 1271/1496 [1:16:34<09:41,  2.59s/it][A
Sampling news batches:  85%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▍                    | 1272/1496 [1:16:37<10:05,  2.70s/it][A
Sampling news batches:  85%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▌                    | 1273/1496 [1:16:39<09:30,  2.56s/it][A
Sampling news batches:  85%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▋                    | 1274/1496 [1:16:41<08:31,  2.30s/it][A
Sampling news batches:  85%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▊                    | 1275/1496 [1:16:43<08:08,  2.21s/it][A
Sampling news batches:  85%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▊                    | 1276/1496 [1:16:44<06:58,  1.90s/it][A
Sampling news batches:  85%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▉                    | 1277/1496 [1:16:47<07:34,  2.08s/it][A
Sampling news batches:  85%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████                    | 1278/1496 [1:16:53<12:00,  3.30s/it][A
Sampling news batches:  85%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▏                   | 1279/1496 [1:16:55<10:59,  3.04s/it][A
Sampling news batches:  86%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▏                   | 1280/1496 [1:16:57<09:11,  2.55s/it][A{'grad': 5.288594841957092, 'context_loss': 7.678233122825622, 'stance_loss': 1.1799002771576246, 'news_loss': 0.691315084695816}


Validating rep learning:   0%|                                                                                                                                                    | 0/2211 [00:00<?, ?it/s][A[A

Validating rep learning:   8%|██████████▉                                                                                                                             | 177/2211 [00:00<00:01, 1766.36it/s][A[A

Validating rep learning:  18%|███████████████████████▉                                                                                                                | 389/2211 [00:00<00:00, 1857.94it/s][A[A

Validating rep learning:  26%|███████████████████████████████████▍                                                                                                    | 577/2211 [00:00<00:00, 1864.00it/s][A[A

Validating rep learning:  35%|███████████████████████████████████████████████▍                                                                                        | 772/2211 [00:00<00:00, 1886.88it/s][A[A

Validating rep learning:  43%|███████████████████████████████████████████████████████████                                                                             | 960/2211 [00:00<00:00, 1883.99it/s][A[A

Validating rep learning:  52%|█████████████████████████████████████████████████████████████████████▉                                                                 | 1146/2211 [00:00<00:00, 1874.06it/s][A[A

Validating rep learning:  60%|█████████████████████████████████████████████████████████████████████████████████                                                      | 1328/2211 [00:00<00:00, 1855.66it/s][A[A

Validating rep learning:  68%|████████████████████████████████████████████████████████████████████████████████████████████▏                                          | 1509/2211 [00:00<00:00, 1841.41it/s][A[A

Validating rep learning:  76%|███████████████████████████████████████████████████████████████████████████████████████████████████████▏                               | 1691/2211 [00:00<00:00, 1834.15it/s][A[A

Validating rep learning:  85%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████▎                    | 1872/2211 [00:01<00:00, 1826.19it/s][A[A

Validating rep learning:  93%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▍         | 2054/2211 [00:01<00:00, 1823.21it/s][A[AValidating rep learning: 100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 2211/2211 [00:01<00:00, 1859.24it/s]
{'stance_avg_closed_ratio': 0.8834023933430243, 'stance_avg_far_ratio': 0.8890949488746307, 'other_avg_closed_ratio': 0.5490820251607336, 'other_avg_far_ratio': 0.0}

Sampling news batches:  86%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████▌                   | 1281/1496 [1:18:09<1:24:05, 23.47s/it][A
Sampling news batches:  86%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████▋                   | 1282/1496 [1:18:11<1:01:06, 17.13s/it][A
Sampling news batches:  86%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▍                   | 1283/1496 [1:18:14<45:18, 12.76s/it][A
Sampling news batches:  86%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▌                   | 1284/1496 [1:18:15<33:25,  9.46s/it][A
Sampling news batches:  86%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▋                   | 1285/1496 [1:18:17<24:34,  6.99s/it][A
Sampling news batches:  86%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▊                   | 1286/1496 [1:18:18<18:34,  5.31s/it][A
Sampling news batches:  86%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▊                   | 1287/1496 [1:18:23<17:39,  5.07s/it][A
Sampling news batches:  86%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▉                   | 1288/1496 [1:18:24<13:58,  4.03s/it][A
Sampling news batches:  86%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████                   | 1289/1496 [1:18:25<10:10,  2.95s/it][A
Sampling news batches:  86%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▏                  | 1290/1496 [1:18:26<08:36,  2.51s/it][A
Sampling news batches:  86%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▏                  | 1291/1496 [1:18:27<07:09,  2.09s/it][A
Sampling news batches:  86%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▎                  | 1292/1496 [1:18:31<09:13,  2.71s/it][A
Sampling news batches:  86%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▍                  | 1293/1496 [1:18:32<07:31,  2.22s/it][A
Sampling news batches:  86%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▌                  | 1294/1496 [1:18:35<07:48,  2.32s/it][A
Sampling news batches:  87%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▌                  | 1295/1496 [1:18:37<07:16,  2.17s/it][A
Sampling news batches:  87%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▋                  | 1296/1496 [1:18:39<07:04,  2.12s/it][A
Sampling news batches:  87%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▊                  | 1297/1496 [1:18:40<06:28,  1.95s/it][A
Sampling news batches:  87%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▊                  | 1298/1496 [1:18:42<06:24,  1.94s/it][A
Sampling news batches:  87%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▉                  | 1299/1496 [1:18:44<05:57,  1.82s/it][A
Sampling news batches:  87%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████                  | 1300/1496 [1:18:46<06:23,  1.96s/it][A
Sampling news batches:  87%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▏                 | 1301/1496 [1:18:48<06:17,  1.94s/it][A
Sampling news batches:  87%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▏                 | 1302/1496 [1:18:49<05:42,  1.77s/it][A
Sampling news batches:  87%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▎                 | 1303/1496 [1:18:50<04:52,  1.52s/it][A
Sampling news batches:  87%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▍                 | 1304/1496 [1:18:52<05:19,  1.66s/it][A
Sampling news batches:  87%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▌                 | 1305/1496 [1:18:54<05:14,  1.64s/it][A
Sampling news batches:  87%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▌                 | 1306/1496 [1:18:55<04:46,  1.51s/it][A
Sampling news batches:  87%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▋                 | 1307/1496 [1:18:57<05:31,  1.75s/it][A
Sampling news batches:  87%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▊                 | 1308/1496 [1:18:59<05:36,  1.79s/it][A
Sampling news batches:  88%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▉                 | 1309/1496 [1:19:02<06:03,  1.95s/it][A
Sampling news batches:  88%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▉                 | 1310/1496 [1:19:04<06:42,  2.16s/it][A
Sampling news batches:  88%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████                 | 1311/1496 [1:19:07<06:59,  2.27s/it][A
Sampling news batches:  88%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▏                | 1312/1496 [1:19:09<06:39,  2.17s/it][A
Sampling news batches:  88%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▏                | 1313/1496 [1:19:11<06:22,  2.09s/it][A
Sampling news batches:  88%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▎                | 1314/1496 [1:19:13<06:54,  2.28s/it][A
Sampling news batches:  88%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▍                | 1315/1496 [1:19:15<06:03,  2.01s/it][A
Sampling news batches:  88%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▌                | 1316/1496 [1:19:16<05:01,  1.67s/it][A
Sampling news batches:  88%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▌                | 1317/1496 [1:19:19<06:06,  2.05s/it][A
Sampling news batches:  88%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▋                | 1318/1496 [1:19:19<05:03,  1.71s/it][A
Sampling news batches:  88%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▊                | 1319/1496 [1:19:21<04:46,  1.62s/it][A
Sampling news batches:  88%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▉                | 1320/1496 [1:19:23<05:04,  1.73s/it][A{'grad': 3.817632496356964, 'context_loss': 7.620949637889862, 'stance_loss': 1.0110851707203048, 'news_loss': 0.5960225462913513}


Validating rep learning:   0%|                                                                                                                                                    | 0/2211 [00:00<?, ?it/s][A[A

Validating rep learning:   8%|██████████▌                                                                                                                             | 171/2211 [00:00<00:01, 1703.88it/s][A[A

Validating rep learning:  16%|█████████████████████▏                                                                                                                  | 345/2211 [00:00<00:01, 1711.98it/s][A[A

Validating rep learning:  24%|████████████████████████████████▉                                                                                                       | 536/2211 [00:00<00:00, 1766.55it/s][A[A

Validating rep learning:  33%|█████████████████████████████████████████████▎                                                                                          | 736/2211 [00:00<00:00, 1829.79it/s][A[A

Validating rep learning:  42%|█████████████████████████████████████████████████████████                                                                               | 927/2211 [00:00<00:00, 1850.44it/s][A[A

Validating rep learning:  51%|████████████████████████████████████████████████████████████████████▏                                                                  | 1117/2211 [00:00<00:00, 1863.68it/s][A[A

Validating rep learning:  59%|███████████████████████████████████████████████████████████████████████████████▍                                                       | 1302/2211 [00:00<00:00, 1857.99it/s][A[A

Validating rep learning:  67%|██████████████████████████████████████████████████████████████████████████████████████████▊                                            | 1487/2211 [00:00<00:00, 1854.28it/s][A[A

Validating rep learning:  76%|██████████████████████████████████████████████████████████████████████████████████████████████████████▏                                | 1673/2211 [00:00<00:00, 1853.67it/s][A[A

Validating rep learning:  84%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████▌                     | 1859/2211 [00:01<00:00, 1854.37it/s][A[A

Validating rep learning:  92%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▊          | 2044/2211 [00:01<00:00, 1850.28it/s][A[AValidating rep learning: 100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 2211/2211 [00:01<00:00, 1851.45it/s]
{'stance_avg_closed_ratio': 0.9076152271905249, 'stance_avg_far_ratio': 0.9010716196863181, 'other_avg_closed_ratio': 0.4913356640964142, 'other_avg_far_ratio': 0.0}

Sampling news batches:  88%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▏               | 1321/1496 [1:20:41<1:11:36, 24.55s/it][A
Sampling news batches:  88%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████                | 1322/1496 [1:20:43<51:43, 17.84s/it][A
Sampling news batches:  88%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▏               | 1323/1496 [1:20:45<37:28, 13.00s/it][A
Sampling news batches:  89%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▏               | 1324/1496 [1:20:47<27:59,  9.76s/it][A
Sampling news batches:  89%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▎               | 1325/1496 [1:20:49<21:08,  7.42s/it][A
Sampling news batches:  89%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▍               | 1326/1496 [1:20:49<15:12,  5.37s/it][A
Sampling news batches:  89%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▌               | 1327/1496 [1:20:51<11:47,  4.19s/it][A
Sampling news batches:  89%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▌               | 1328/1496 [1:20:53<10:10,  3.63s/it][A
Sampling news batches:  89%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▋               | 1329/1496 [1:20:54<08:12,  2.95s/it][A
Sampling news batches:  89%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▊               | 1330/1496 [1:20:57<07:43,  2.79s/it][A
Sampling news batches:  89%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▉               | 1331/1496 [1:21:04<11:24,  4.15s/it][A
Sampling news batches:  89%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▉               | 1332/1496 [1:21:05<08:55,  3.27s/it][A
Sampling news batches:  89%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████               | 1333/1496 [1:21:08<08:05,  2.98s/it][A
Sampling news batches:  89%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▏              | 1334/1496 [1:21:10<07:18,  2.71s/it][A
Sampling news batches:  89%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▎              | 1335/1496 [1:21:12<06:40,  2.49s/it][A
Sampling news batches:  89%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▎              | 1336/1496 [1:21:13<05:38,  2.12s/it][A
Sampling news batches:  89%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▍              | 1337/1496 [1:21:15<05:23,  2.03s/it][A
Sampling news batches:  89%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▌              | 1338/1496 [1:21:16<04:29,  1.71s/it][A
Sampling news batches:  90%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▌              | 1339/1496 [1:21:18<05:02,  1.92s/it][A
Sampling news batches:  90%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▉              | 1340/1496 [1:23:18<1:36:42, 37.19s/it][A
Sampling news batches:  90%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████              | 1341/1496 [1:23:19<1:08:16, 26.43s/it][A
Sampling news batches:  90%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▉              | 1342/1496 [1:23:21<48:54, 19.06s/it][A
Sampling news batches:  90%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▉              | 1343/1496 [1:23:23<35:44, 14.02s/it][A
Sampling news batches:  90%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████              | 1344/1496 [1:23:25<25:59, 10.26s/it][A
Sampling news batches:  90%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▏             | 1345/1496 [1:23:26<18:49,  7.48s/it][A
Sampling news batches:  90%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▎             | 1346/1496 [1:23:27<13:57,  5.58s/it][A
Sampling news batches:  90%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▎             | 1347/1496 [1:23:28<10:36,  4.27s/it][A
Sampling news batches:  90%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▍             | 1348/1496 [1:23:30<08:38,  3.50s/it][A
Sampling news batches:  90%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▌             | 1349/1496 [1:23:32<07:55,  3.23s/it][A
Sampling news batches:  90%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▋             | 1350/1496 [1:23:35<07:19,  3.01s/it][A
Sampling news batches:  90%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▋             | 1351/1496 [1:23:38<07:37,  3.15s/it][A
Sampling news batches:  90%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▊             | 1352/1496 [1:23:40<06:28,  2.70s/it][A
Sampling news batches:  90%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▉             | 1353/1496 [1:23:42<06:05,  2.56s/it][A
Sampling news batches:  91%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▉             | 1354/1496 [1:23:44<05:24,  2.28s/it][A
Sampling news batches:  91%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████             | 1355/1496 [1:23:45<04:36,  1.96s/it][A
Sampling news batches:  91%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▏            | 1356/1496 [1:23:48<05:01,  2.15s/it][A
Sampling news batches:  91%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▎            | 1357/1496 [1:23:50<05:14,  2.26s/it][A
Sampling news batches:  91%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▎            | 1358/1496 [1:23:51<04:30,  1.96s/it][A
Sampling news batches:  91%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▍            | 1359/1496 [1:23:52<03:40,  1.61s/it][A
Sampling news batches:  91%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▌            | 1360/1496 [1:23:54<04:06,  1.81s/it][A{'grad': 2.982325494289398, 'context_loss': 7.707378041744232, 'stance_loss': 1.0603972742190728, 'news_loss': 0.6407430320978165}


Validating rep learning:   0%|                                                                                                                                                    | 0/2211 [00:00<?, ?it/s][A[A

Validating rep learning:   4%|█████▌                                                                                                                                    | 90/2211 [00:00<00:02, 897.48it/s][A[A

Validating rep learning:  11%|██████████████▌                                                                                                                         | 237/2211 [00:00<00:01, 1016.18it/s][A[A

Validating rep learning:  20%|███████████████████████████▊                                                                                                            | 452/2211 [00:00<00:01, 1206.98it/s][A[A

Validating rep learning:  29%|████████████████████████████████████████                                                                                                | 652/2211 [00:00<00:01, 1368.50it/s][A[A

Validating rep learning:  38%|███████████████████████████████████████████████████▊                                                                                    | 842/2211 [00:00<00:00, 1493.56it/s][A[A

Validating rep learning:  47%|███████████████████████████████████████████████████████████████                                                                        | 1032/2211 [00:00<00:00, 1594.68it/s][A[A

Validating rep learning:  55%|██████████████████████████████████████████████████████████████████████████▍                                                            | 1219/2211 [00:00<00:00, 1667.78it/s][A[A

Validating rep learning:  64%|█████████████████████████████████████████████████████████████████████████████████████▋                                                 | 1404/2211 [00:00<00:00, 1718.54it/s][A[A

Validating rep learning:  72%|█████████████████████████████████████████████████████████████████████████████████████████████████                                      | 1589/2211 [00:00<00:00, 1755.36it/s][A[A

Validating rep learning:  80%|████████████████████████████████████████████████████████████████████████████████████████████████████████████▎                          | 1774/2211 [00:01<00:00, 1781.44it/s][A[A

Validating rep learning:  89%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▌               | 1958/2211 [00:01<00:00, 1797.45it/s][A[A

Validating rep learning:  97%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▊    | 2142/2211 [00:01<00:00, 1809.81it/s][A[AValidating rep learning: 100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 2211/2211 [00:01<00:00, 1782.65it/s]
{'stance_avg_closed_ratio': 0.8773655549630834, 'stance_avg_far_ratio': 0.865262834494288, 'other_avg_closed_ratio': 0.4982877824780381, 'other_avg_far_ratio': 0.0}

Sampling news batches:  91%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▊            | 1361/1496 [1:25:25<1:04:13, 28.54s/it][A
Sampling news batches:  91%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▋            | 1362/1496 [1:25:29<46:57, 21.02s/it][A
Sampling news batches:  91%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▊            | 1363/1496 [1:25:31<33:52, 15.29s/it][A
Sampling news batches:  91%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▉            | 1364/1496 [1:25:33<24:55, 11.33s/it][A
Sampling news batches:  91%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████            | 1365/1496 [1:25:34<18:21,  8.41s/it][A
Sampling news batches:  91%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████            | 1366/1496 [1:25:36<13:42,  6.33s/it][A
Sampling news batches:  91%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▏           | 1367/1496 [1:25:39<11:17,  5.25s/it][A
Sampling news batches:  91%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▎           | 1368/1496 [1:25:40<08:52,  4.16s/it][A
Sampling news batches:  92%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▎           | 1369/1496 [1:25:42<06:59,  3.30s/it][A
Sampling news batches:  92%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▍           | 1370/1496 [1:25:44<06:22,  3.03s/it][A
Sampling news batches:  92%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▌           | 1371/1496 [1:25:47<06:11,  2.98s/it][A
Sampling news batches:  92%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▋           | 1372/1496 [1:25:48<05:14,  2.53s/it][A
Sampling news batches:  92%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▋           | 1373/1496 [1:25:51<05:25,  2.65s/it][A
Sampling news batches:  92%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▊           | 1374/1496 [1:25:52<04:18,  2.12s/it][A
Sampling news batches:  92%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▉           | 1375/1496 [1:25:54<04:03,  2.01s/it][A
Sampling news batches:  92%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████           | 1376/1496 [1:26:02<07:59,  3.99s/it][A
Sampling news batches:  92%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████           | 1377/1496 [1:26:05<06:54,  3.48s/it][A
Sampling news batches:  92%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▏          | 1378/1496 [1:26:07<06:16,  3.19s/it][A
Sampling news batches:  92%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▎          | 1379/1496 [1:26:10<05:48,  2.97s/it][A
Sampling news batches:  92%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▍          | 1380/1496 [1:26:12<05:13,  2.70s/it][A
Sampling news batches:  92%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▍          | 1381/1496 [1:26:35<16:59,  8.87s/it][A
Sampling news batches:  92%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▌          | 1382/1496 [1:26:36<12:18,  6.48s/it][A
Sampling news batches:  92%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▋          | 1383/1496 [1:26:38<09:28,  5.03s/it][A
Sampling news batches:  93%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▋          | 1384/1496 [1:26:40<07:39,  4.10s/it][A
Sampling news batches:  93%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▊          | 1385/1496 [1:26:42<06:31,  3.53s/it][A
Sampling news batches:  93%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▉          | 1386/1496 [1:26:44<05:36,  3.06s/it][A
Sampling news batches:  93%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████          | 1387/1496 [1:26:46<04:52,  2.68s/it][A
Sampling news batches:  93%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████          | 1388/1496 [1:26:47<04:12,  2.34s/it][A
Sampling news batches:  93%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▏         | 1389/1496 [1:26:50<04:20,  2.44s/it][A
Sampling news batches:  93%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▎         | 1390/1496 [1:26:51<03:53,  2.21s/it][A
Sampling news batches:  93%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▍         | 1391/1496 [1:26:53<03:40,  2.10s/it][A
Sampling news batches:  93%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▍         | 1392/1496 [1:26:55<03:16,  1.89s/it][A
Sampling news batches:  93%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▌         | 1393/1496 [1:27:00<04:54,  2.86s/it][A
Sampling news batches:  93%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▋         | 1394/1496 [1:27:03<04:48,  2.83s/it][A
Sampling news batches:  93%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▊         | 1395/1496 [1:27:05<04:43,  2.81s/it][A
Sampling news batches:  93%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▊         | 1396/1496 [1:27:08<04:42,  2.83s/it][A
Sampling news batches:  93%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▉         | 1397/1496 [1:27:10<04:19,  2.62s/it][A
Sampling news batches:  93%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████         | 1398/1496 [1:27:14<04:41,  2.88s/it][A
Sampling news batches:  94%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████         | 1399/1496 [1:27:16<04:08,  2.57s/it][A
Sampling news batches:  94%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▏        | 1400/1496 [1:27:17<03:36,  2.25s/it][A{'grad': 3.8488271236419678, 'context_loss': 7.690605270862579, 'stance_loss': 0.955350207388401, 'news_loss': 0.4748733639717102}


Validating rep learning:   0%|                                                                                                                                                    | 0/2211 [00:00<?, ?it/s][A[A

Validating rep learning:   3%|████▋                                                                                                                                     | 76/2211 [00:00<00:02, 759.44it/s][A[A

Validating rep learning:  10%|██████████████▏                                                                                                                          | 229/2211 [00:00<00:02, 894.38it/s][A[A

Validating rep learning:  19%|█████████████████████████▏                                                                                                              | 410/2211 [00:00<00:01, 1053.27it/s][A[A

Validating rep learning:  27%|████████████████████████████████████▍                                                                                                   | 592/2211 [00:00<00:01, 1204.60it/s][A[A

Validating rep learning:  35%|███████████████████████████████████████████████▎                                                                                        | 770/2211 [00:00<00:01, 1333.76it/s][A[A

Validating rep learning:  42%|█████████████████████████████████████████████████████████                                                                               | 927/2211 [00:00<00:00, 1396.41it/s][A[A

Validating rep learning:  50%|███████████████████████████████████████████████████████████████████▌                                                                   | 1106/2211 [00:00<00:00, 1493.91it/s][A[A

Validating rep learning:  58%|██████████████████████████████████████████████████████████████████████████████▎                                                        | 1282/2211 [00:00<00:00, 1563.60it/s][A[A

Validating rep learning:  66%|█████████████████████████████████████████████████████████████████████████████████████████                                              | 1458/2211 [00:00<00:00, 1617.25it/s][A[A

Validating rep learning:  74%|███████████████████████████████████████████████████████████████████████████████████████████████████▊                                   | 1634/2211 [00:01<00:00, 1655.12it/s][A[A

Validating rep learning:  82%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████                         | 1803/2211 [00:01<00:00, 1664.78it/s][A[A

Validating rep learning:  89%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▋              | 1976/2211 [00:01<00:00, 1682.86it/s][A[A

Validating rep learning:  98%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▊   | 2159/2211 [00:01<00:00, 1723.35it/s][A[AValidating rep learning: 100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 2211/2211 [00:01<00:00, 1659.60it/s]
{'stance_avg_closed_ratio': 0.8856890743372149, 'stance_avg_far_ratio': 0.8855162555555592, 'other_avg_closed_ratio': 0.5268406434876782, 'other_avg_far_ratio': 0.0}

Sampling news batches:  94%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▎        | 1401/1496 [1:28:39<41:31, 26.22s/it][A
Sampling news batches:  94%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▍        | 1402/1496 [1:28:41<29:46, 19.00s/it][A
Sampling news batches:  94%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▍        | 1403/1496 [1:28:43<21:24, 13.81s/it][A
Sampling news batches:  94%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▌        | 1404/1496 [1:28:45<15:49, 10.33s/it][A
Sampling news batches:  94%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▋        | 1405/1496 [1:28:47<11:53,  7.84s/it][A
Sampling news batches:  94%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▊        | 1406/1496 [1:28:49<09:03,  6.04s/it][A
Sampling news batches:  94%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▊        | 1407/1496 [1:28:51<07:01,  4.73s/it][A
Sampling news batches:  94%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▉        | 1408/1496 [1:28:53<05:37,  3.84s/it][A
Sampling news batches:  94%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████        | 1409/1496 [1:28:53<04:15,  2.94s/it][A
Sampling news batches:  94%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████        | 1410/1496 [1:28:55<03:32,  2.48s/it][A
Sampling news batches:  94%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▏       | 1411/1496 [1:28:56<03:06,  2.19s/it][A
Sampling news batches:  94%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▎       | 1412/1496 [1:29:00<03:28,  2.48s/it][A
Sampling news batches:  94%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▍       | 1413/1496 [1:29:02<03:35,  2.59s/it][A
Sampling news batches:  95%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▍       | 1414/1496 [1:29:04<03:11,  2.33s/it][A
Sampling news batches:  95%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▌       | 1415/1496 [1:29:07<03:17,  2.44s/it][A
Sampling news batches:  95%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▋       | 1416/1496 [1:29:10<03:38,  2.73s/it][A
Sampling news batches:  95%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▊       | 1417/1496 [1:29:12<03:05,  2.35s/it][A
Sampling news batches:  95%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▊       | 1418/1496 [1:29:13<02:44,  2.11s/it][A
Sampling news batches:  95%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▉       | 1419/1496 [1:29:14<02:21,  1.84s/it][A
Sampling news batches:  95%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████       | 1420/1496 [1:29:17<02:46,  2.20s/it][A
Sampling news batches:  95%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▏      | 1421/1496 [1:29:20<02:43,  2.17s/it][A
Sampling news batches:  95%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▏      | 1422/1496 [1:29:23<03:01,  2.45s/it][A
Sampling news batches:  95%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▎      | 1423/1496 [1:29:24<02:32,  2.08s/it][A
Sampling news batches:  95%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▍      | 1424/1496 [1:29:26<02:25,  2.01s/it][A
Sampling news batches:  95%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▍      | 1425/1496 [1:29:28<02:34,  2.18s/it][A
Sampling news batches:  95%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▌      | 1426/1496 [1:29:30<02:28,  2.12s/it][A
Sampling news batches:  95%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▋      | 1427/1496 [1:29:32<02:24,  2.10s/it][A
Sampling news batches:  95%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▊      | 1428/1496 [1:29:34<02:22,  2.09s/it][A
Sampling news batches:  96%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▊      | 1429/1496 [1:29:35<01:56,  1.73s/it][A
Sampling news batches:  96%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▉      | 1430/1496 [1:29:37<02:00,  1.83s/it][A
Sampling news batches:  96%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████      | 1431/1496 [1:29:38<01:43,  1.59s/it][A
Sampling news batches:  96%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▏     | 1432/1496 [1:29:41<02:00,  1.89s/it][A
Sampling news batches:  96%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▏     | 1433/1496 [1:29:43<01:55,  1.84s/it][A
Sampling news batches:  96%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▎     | 1434/1496 [1:29:45<02:07,  2.05s/it][A
Sampling news batches:  96%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▍     | 1435/1496 [1:29:47<02:08,  2.11s/it][A
Sampling news batches:  96%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▌     | 1436/1496 [1:29:49<01:48,  1.82s/it][A
Sampling news batches:  96%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▌     | 1437/1496 [1:29:51<01:53,  1.93s/it][A
Sampling news batches:  96%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▋     | 1438/1496 [1:29:53<02:00,  2.08s/it][A
Sampling news batches:  96%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▊     | 1439/1496 [1:30:28<11:12, 11.79s/it][A
Sampling news batches:  96%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▊     | 1440/1496 [1:30:30<08:17,  8.89s/it][A{'grad': 5.630807518959045, 'context_loss': 7.725043761730194, 'stance_loss': nan, 'news_loss': 0.6522421091794968}


Validating rep learning:   0%|                                                                                                                                                    | 0/2211 [00:00<?, ?it/s][A[A

Validating rep learning:   4%|█████▉                                                                                                                                    | 96/2211 [00:00<00:02, 955.18it/s][A[A

Validating rep learning:  12%|████████████████▏                                                                                                                       | 263/2211 [00:00<00:01, 1095.00it/s][A[A

Validating rep learning:  21%|████████████████████████████▏                                                                                                           | 459/2211 [00:00<00:01, 1261.63it/s][A[A

Validating rep learning:  30%|████████████████████████████████████████▍                                                                                               | 658/2211 [00:00<00:01, 1416.87it/s][A[A

Validating rep learning:  38%|████████████████████████████████████████████████████▏                                                                                   | 848/2211 [00:00<00:00, 1533.18it/s][A[A

Validating rep learning:  47%|███████████████████████████████████████████████████████████████▎                                                                       | 1037/2211 [00:00<00:00, 1624.75it/s][A[A

Validating rep learning:  55%|██████████████████████████████████████████████████████████████████████████▋                                                            | 1223/2211 [00:00<00:00, 1688.02it/s][A[A

Validating rep learning:  64%|█████████████████████████████████████████████████████████████████████████████████████▊                                                 | 1405/2211 [00:00<00:00, 1723.89it/s][A[A

Validating rep learning:  72%|█████████████████████████████████████████████████████████████████████████████████████████████████                                      | 1590/2211 [00:00<00:00, 1759.88it/s][A[A

Validating rep learning:  80%|███████████████████████████████████████████████████████████████████████████████████████████████████████████▉                           | 1767/2211 [00:01<00:00, 1757.15it/s][A[A

Validating rep learning:  88%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████                | 1951/2211 [00:01<00:00, 1780.40it/s][A[A

Validating rep learning:  97%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▎    | 2135/2211 [00:01<00:00, 1795.81it/s][A[AValidating rep learning: 100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 2211/2211 [00:01<00:00, 1774.23it/s]
{'stance_avg_closed_ratio': 0.8756965050253558, 'stance_avg_far_ratio': 0.8844362481899771, 'other_avg_closed_ratio': 0.5589104770517964, 'other_avg_far_ratio': 0.0}

Sampling news batches:  96%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▉     | 1441/1496 [1:31:36<23:55, 26.10s/it][A
Sampling news batches:  96%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████     | 1442/1496 [1:31:39<17:14, 19.15s/it][A
Sampling news batches:  96%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▏    | 1443/1496 [1:31:41<12:18, 13.94s/it][A
Sampling news batches:  97%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▏    | 1444/1496 [1:31:42<08:50, 10.20s/it][A
Sampling news batches:  97%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▎    | 1445/1496 [1:31:44<06:37,  7.79s/it][A
Sampling news batches:  97%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▍    | 1446/1496 [1:31:47<05:04,  6.09s/it][A
Sampling news batches:  97%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▌    | 1447/1496 [1:31:52<04:55,  6.03s/it][A
Sampling news batches:  97%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▌    | 1448/1496 [1:31:54<03:47,  4.74s/it][A
Sampling news batches:  97%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▋    | 1449/1496 [1:31:56<03:02,  3.88s/it][A
Sampling news batches:  97%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▊    | 1450/1496 [1:31:57<02:18,  3.02s/it][A
Sampling news batches:  97%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▉    | 1451/1496 [1:31:58<01:49,  2.44s/it][A
Sampling news batches:  97%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▉    | 1452/1496 [1:32:00<01:39,  2.25s/it][A
Sampling news batches:  97%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████    | 1453/1496 [1:32:02<01:37,  2.28s/it][A
Sampling news batches:  97%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▏   | 1454/1496 [1:32:04<01:32,  2.19s/it][A
Sampling news batches:  97%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▏   | 1455/1496 [1:32:06<01:18,  1.93s/it][A
Sampling news batches:  97%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▎   | 1456/1496 [1:32:09<01:32,  2.32s/it][A
Sampling news batches:  97%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▍   | 1457/1496 [1:32:12<01:35,  2.45s/it][A
Sampling news batches:  97%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▌   | 1458/1496 [1:33:00<10:15, 16.19s/it][A
Sampling news batches:  98%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▌   | 1459/1496 [1:33:03<07:30, 12.18s/it][A
Sampling news batches:  98%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▋   | 1460/1496 [1:33:05<05:32,  9.24s/it][A
Sampling news batches:  98%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▊   | 1461/1496 [1:33:07<04:01,  6.90s/it][A
Sampling news batches:  98%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▉   | 1462/1496 [1:33:08<03:01,  5.35s/it][A
Sampling news batches:  98%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▉   | 1463/1496 [1:33:10<02:20,  4.26s/it][A
Sampling news batches:  98%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████   | 1464/1496 [1:33:11<01:42,  3.20s/it][A
Sampling news batches:  98%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▏  | 1465/1496 [1:33:14<01:40,  3.25s/it][A
Sampling news batches:  98%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▎  | 1466/1496 [1:33:16<01:28,  2.97s/it][A
Sampling news batches:  98%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▎  | 1467/1496 [1:33:19<01:25,  2.93s/it][A
Sampling news batches:  98%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▍  | 1468/1496 [1:33:22<01:22,  2.95s/it][A
Sampling news batches:  98%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▌  | 1469/1496 [1:33:24<01:08,  2.52s/it][A
Sampling news batches:  98%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▌  | 1470/1496 [1:33:26<01:02,  2.39s/it][A
Sampling news batches:  98%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▋  | 1471/1496 [1:33:28<00:57,  2.30s/it][A
Sampling news batches:  98%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▊  | 1472/1496 [1:33:30<00:57,  2.39s/it][A
Sampling news batches:  98%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▉  | 1473/1496 [1:33:32<00:49,  2.16s/it][A
Sampling news batches:  99%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▉  | 1474/1496 [1:33:34<00:48,  2.19s/it][A
Sampling news batches:  99%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████  | 1475/1496 [1:33:36<00:43,  2.10s/it][A
Sampling news batches:  99%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▏ | 1476/1496 [1:33:39<00:45,  2.27s/it][A
Sampling news batches:  99%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▎ | 1477/1496 [1:33:44<00:59,  3.14s/it][A
Sampling news batches:  99%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▎ | 1478/1496 [1:33:46<00:51,  2.88s/it][A
Sampling news batches:  99%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▍ | 1479/1496 [1:33:48<00:44,  2.62s/it][A
Sampling news batches:  99%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▌ | 1480/1496 [1:33:50<00:36,  2.25s/it][A{'grad': 3.5198211073875427, 'context_loss': 7.676763987541198, 'stance_loss': nan, 'news_loss': 0.5706965029239655}


Validating rep learning:   0%|                                                                                                                                                    | 0/2211 [00:00<?, ?it/s][A[A

Validating rep learning:   4%|████▉                                                                                                                                     | 79/2211 [00:00<00:02, 786.60it/s][A[A

Validating rep learning:  10%|█████████████▍                                                                                                                           | 216/2211 [00:00<00:02, 901.06it/s][A[A

Validating rep learning:  19%|██████████████████████████▍                                                                                                             | 430/2211 [00:00<00:01, 1090.10it/s][A[A

Validating rep learning:  28%|██████████████████████████████████████▌                                                                                                 | 627/2211 [00:00<00:01, 1257.92it/s][A[A

Validating rep learning:  37%|██████████████████████████████████████████████████▎                                                                                     | 817/2211 [00:00<00:00, 1398.87it/s][A[A

Validating rep learning:  45%|█████████████████████████████████████████████████████████████▎                                                                         | 1005/2211 [00:00<00:00, 1514.78it/s][A[A

Validating rep learning:  54%|████████████████████████████████████████████████████████████████████████▋                                                              | 1191/2211 [00:00<00:00, 1602.78it/s][A[A

Validating rep learning:  62%|████████████████████████████████████████████████████████████████████████████████████                                                   | 1376/2211 [00:00<00:00, 1667.31it/s][A[A

Validating rep learning:  71%|███████████████████████████████████████████████████████████████████████████████████████████████▎                                       | 1560/2211 [00:00<00:00, 1714.52it/s][A[A

Validating rep learning:  79%|██████████████████████████████████████████████████████████████████████████████████████████████████████████▎                            | 1742/2211 [00:01<00:00, 1742.33it/s][A[A

Validating rep learning:  87%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▌                 | 1926/2211 [00:01<00:00, 1770.38it/s][A[A

Validating rep learning:  95%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▉      | 2111/2211 [00:01<00:00, 1792.47it/s][A[AValidating rep learning: 100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 2211/2211 [00:01<00:00, 1757.35it/s]
{'stance_avg_closed_ratio': 0.8923968845594351, 'stance_avg_far_ratio': 0.9167376452630465, 'other_avg_closed_ratio': 0.5437615308495516, 'other_avg_far_ratio': 0.0}

Sampling news batches:  99%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▋ | 1481/1496 [1:35:47<09:10, 36.68s/it][A
Sampling news batches:  99%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▋ | 1482/1496 [1:35:49<06:08, 26.30s/it][A
Sampling news batches:  99%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▊ | 1483/1496 [1:35:52<04:10, 19.23s/it][A
Sampling news batches:  99%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▉ | 1484/1496 [1:35:54<02:51, 14.32s/it][A
Sampling news batches:  99%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▉ | 1485/1496 [1:35:56<01:55, 10.50s/it][A
Sampling news batches:  99%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████ | 1486/1496 [1:35:59<01:21,  8.19s/it][A
Sampling news batches:  99%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▏| 1487/1496 [1:36:02<01:00,  6.73s/it][A
Sampling news batches:  99%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▎| 1488/1496 [1:36:05<00:43,  5.43s/it][A
Sampling news batches: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▎| 1489/1496 [1:36:06<00:29,  4.27s/it][A
Sampling news batches: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▍| 1490/1496 [1:36:08<00:21,  3.54s/it][A
Sampling news batches: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▌| 1491/1496 [1:36:10<00:14,  3.00s/it][A
Sampling news batches: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▋| 1492/1496 [1:36:11<00:10,  2.54s/it][A
Sampling news batches: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▋| 1493/1496 [1:36:14<00:08,  2.69s/it][A
Sampling news batches: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▊| 1494/1496 [1:36:18<00:05,  2.99s/it][A
Sampling news batches: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▉| 1495/1496 [1:36:20<00:02,  2.72s/it][A
Sampling news batches: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 1496/1496 [1:36:21<00:00,  2.28s/it][ASampling news batches: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 1496/1496 [1:36:21<00:00,  3.86s/it]
Validating
Training GraphSage:   0%|                                                                                                                                                         | 0/30 [1:54:36<?, ?it/s]
Traceback (most recent call last):
  File "run_graph.py", line 67, in <module>
    fang(p_args)
  File "run_graph.py", line 55, in fang
    pretrained_dir=args.pretrained_dir, pretrained_step=args.pretrained_step)
  File "/home/sejmou/Repos/Uni/ExpDesDS/FANG/fang/graphsage/__init__.py", line 227, in run_fang_graph_sage
    n_nodes, input_size, pretrained_dir, pretrained_step)
  File "/home/sejmou/Repos/Uni/ExpDesDS/FANG/fang/graphsage/__init__.py", line 631, in train_fn
    writer, device, tag="validate")
  File "/home/sejmou/Repos/Uni/ExpDesDS/FANG/fang/graphsage/__init__.py", line 709, in eval_fn
    embed_size, device, cutoff_range, test=True)
  File "/home/sejmou/Repos/Uni/ExpDesDS/FANG/fang/graphsage/__init__.py", line 741, in preprocess_news_classification_data
    else torch.zeros(1, embed_size).to(device) for e_users in engage_users_batch]
  File "/home/sejmou/Repos/Uni/ExpDesDS/FANG/fang/graphsage/__init__.py", line 741, in <listcomp>
    else torch.zeros(1, embed_size).to(device) for e_users in engage_users_batch]
  File "/home/sejmou/anaconda3/envs/test/lib/python3.7/site-packages/torch/nn/modules/module.py", line 550, in __call__
    result = self.forward(*input, **kwargs)
  File "/home/sejmou/Repos/Uni/ExpDesDS/FANG/user_embed/graphsage/models.py", line 55, in forward
    aggregate_feats = self.aggregate(nb, pre_hidden_embs, pre_neighs)
  File "/home/sejmou/Repos/Uni/ExpDesDS/FANG/user_embed/graphsage/models.py", line 121, in aggregate
    mask = mask.div(num_neigh).to(embed_matrix.device)
RuntimeError: CUDA out of memory. Tried to allocate 2.40 GiB (GPU 0; 5.93 GiB total capacity; 469.21 MiB already allocated; 1.16 GiB free; 4.06 GiB reserved in total by PyTorch)
^C

real	121m26,343s
user	137m5,796s
sys	38m55,255s
(test) ]0;sejmou@sejmou-desktop: ~/Repos/Uni/ExpDesDS/FANG[01;32msejmou@sejmou-desktop[00m:[01;34m~/Repos/Uni/ExpDesDS/FANG[00m$ time python run_graph.py -t fang -m graph_sage -p data/news_graph --percent 10 --epochs=30 --attention --use-stance --use-proximity --temporal
Using stance
Using proximity
Load FANG dataset from data/news_graph
/home/sejmou/Repos/Uni/ExpDesDS/FANG/fang/utils.py:98: RuntimeWarning: divide by zero encountered in power
  sum_inv = np.power(row_sum, -1).flatten()
Loading cache
Use temporal
Initialize optimizer with weight decay 0.0005
Train 55026 Dev 466 Test 465
Training GraphSage:   0%|                                                                                                                                                           | 0/30 [00:00<?, ?it/s]
Sampling news batches:   0%|                                                                                                                                                        | 0/24 [00:00<?, ?it/s][A^CSampling news batches:   0%|                                                                                                                                                        | 0/24 [01:02<?, ?it/s]
Training GraphSage:   0%|                                                                                                                                                           | 0/30 [01:02<?, ?it/s]
Traceback (most recent call last):
  File "run_graph.py", line 67, in <module>
    fang(p_args)
  File "run_graph.py", line 55, in fang
    pretrained_dir=args.pretrained_dir, pretrained_step=args.pretrained_step)
  File "/home/sejmou/Repos/Uni/ExpDesDS/FANG/fang/graphsage/__init__.py", line 227, in run_fang_graph_sage
    n_nodes, input_size, pretrained_dir, pretrained_step)
  File "/home/sejmou/Repos/Uni/ExpDesDS/FANG/fang/graphsage/__init__.py", line 451, in train_fn
    graph_sage_walker.extend_user_nodes(user_batch)
  File "/home/sejmou/Repos/Uni/ExpDesDS/FANG/fang/graphsage/walker.py", line 329, in extend_user_nodes
    self.USER_WALK_LEN, self.user_neighbor_cache)
  File "/home/sejmou/Repos/Uni/ExpDesDS/FANG/fang/graphsage/walker.py", line 355, in get_proximity_samples
    current |= set(self.get_neigh_weights(outer, node_only=True))
  File "/home/sejmou/Repos/Uni/ExpDesDS/FANG/fang/graphsage/walker.py", line 385, in get_neigh_weights
    return [int(x.split("#")[0]) for x in neighs]
  File "/home/sejmou/Repos/Uni/ExpDesDS/FANG/fang/graphsage/walker.py", line 385, in <listcomp>
    return [int(x.split("#")[0]) for x in neighs]
KeyboardInterrupt
^C

real	2m5,189s
user	1m37,103s
sys	0m6,489s
(test) ]0;sejmou@sejmou-desktop: ~/Repos/Uni/ExpDesDS/FANG[01;32msejmou@sejmou-desktop[00m:[01;34m~/Repos/Uni/ExpDesDS/FANG[00m$ exit
exit

Script done on 2022-01-29 18:36:58+01:00 [COMMAND_EXIT_CODE="130"]
