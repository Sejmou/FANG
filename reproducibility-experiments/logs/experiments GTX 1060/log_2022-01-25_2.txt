Script started on 2022-01-25 09:35:39+01:00 [TERM="xterm-256color" TTY="/dev/pts/1" COLUMNS="203" LINES="55"]
(base) ]0;sejmou@sejmou-desktop: ~/Repos/Uni/ExpDesDS/FANG[01;32msejmou@sejmou-desktop[00m:[01;34m~/Repos/Uni/ExpDesDS/FANG[00m$ time [K[K[K[K[Kconv[Kda activate test
(test) ]0;sejmou@sejmou-desktop: ~/Repos/Uni/ExpDesDS/FANG[01;32msejmou@sejmou-desktop[00m:[01;34m~/Repos/Uni/ExpDesDS/FANG[00m$ time python run_graph.py -t fang -m graph_sage -p data/news_graph --percent 90 --epochs=30 --attention --use-stance --use-proximity --temporal[C[1P[1@1
Using stance
Using proximity
Load FANG dataset from data/news_graph
/home/sejmou/Repos/Uni/ExpDesDS/FANG/fang/utils.py:98: RuntimeWarning: divide by zero encountered in power
  sum_inv = np.power(row_sum, -1).flatten()
Creating new far node cache with capacity 20000
Use temporal
Initialize optimizer with weight decay 0.0005
Train 55026 Dev 466 Test 465
Training GraphSage:   0%|                                                                                                                                                           | 0/30 [00:00<?, ?it/s]
Sampling news batches:   0%|                                                                                                                                                        | 0/47 [00:00<?, ?it/s][A{'grad': 2.712450861930847, 'context_loss': 7.9466447830200195, 'stance_loss': 1.3919621706008911, 'news_loss': 0.7903354167938232}


Validating rep learning:   0%|                                                                                                                                                    | 0/2211 [00:00<?, ?it/s][A[A

Validating rep learning:   8%|███████████                                                                                                                             | 179/2211 [00:00<00:01, 1782.25it/s][A[A

Validating rep learning:  18%|███████████████████████▊                                                                                                                | 387/2211 [00:00<00:00, 1861.28it/s][A[A

Validating rep learning:  26%|███████████████████████████████████▌                                                                                                    | 578/2211 [00:00<00:00, 1875.25it/s][A[A

Validating rep learning:  35%|███████████████████████████████████████████████▉                                                                                        | 779/2211 [00:00<00:00, 1913.68it/s][A[A

Validating rep learning:  44%|███████████████████████████████████████████████████████████▊                                                                            | 972/2211 [00:00<00:00, 1916.52it/s][A[A

Validating rep learning:  53%|██████████████████████████████████████████████████████████████████████▉                                                                | 1162/2211 [00:00<00:00, 1910.35it/s][A[A

Validating rep learning:  61%|██████████████████████████████████████████████████████████████████████████████████▍                                                    | 1350/2211 [00:00<00:00, 1901.13it/s][A[A

Validating rep learning:  70%|█████████████████████████████████████████████████████████████████████████████████████████████▉                                         | 1538/2211 [00:00<00:00, 1891.79it/s][A[A

Validating rep learning:  78%|█████████████████████████████████████████████████████████████████████████████████████████████████████████▎                             | 1725/2211 [00:00<00:00, 1882.60it/s][A[A

Validating rep learning:  86%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▋                  | 1912/2211 [00:01<00:00, 1876.84it/s][A[A

Validating rep learning:  95%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▏      | 2099/2211 [00:01<00:00, 1873.60it/s][A[AValidating rep learning: 100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 2211/2211 [00:01<00:00, 1901.03it/s]
{'stance_avg_closed_ratio': 0.9774678718491864, 'stance_avg_far_ratio': 0.9982016960005453, 'other_avg_closed_ratio': 1.1370666405004175, 'other_avg_far_ratio': 0.0}

Sampling news batches:   2%|███                                                                                                                                          | 1/47 [01:48<1:23:31, 108.94s/it][A
Sampling news batches:   4%|██████                                                                                                                                        | 2/47 [02:37<1:08:02, 90.72s/it][A
Sampling news batches:   6%|█████████▏                                                                                                                                      | 3/47 [03:25<57:12, 78.00s/it][A
Sampling news batches:   9%|████████████▎                                                                                                                                   | 4/47 [04:21<51:11, 71.44s/it][A
Sampling news batches:  11%|███████████████▎                                                                                                                                | 5/47 [05:00<43:14, 61.78s/it][A
Sampling news batches:  13%|██████████████████▍                                                                                                                             | 6/47 [05:37<37:07, 54.32s/it][A
Sampling news batches:  15%|█████████████████████▍                                                                                                                          | 7/47 [06:22<34:22, 51.56s/it][A
Sampling news batches:  17%|████████████████████████▌                                                                                                                       | 8/47 [07:06<31:53, 49.05s/it][A
Sampling news batches:  19%|███████████████████████████▌                                                                                                                    | 9/47 [07:47<29:38, 46.79s/it][A
Sampling news batches:  21%|██████████████████████████████▍                                                                                                                | 10/47 [08:29<27:56, 45.32s/it][A
Sampling news batches:  23%|█████████████████████████████████▍                                                                                                             | 11/47 [09:05<25:29, 42.48s/it][A
Sampling news batches:  26%|████████████████████████████████████▌                                                                                                          | 12/47 [09:42<23:46, 40.77s/it][A
Sampling news batches:  28%|███████████████████████████████████████▌                                                                                                       | 13/47 [10:24<23:25, 41.35s/it][A
Sampling news batches:  30%|██████████████████████████████████████████▌                                                                                                    | 14/47 [11:01<22:00, 40.03s/it][A
Sampling news batches:  32%|█████████████████████████████████████████████▋                                                                                                 | 15/47 [11:34<20:06, 37.71s/it][A
Sampling news batches:  34%|████████████████████████████████████████████████▋                                                                                              | 16/47 [12:12<19:32, 37.84s/it][A
Sampling news batches:  36%|███████████████████████████████████████████████████▋                                                                                           | 17/47 [12:49<18:49, 37.66s/it][A
Sampling news batches:  38%|██████████████████████████████████████████████████████▊                                                                                        | 18/47 [13:24<17:51, 36.94s/it][A
Sampling news batches:  40%|█████████████████████████████████████████████████████████▊                                                                                     | 19/47 [14:03<17:31, 37.56s/it][A
Sampling news batches:  43%|████████████████████████████████████████████████████████████▊                                                                                  | 20/47 [14:40<16:45, 37.24s/it][A
Sampling news batches:  45%|███████████████████████████████████████████████████████████████▉                                                                               | 21/47 [15:14<15:43, 36.28s/it][A
Sampling news batches:  47%|██████████████████████████████████████████████████████████████████▉                                                                            | 22/47 [15:55<15:47, 37.91s/it][A
Sampling news batches:  49%|█████████████████████████████████████████████████████████████████████▉                                                                         | 23/47 [16:25<14:10, 35.42s/it][A
Sampling news batches:  51%|█████████████████████████████████████████████████████████████████████████                                                                      | 24/47 [17:00<13:33, 35.38s/it][A
Sampling news batches:  53%|████████████████████████████████████████████████████████████████████████████                                                                   | 25/47 [17:34<12:49, 34.96s/it][A
Sampling news batches:  55%|███████████████████████████████████████████████████████████████████████████████                                                                | 26/47 [18:06<11:52, 33.92s/it][A
Sampling news batches:  57%|██████████████████████████████████████████████████████████████████████████████████▏                                                            | 27/47 [18:46<11:53, 35.66s/it][A
Sampling news batches:  60%|█████████████████████████████████████████████████████████████████████████████████████▏                                                         | 28/47 [19:22<11:23, 35.98s/it][A
Sampling news batches:  62%|████████████████████████████████████████████████████████████████████████████████████████▏                                                      | 29/47 [20:00<10:56, 36.45s/it][A
Sampling news batches:  64%|███████████████████████████████████████████████████████████████████████████████████████████▎                                                   | 30/47 [20:31<09:52, 34.85s/it][A
Sampling news batches:  66%|██████████████████████████████████████████████████████████████████████████████████████████████▎                                                | 31/47 [21:06<09:17, 34.86s/it][A
Sampling news batches:  68%|█████████████████████████████████████████████████████████████████████████████████████████████████▎                                             | 32/47 [21:39<08:36, 34.42s/it][A
Sampling news batches:  70%|████████████████████████████████████████████████████████████████████████████████████████████████████▍                                          | 33/47 [22:12<07:53, 33.80s/it][A
Sampling news batches:  72%|███████████████████████████████████████████████████████████████████████████████████████████████████████▍                                       | 34/47 [22:43<07:08, 32.99s/it][A
Sampling news batches:  74%|██████████████████████████████████████████████████████████████████████████████████████████████████████████▍                                    | 35/47 [23:16<06:38, 33.19s/it][A
Sampling news batches:  77%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████▌                                 | 36/47 [23:55<06:21, 34.71s/it][A
Sampling news batches:  79%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████▌                              | 37/47 [24:30<05:48, 34.83s/it][A
Sampling news batches:  81%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████▌                           | 38/47 [25:00<05:00, 33.44s/it][A
Sampling news batches:  83%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▋                        | 39/47 [25:29<04:17, 32.17s/it][A
Sampling news batches:  85%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▋                     | 40/47 [26:06<03:55, 33.59s/it][A{'grad': 1.9865358471870422, 'context_loss': 7.827245664596558, 'stance_loss': 1.3759022414684297, 'news_loss': 0.705746737749953}


Validating rep learning:   0%|                                                                                                                                                    | 0/2211 [00:00<?, ?it/s][A[A

Validating rep learning:   8%|███████████                                                                                                                             | 179/2211 [00:00<00:01, 1784.44it/s][A[A

Validating rep learning:  17%|███████████████████████▋                                                                                                                | 385/2211 [00:00<00:00, 1857.23it/s][A[A

Validating rep learning:  26%|███████████████████████████████████▌                                                                                                    | 579/2211 [00:00<00:00, 1879.02it/s][A[A

Validating rep learning:  35%|████████████████████████████████████████████████▏                                                                                       | 783/2211 [00:00<00:00, 1921.79it/s][A[A

Validating rep learning:  44%|████████████████████████████████████████████████████████████                                                                            | 976/2211 [00:00<00:00, 1923.66it/s][A[A

Validating rep learning:  53%|███████████████████████████████████████████████████████████████████████▎                                                               | 1168/2211 [00:00<00:00, 1921.69it/s][A[A

Validating rep learning:  61%|██████████████████████████████████████████████████████████████████████████████████▋                                                    | 1355/2211 [00:00<00:00, 1905.16it/s][A[A

Validating rep learning:  70%|██████████████████████████████████████████████████████████████████████████████████████████████▎                                        | 1544/2211 [00:00<00:00, 1899.46it/s][A[A

Validating rep learning:  78%|█████████████████████████████████████████████████████████████████████████████████████████████████████████▊                             | 1733/2211 [00:00<00:00, 1894.65it/s][A[A

Validating rep learning:  87%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▏                 | 1920/2211 [00:01<00:00, 1886.90it/s][A[A

Validating rep learning:  95%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▋      | 2108/2211 [00:01<00:00, 1882.18it/s][A[AValidating rep learning: 100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 2211/2211 [00:01<00:00, 1905.67it/s]
{'stance_avg_closed_ratio': 0.9611549049910952, 'stance_avg_far_ratio': 0.963566736513868, 'other_avg_closed_ratio': 0.9690970863546345, 'other_avg_far_ratio': 0.0}

Sampling news batches:  87%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▋                  | 41/47 [27:41<05:12, 52.07s/it][A
Sampling news batches:  89%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▊               | 42/47 [28:14<03:51, 46.28s/it][A
Sampling news batches:  91%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▊            | 43/47 [28:43<02:44, 41.19s/it][A
Sampling news batches:  94%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▊         | 44/47 [29:14<01:54, 38.12s/it][A
Sampling news batches:  96%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▉      | 45/47 [29:46<01:12, 36.26s/it][A
Sampling news batches:  98%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▉   | 46/47 [30:16<00:34, 34.33s/it][A
Sampling news batches: 100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 47/47 [30:44<00:00, 32.37s/it][ASampling news batches: 100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 47/47 [30:44<00:00, 39.24s/it]
Saving cache
Validating
Training GraphSage:   0%|                                                                                                                                                           | 0/30 [34:05<?, ?it/s]
Traceback (most recent call last):
  File "run_graph.py", line 67, in <module>
    fang(p_args)
  File "run_graph.py", line 55, in fang
    pretrained_dir=args.pretrained_dir, pretrained_step=args.pretrained_step)
  File "/home/sejmou/Repos/Uni/ExpDesDS/FANG/fang/graphsage/__init__.py", line 227, in run_fang_graph_sage
    n_nodes, input_size, pretrained_dir, pretrained_step)
  File "/home/sejmou/Repos/Uni/ExpDesDS/FANG/fang/graphsage/__init__.py", line 631, in train_fn
    writer, device, tag="validate")
  File "/home/sejmou/Repos/Uni/ExpDesDS/FANG/fang/graphsage/__init__.py", line 709, in eval_fn
    embed_size, device, cutoff_range, test=True)
  File "/home/sejmou/Repos/Uni/ExpDesDS/FANG/fang/graphsage/__init__.py", line 741, in preprocess_news_classification_data
    else torch.zeros(1, embed_size).to(device) for e_users in engage_users_batch]
  File "/home/sejmou/Repos/Uni/ExpDesDS/FANG/fang/graphsage/__init__.py", line 741, in <listcomp>
    else torch.zeros(1, embed_size).to(device) for e_users in engage_users_batch]
  File "/home/sejmou/anaconda3/envs/test/lib/python3.7/site-packages/torch/nn/modules/module.py", line 550, in __call__
    result = self.forward(*input, **kwargs)
  File "/home/sejmou/Repos/Uni/ExpDesDS/FANG/user_embed/graphsage/models.py", line 55, in forward
    aggregate_feats = self.aggregate(nb, pre_hidden_embs, pre_neighs)
  File "/home/sejmou/Repos/Uni/ExpDesDS/FANG/user_embed/graphsage/models.py", line 121, in aggregate
    mask = mask.div(num_neigh).to(embed_matrix.device)
RuntimeError: CUDA out of memory. Tried to allocate 2.40 GiB (GPU 0; 5.93 GiB total capacity; 471.05 MiB already allocated; 704.19 MiB free; 4.61 GiB reserved in total by PyTorch)

real	34m34,773s
user	62m1,785s
sys	17m59,507s
(test) ]0;sejmou@sejmou-desktop: ~/Repos/Uni/ExpDesDS/FANG[01;32msejmou@sejmou-desktop[00m:[01;34m~/Repos/Uni/ExpDesDS/FANG[00m$ time python run_graph.py -t fang -m graph_sage -p data/news_graph --percent 10 --epochs=30 --attention --use-stance --use-proximity --temporal
Using stance
Using proximity
Load FANG dataset from data/news_graph
/home/sejmou/Repos/Uni/ExpDesDS/FANG/fang/utils.py:98: RuntimeWarning: divide by zero encountered in power
  sum_inv = np.power(row_sum, -1).flatten()
Loading cache
Use temporal
Initialize optimizer with weight decay 0.0005
Train 55026 Dev 466 Test 465
Training GraphSage:   0%|                                                                                                                                                           | 0/30 [00:00<?, ?it/s]
Sampling news batches:   0%|                                                                                                                                                        | 0/47 [00:00<?, ?it/s][A{'grad': 1.960148274898529, 'context_loss': 7.966629981994629, 'stance_loss': 1.3678054809570312, 'news_loss': 0.6019126176834106}


Validating rep learning:   0%|                                                                                                                                                    | 0/2211 [00:00<?, ?it/s][A[A

Validating rep learning:   8%|███████████▏                                                                                                                            | 182/2211 [00:00<00:01, 1812.37it/s][A[A

Validating rep learning:  18%|████████████████████████▌                                                                                                               | 399/2211 [00:00<00:00, 1905.87it/s][A[A

Validating rep learning:  27%|█████████████████████████████████████▎                                                                                                  | 607/2211 [00:00<00:00, 1952.70it/s][A[A

Validating rep learning:  36%|█████████████████████████████████████████████████▌                                                                                      | 805/2211 [00:00<00:00, 1959.61it/s][A[A

Validating rep learning:  45%|█████████████████████████████████████████████████████████████▏                                                                         | 1003/2211 [00:00<00:00, 1963.85it/s][A[A

Validating rep learning:  54%|█████████████████████████████████████████████████████████████████████████                                                              | 1197/2211 [00:00<00:00, 1955.71it/s][A[A

Validating rep learning:  63%|████████████████████████████████████████████████████████████████████████████████████▋                                                  | 1388/2211 [00:00<00:00, 1940.90it/s][A[A

Validating rep learning:  71%|████████████████████████████████████████████████████████████████████████████████████████████████▍                                      | 1580/2211 [00:00<00:00, 1931.98it/s][A[A

Validating rep learning:  80%|████████████████████████████████████████████████████████████████████████████████████████████████████████████▏                          | 1772/2211 [00:00<00:00, 1928.22it/s][A[A

Validating rep learning:  89%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▉               | 1964/2211 [00:01<00:00, 1922.80it/s][A[A

Validating rep learning:  98%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▋   | 2156/2211 [00:01<00:00, 1921.63it/s][A[AValidating rep learning: 100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 2211/2211 [00:01<00:00, 1952.82it/s]
{'stance_avg_closed_ratio': 0.9948583354170242, 'stance_avg_far_ratio': 1.0062337229441185, 'other_avg_closed_ratio': 0.9280452057051128, 'other_avg_far_ratio': 0.0}

Sampling news batches:   2%|███                                                                                                                                           | 1/47 [01:33<1:11:46, 93.62s/it][A
Sampling news batches:   4%|██████▏                                                                                                                                         | 2/47 [02:13<58:01, 77.37s/it][A
Sampling news batches:   6%|█████████▏                                                                                                                                      | 3/47 [02:47<47:17, 64.49s/it][A^CSampling news batches:   6%|█████████▏                                                                                                                                      | 3/47 [03:33<52:10, 71.14s/it]
Training GraphSage:   0%|                                                                                                                                                           | 0/30 [03:33<?, ?it/s]
Traceback (most recent call last):
  File "run_graph.py", line 67, in <module>
    fang(p_args)
  File "run_graph.py", line 55, in fang
    pretrained_dir=args.pretrained_dir, pretrained_step=args.pretrained_step)
  File "/home/sejmou/Repos/Uni/ExpDesDS/FANG/fang/graphsage/__init__.py", line 227, in run_fang_graph_sage
    n_nodes, input_size, pretrained_dir, pretrained_step)
  File "/home/sejmou/Repos/Uni/ExpDesDS/FANG/fang/graphsage/__init__.py", line 454, in train_fn
    user_emb_batch = graph_sage(user_batch) if len(user_batch) > 0 else None
  File "/home/sejmou/anaconda3/envs/test/lib/python3.7/site-packages/torch/nn/modules/module.py", line 550, in __call__
    result = self.forward(*input, **kwargs)
  File "/home/sejmou/Repos/Uni/ExpDesDS/FANG/user_embed/graphsage/models.py", line 55, in forward
    aggregate_feats = self.aggregate(nb, pre_hidden_embs, pre_neighs)
  File "/home/sejmou/Repos/Uni/ExpDesDS/FANG/user_embed/graphsage/models.py", line 121, in aggregate
    mask = mask.div(num_neigh).to(embed_matrix.device)
KeyboardInterrupt
^[[A^[[A^C^C^C

real	4m16,088s
user	6m52,448s
sys	1m32,801s
(test) ]0;sejmou@sejmou-desktop: ~/Repos/Uni/ExpDesDS/FANG[01;32msejmou@sejmou-desktop[00m:[01;34m~/Repos/Uni/ExpDesDS/FANG[00m$ ^C
(test) ]0;sejmou@sejmou-desktop: ~/Repos/Uni/ExpDesDS/FANG[01;32msejmou@sejmou-desktop[00m:[01;34m~/Repos/Uni/ExpDesDS/FANG[00m$ time python run_graph.py -t fang -m graph_sage -p data/news_graph --percent 10 --epochs=30 --attention --use-stance --use-proximity --temporal
Using stance
Using proximity
Load FANG dataset from data/news_graph
/home/sejmou/Repos/Uni/ExpDesDS/FANG/fang/utils.py:98: RuntimeWarning: divide by zero encountered in power
  sum_inv = np.power(row_sum, -1).flatten()
Loading cache
Use temporal
Initialize optimizer with weight decay 0.0005
Train 55026 Dev 466 Test 465
Training GraphSage:   0%|                                                                                                                                                           | 0/30 [00:00<?, ?it/s]
Sampling news batches:   0%|                                                                                                                                                        | 0/47 [00:00<?, ?it/s][A{'grad': 2.169244408607483, 'context_loss': 7.985045433044434, 'stance_loss': 1.3975621461868286, 'news_loss': 0.6932257413864136}


Validating rep learning:   0%|                                                                                                                                                    | 0/2211 [00:00<?, ?it/s][A[A

Validating rep learning:   7%|█████████▌                                                                                                                              | 156/2211 [00:00<00:01, 1558.05it/s][A[A

Validating rep learning:  17%|███████████████████████                                                                                                                 | 374/2211 [00:00<00:01, 1702.14it/s][A[A

Validating rep learning:  26%|███████████████████████████████████                                                                                                     | 570/2211 [00:00<00:00, 1771.17it/s][A[A

Validating rep learning:  35%|██████████████████████████████████████████████▉                                                                                         | 764/2211 [00:00<00:00, 1818.06it/s][A[A

Validating rep learning:  43%|██████████████████████████████████████████████████████████▊                                                                             | 956/2211 [00:00<00:00, 1845.36it/s][A[A

Validating rep learning:  52%|█████████████████████████████████████████████████████████████████████▉                                                                 | 1146/2211 [00:00<00:00, 1860.11it/s][A[A

Validating rep learning:  60%|█████████████████████████████████████████████████████████████████████████████████▌                                                     | 1336/2211 [00:00<00:00, 1870.65it/s][A[A

Validating rep learning:  69%|█████████████████████████████████████████████████████████████████████████████████████████████                                          | 1525/2211 [00:00<00:00, 1873.56it/s][A[A

Validating rep learning:  77%|████████████████████████████████████████████████████████████████████████████████████████████████████████▎                              | 1709/2211 [00:00<00:00, 1862.80it/s][A[A

Validating rep learning:  85%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████▍                   | 1890/2211 [00:01<00:00, 1833.92it/s][A[A

Validating rep learning:  94%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▋        | 2074/2211 [00:01<00:00, 1835.11it/s][A[AValidating rep learning: 100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 2211/2211 [00:01<00:00, 1869.80it/s]
{'stance_avg_closed_ratio': 1.0094134034961915, 'stance_avg_far_ratio': 1.0077471055281995, 'other_avg_closed_ratio': 0.9933179214456704, 'other_avg_far_ratio': 0.0}

Sampling news batches:   2%|███                                                                                                                                          | 1/47 [01:59<1:31:30, 119.37s/it][A
Sampling news batches:   4%|██████                                                                                                                                        | 2/47 [02:44<1:12:43, 96.97s/it][A
Sampling news batches:   6%|█████████                                                                                                                                     | 3/47 [03:39<1:01:58, 84.51s/it][A
Sampling news batches:   9%|████████████▎                                                                                                                                   | 4/47 [04:30<53:19, 74.41s/it][A
Sampling news batches:  11%|███████████████▎                                                                                                                                | 5/47 [05:07<44:17, 63.27s/it][A
Sampling news batches:  13%|██████████████████▍                                                                                                                             | 6/47 [05:46<38:16, 56.01s/it][A
Sampling news batches:  15%|█████████████████████▍                                                                                                                          | 7/47 [06:26<34:03, 51.08s/it][A
Sampling news batches:  17%|████████████████████████▌                                                                                                                       | 8/47 [07:10<31:48, 48.93s/it][A
Sampling news batches:  19%|███████████████████████████▌                                                                                                                    | 9/47 [08:07<32:40, 51.58s/it][A
Sampling news batches:  21%|██████████████████████████████▍                                                                                                                | 10/47 [09:03<32:36, 52.87s/it][A
Sampling news batches:  23%|█████████████████████████████████▍                                                                                                             | 11/47 [10:09<34:02, 56.74s/it][A
Sampling news batches:  26%|███████████████████████████████████▋                                                                                                        | 12/47 [14:09<1:05:06, 111.60s/it][A
Sampling news batches:  28%|██████████████████████████████████████▋                                                                                                     | 13/47 [18:24<1:27:35, 154.56s/it][A
Sampling news batches:  30%|█████████████████████████████████████████▋                                                                                                  | 14/47 [21:19<1:28:28, 160.87s/it][A
Sampling news batches:  32%|████████████████████████████████████████████▋                                                                                               | 15/47 [22:27<1:10:55, 132.97s/it][A
Sampling news batches:  34%|███████████████████████████████████████████████▋                                                                                            | 16/47 [26:01<1:21:12, 157.17s/it][A
Sampling news batches:  36%|██████████████████████████████████████████████████▋                                                                                         | 17/47 [27:06<1:04:51, 129.73s/it][A
Sampling news batches:  38%|█████████████████████████████████████████████████████▌                                                                                      | 18/47 [29:58<1:08:43, 142.19s/it][A
Sampling news batches:  40%|█████████████████████████████████████████████████████████▍                                                                                    | 19/47 [31:11<56:41, 121.48s/it][A
Sampling news batches:  43%|███████████████████████████████████████████████████████████▌                                                                                | 20/47 [35:10<1:10:37, 156.96s/it][A
Sampling news batches:  45%|███████████████████████████████████████████████████████████████▍                                                                              | 21/47 [35:51<52:56, 122.16s/it][A
Sampling news batches:  47%|██████████████████████████████████████████████████████████████████▍                                                                           | 22/47 [37:11<45:33, 109.35s/it][A
Sampling news batches:  49%|█████████████████████████████████████████████████████████████████████▍                                                                        | 23/47 [40:45<56:17, 140.75s/it][A
Sampling news batches:  51%|███████████████████████████████████████████████████████████████████████▍                                                                    | 24/47 [44:57<1:06:47, 174.26s/it][A
Sampling news batches:  53%|███████████████████████████████████████████████████████████████████████████▌                                                                  | 25/47 [46:30<54:51, 149.63s/it][A
Sampling news batches:  55%|█████████████████████████████████████████████████████████████████████████████▍                                                              | 26/47 [51:08<1:05:55, 188.37s/it][A
Sampling news batches:  57%|████████████████████████████████████████████████████████████████████████████████▍                                                           | 27/47 [54:11<1:02:15, 186.78s/it][A
Sampling news batches:  60%|████████████████████████████████████████████████████████████████████████████████████▌                                                         | 28/47 [55:49<50:40, 160.01s/it][A
Sampling news batches:  62%|███████████████████████████████████████████████████████████████████████████████████████▌                                                      | 29/47 [56:29<37:10, 123.91s/it][A
Sampling news batches:  64%|██████████████████████████████████████████████████████████████████████████████████████████▋                                                   | 30/47 [59:11<38:22, 135.45s/it][A
Sampling news batches:  66%|████████████████████████████████████████████████████████████████████████████████████████████▎                                               | 31/47 [1:02:29<41:08, 154.27s/it][A
Sampling news batches:  68%|███████████████████████████████████████████████████████████████████████████████████████████████▎                                            | 32/47 [1:05:20<39:47, 159.15s/it][A
Sampling news batches:  70%|██████████████████████████████████████████████████████████████████████████████████████████████████▎                                         | 33/47 [1:08:09<37:50, 162.20s/it][A
Sampling news batches:  72%|█████████████████████████████████████████████████████████████████████████████████████████████████████▎                                      | 34/47 [1:09:56<31:31, 145.51s/it][A
Sampling news batches:  74%|████████████████████████████████████████████████████████████████████████████████████████████████████████▎                                   | 35/47 [1:12:29<29:34, 147.91s/it][A
Sampling news batches:  77%|███████████████████████████████████████████████████████████████████████████████████████████████████████████▏                                | 36/47 [1:14:49<26:39, 145.41s/it][A
Sampling news batches:  79%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████▏                             | 37/47 [1:17:26<24:49, 148.92s/it][A
Sampling news batches:  81%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████▏                          | 38/47 [1:20:20<23:27, 156.44s/it][A
Sampling news batches:  83%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▏                       | 39/47 [1:22:59<20:57, 157.15s/it][A
Sampling news batches:  85%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▏                    | 40/47 [1:24:10<15:21, 131.58s/it][A{'grad': 2.1147770285606384, 'context_loss': 7.818223941326141, 'stance_loss': 1.3860597133636474, 'news_loss': 0.6683281198143959}


Validating rep learning:   0%|                                                                                                                                                    | 0/2211 [00:00<?, ?it/s][A[A

Validating rep learning:   7%|█████████▋                                                                                                                              | 157/2211 [00:00<00:01, 1562.89it/s][A[A

Validating rep learning:  17%|██████████████████████▉                                                                                                                 | 372/2211 [00:00<00:01, 1701.34it/s][A[A

Validating rep learning:  26%|██████████████████████████████████▊                                                                                                     | 565/2211 [00:00<00:00, 1761.86it/s][A[A

Validating rep learning:  35%|███████████████████████████████████████████████▏                                                                                        | 768/2211 [00:00<00:00, 1833.88it/s][A[A

Validating rep learning:  43%|██████████████████████████████████████████████████████████▎                                                                             | 949/2211 [00:00<00:00, 1824.02it/s][A[A

Validating rep learning:  51%|████████████████████████████████████████████████████████████████████▊                                                                  | 1126/2211 [00:00<00:00, 1804.66it/s][A[A

Validating rep learning:  59%|███████████████████████████████████████████████████████████████████████████████▋                                                       | 1306/2211 [00:00<00:00, 1802.85it/s][A[A

Validating rep learning:  67%|██████████████████████████████████████████████████████████████████████████████████████████                                             | 1475/2211 [00:00<00:00, 1328.44it/s][A[A

Validating rep learning:  75%|█████████████████████████████████████████████████████████████████████████████████████████████████████▍                                 | 1662/2211 [00:01<00:00, 1453.99it/s][A[A

Validating rep learning:  83%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████▋                      | 1846/2211 [00:01<00:00, 1550.57it/s][A[A

Validating rep learning:  92%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▏          | 2034/2211 [00:01<00:00, 1635.43it/s][A[A

Validating rep learning: 100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 2211/2211 [00:01<00:00, 1671.51it/s][A[AValidating rep learning: 100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 2211/2211 [00:01<00:00, 1688.74it/s]
{'stance_avg_closed_ratio': 0.9936795362453318, 'stance_avg_far_ratio': 1.023635041448715, 'other_avg_closed_ratio': 1.0082812825347043, 'other_avg_far_ratio': 0.0}

Sampling news batches:  87%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▏                 | 41/47 [1:29:01<17:55, 179.19s/it][A
Sampling news batches:  89%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████               | 42/47 [1:31:34<14:16, 171.29s/it][A
Sampling news batches:  91%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████            | 43/47 [1:32:21<08:56, 134.17s/it][A
Sampling news batches:  94%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████         | 44/47 [1:35:28<07:29, 149.86s/it][A
Sampling news batches:  96%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████      | 45/47 [1:38:26<05:16, 158.49s/it][A
Sampling news batches:  98%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████   | 46/47 [1:40:44<02:32, 152.28s/it][A
Sampling news batches: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 47/47 [1:44:02<00:00, 166.05s/it][ASampling news batches: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 47/47 [1:44:02<00:00, 132.82s/it]
Validating
Training GraphSage:   0%|                                                                                                                                                         | 0/30 [1:55:00<?, ?it/s]
Traceback (most recent call last):
  File "run_graph.py", line 67, in <module>
    fang(p_args)
  File "run_graph.py", line 55, in fang
    pretrained_dir=args.pretrained_dir, pretrained_step=args.pretrained_step)
  File "/home/sejmou/Repos/Uni/ExpDesDS/FANG/fang/graphsage/__init__.py", line 227, in run_fang_graph_sage
    n_nodes, input_size, pretrained_dir, pretrained_step)
  File "/home/sejmou/Repos/Uni/ExpDesDS/FANG/fang/graphsage/__init__.py", line 631, in train_fn
    writer, device, tag="validate")
  File "/home/sejmou/Repos/Uni/ExpDesDS/FANG/fang/graphsage/__init__.py", line 709, in eval_fn
    embed_size, device, cutoff_range, test=True)
  File "/home/sejmou/Repos/Uni/ExpDesDS/FANG/fang/graphsage/__init__.py", line 741, in preprocess_news_classification_data
    else torch.zeros(1, embed_size).to(device) for e_users in engage_users_batch]
  File "/home/sejmou/Repos/Uni/ExpDesDS/FANG/fang/graphsage/__init__.py", line 741, in <listcomp>
    else torch.zeros(1, embed_size).to(device) for e_users in engage_users_batch]
  File "/home/sejmou/anaconda3/envs/test/lib/python3.7/site-packages/torch/nn/modules/module.py", line 550, in __call__
    result = self.forward(*input, **kwargs)
  File "/home/sejmou/Repos/Uni/ExpDesDS/FANG/user_embed/graphsage/models.py", line 55, in forward
    aggregate_feats = self.aggregate(nb, pre_hidden_embs, pre_neighs)
  File "/home/sejmou/Repos/Uni/ExpDesDS/FANG/user_embed/graphsage/models.py", line 121, in aggregate
    mask = mask.div(num_neigh).to(embed_matrix.device)
RuntimeError: CUDA out of memory. Tried to allocate 2.39 GiB (GPU 0; 5.93 GiB total capacity; 342.36 MiB already allocated; 1.23 GiB free; 4.01 GiB reserved in total by PyTorch)

real	122m17,902s
user	61m10,455s
sys	22m17,106s
(test) ]0;sejmou@sejmou-desktop: ~/Repos/Uni/ExpDesDS/FANG[01;32msejmou@sejmou-desktop[00m:[01;34m~/Repos/Uni/ExpDesDS/FANG[00m$ time python run_graph.py -t fang -m graph_sage -p data/news_graph --percent 10 --epochs=30 --attention --use-stance --use-proximity --temporal[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[1P[1@9
Using stance
Using proximity
Load FANG dataset from data/news_graph
/home/sejmou/Repos/Uni/ExpDesDS/FANG/fang/utils.py:98: RuntimeWarning: divide by zero encountered in power
  sum_inv = np.power(row_sum, -1).flatten()
Loading cache
Use temporal
Initialize optimizer with weight decay 0.0005
Train 55858 Dev 51 Test 48
Training GraphSage:   0%|                                                                                                                                                           | 0/30 [00:00<?, ?it/s]
Sampling news batches:   0%|                                                                                                                                                        | 0/47 [00:00<?, ?it/s][A{'grad': 2.2031173706054688, 'context_loss': 7.9537577629089355, 'stance_loss': 1.3797366619110107, 'news_loss': 0.7965400218963623}


Validating rep learning:   0%|                                                                                                                                                    | 0/2211 [00:00<?, ?it/s][A[A

Validating rep learning:   8%|███████████                                                                                                                             | 180/2211 [00:00<00:01, 1799.05it/s][A[A

Validating rep learning:  18%|███████████████████████▉                                                                                                                | 389/2211 [00:00<00:00, 1876.22it/s][A[A

Validating rep learning:  27%|████████████████████████████████████                                                                                                    | 586/2211 [00:00<00:00, 1902.89it/s][A[A

Validating rep learning:  36%|████████████████████████████████████████████████▋                                                                                       | 791/2211 [00:00<00:00, 1942.12it/s][A[A

Validating rep learning:  45%|████████████████████████████████████████████████████████████▋                                                                           | 987/2211 [00:00<00:00, 1945.54it/s][A[A

Validating rep learning:  53%|███████████████████████████████████████████████████████████████████████▉                                                               | 1179/2211 [00:00<00:00, 1934.38it/s][A[A

Validating rep learning:  62%|███████████████████████████████████████████████████████████████████████████████████▊                                                   | 1372/2211 [00:00<00:00, 1930.57it/s][A[A

Validating rep learning:  71%|███████████████████████████████████████████████████████████████████████████████████████████████▌                                       | 1565/2211 [00:00<00:00, 1928.45it/s][A[A

Validating rep learning:  79%|███████████████████████████████████████████████████████████████████████████████████████████████████████████▏                           | 1756/2211 [00:00<00:00, 1921.29it/s][A[A

Validating rep learning:  88%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████                | 1949/2211 [00:01<00:00, 1921.38it/s][A[A

Validating rep learning:  97%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▊    | 2142/2211 [00:01<00:00, 1922.51it/s][A[AValidating rep learning: 100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 2211/2211 [00:01<00:00, 1940.03it/s]
{'stance_avg_closed_ratio': 0.9720486471392681, 'stance_avg_far_ratio': 0.997429443753261, 'other_avg_closed_ratio': 0.913179926469688, 'other_avg_far_ratio': 0.0}

Sampling news batches:   2%|███                                                                                                                                          | 1/47 [02:30<1:55:22, 150.48s/it][A
Sampling news batches:   4%|██████                                                                                                                                       | 2/47 [04:01<1:39:33, 132.74s/it][A
Sampling news batches:   6%|█████████                                                                                                                                    | 3/47 [05:54<1:32:55, 126.72s/it][A
Sampling news batches:   9%|████████████                                                                                                                                 | 4/47 [06:41<1:13:36, 102.70s/it][A
Sampling news batches:  11%|███████████████                                                                                                                               | 5/47 [07:40<1:02:46, 89.67s/it][A
Sampling news batches:  13%|██████████████████▍                                                                                                                             | 6/47 [08:16<50:19, 73.65s/it][A
Sampling news batches:  15%|█████████████████████▍                                                                                                                          | 7/47 [09:00<43:07, 64.69s/it][A
Sampling news batches:  17%|████████████████████████▌                                                                                                                       | 8/47 [09:48<38:47, 59.67s/it][A
Sampling news batches:  19%|███████████████████████████▌                                                                                                                    | 9/47 [10:42<36:41, 57.93s/it][A
Sampling news batches:  21%|██████████████████████████████▍                                                                                                                | 10/47 [11:32<34:18, 55.63s/it][A
Sampling news batches:  23%|█████████████████████████████████▍                                                                                                             | 11/47 [12:18<31:34, 52.62s/it][A
Sampling news batches:  26%|████████████████████████████████████▌                                                                                                          | 12/47 [13:43<36:26, 62.48s/it][A
Sampling news batches:  28%|███████████████████████████████████████▌                                                                                                       | 13/47 [15:11<39:44, 70.12s/it][A
Sampling news batches:  30%|██████████████████████████████████████████▌                                                                                                    | 14/47 [17:17<47:50, 86.98s/it][A
Sampling news batches:  32%|█████████████████████████████████████████████▎                                                                                                | 15/47 [19:58<58:06, 108.95s/it][A
Sampling news batches:  34%|███████████████████████████████████████████████▋                                                                                            | 16/47 [22:18<1:01:12, 118.47s/it][A
Sampling news batches:  36%|███████████████████████████████████████████████████▎                                                                                          | 17/47 [23:40<53:42, 107.40s/it][A
Sampling news batches:  38%|█████████████████████████████████████████████████████▌                                                                                      | 18/47 [26:27<1:00:30, 125.17s/it][A
Sampling news batches:  40%|█████████████████████████████████████████████████████████▍                                                                                    | 19/47 [27:54<53:10, 113.94s/it][A
Sampling news batches:  43%|████████████████████████████████████████████████████████████▍                                                                                 | 20/47 [30:34<57:27, 127.68s/it][A
Sampling news batches:  45%|███████████████████████████████████████████████████████████████▍                                                                              | 21/47 [32:20<52:33, 121.29s/it][A
Sampling news batches:  47%|██████████████████████████████████████████████████████████████████▉                                                                            | 22/47 [33:04<40:49, 97.97s/it][A
Sampling news batches:  49%|█████████████████████████████████████████████████████████████████████▍                                                                        | 23/47 [35:30<44:59, 112.50s/it][A
Sampling news batches:  51%|████████████████████████████████████████████████████████████████████████▌                                                                     | 24/47 [37:04<40:55, 106.78s/it][A
Sampling news batches:  53%|███████████████████████████████████████████████████████████████████████████▌                                                                  | 25/47 [40:01<46:51, 127.79s/it][A
Sampling news batches:  55%|██████████████████████████████████████████████████████████████████████████████▌                                                               | 26/47 [41:21<39:46, 113.66s/it][A
Sampling news batches:  57%|█████████████████████████████████████████████████████████████████████████████████▌                                                            | 27/47 [43:24<38:47, 116.35s/it][A
Sampling news batches:  60%|█████████████████████████████████████████████████████████████████████████████████████▏                                                         | 28/47 [44:10<30:11, 95.35s/it][A
Sampling news batches:  62%|███████████████████████████████████████████████████████████████████████████████████████▌                                                      | 29/47 [46:58<35:07, 117.07s/it][A
Sampling news batches:  64%|███████████████████████████████████████████████████████████████████████████████████████████▎                                                   | 30/47 [47:57<28:11, 99.52s/it][A
Sampling news batches:  66%|██████████████████████████████████████████████████████████████████████████████████████████████▎                                                | 31/47 [48:35<21:37, 81.09s/it][A
Sampling news batches:  68%|█████████████████████████████████████████████████████████████████████████████████████████████████▎                                             | 32/47 [50:41<23:40, 94.73s/it][A
Sampling news batches:  70%|████████████████████████████████████████████████████████████████████████████████████████████████████▍                                          | 33/47 [51:57<20:45, 88.95s/it][A
Sampling news batches:  72%|██████████████████████████████████████████████████████████████████████████████████████████████████████▋                                       | 34/47 [54:43<24:19, 112.24s/it][A
Sampling news batches:  74%|█████████████████████████████████████████████████████████████████████████████████████████████████████████▋                                    | 35/47 [57:42<26:26, 132.22s/it][A
Sampling news batches:  77%|████████████████████████████████████████████████████████████████████████████████████████████████████████████▊                                 | 36/47 [59:05<21:31, 117.45s/it][A
Sampling news batches:  79%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████▏                             | 37/47 [1:01:35<21:11, 127.10s/it][A
Sampling news batches:  81%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████▏                          | 38/47 [1:02:19<15:21, 102.37s/it][A
Sampling news batches:  83%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▏                       | 39/47 [1:05:53<18:06, 135.87s/it][A
Sampling news batches:  85%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▏                    | 40/47 [1:07:27<14:21, 123.10s/it][A{'grad': 1.2142730057239532, 'context_loss': 7.829861378669738, 'stance_loss': 1.3845399767160416, 'news_loss': 0.710070113837719}


Validating rep learning:   0%|                                                                                                                                                    | 0/2211 [00:00<?, ?it/s][A[A

Validating rep learning:   3%|████                                                                                                                                      | 65/2211 [00:00<00:03, 646.55it/s][A[A

Validating rep learning:  12%|████████████████▉                                                                                                                        | 274/2211 [00:00<00:02, 815.38it/s][A[A

Validating rep learning:  22%|██████████████████████████████                                                                                                          | 489/2211 [00:00<00:01, 1001.70it/s][A[A

Validating rep learning:  32%|██████████████████████████████████████████▊                                                                                             | 697/2211 [00:00<00:01, 1185.28it/s][A[A

Validating rep learning:  40%|██████████████████████████████████████████████████████▉                                                                                 | 894/2211 [00:00<00:00, 1345.60it/s][A[A

Validating rep learning:  49%|██████████████████████████████████████████████████████████████████▍                                                                    | 1089/2211 [00:00<00:00, 1482.37it/s][A[A

Validating rep learning:  58%|██████████████████████████████████████████████████████████████████████████████                                                         | 1279/2211 [00:00<00:00, 1585.88it/s][A[A

Validating rep learning:  66%|█████████████████████████████████████████████████████████████████████████████████████████▋                                             | 1469/2211 [00:00<00:00, 1668.10it/s][A[A

Validating rep learning:  75%|█████████████████████████████████████████████████████████████████████████████████████████████████████▌                                 | 1663/2211 [00:00<00:00, 1738.93it/s][A[A

Validating rep learning:  84%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████▎                     | 1856/2211 [00:01<00:00, 1790.22it/s][A[A

Validating rep learning:  93%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▉          | 2047/2211 [00:01<00:00, 1824.28it/s][A[AValidating rep learning: 100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 2211/2211 [00:01<00:00, 1859.18it/s]
{'stance_avg_closed_ratio': 0.971048324400022, 'stance_avg_far_ratio': 0.9988508058164397, 'other_avg_closed_ratio': 0.9779908879025329, 'other_avg_far_ratio': 0.0}

Sampling news batches:  87%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▏                 | 41/47 [1:12:21<17:26, 174.34s/it][A
Sampling news batches:  89%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████               | 42/47 [1:13:48<12:20, 148.15s/it][A
Sampling news batches:  91%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████            | 43/47 [1:16:54<10:38, 159.59s/it][A
Sampling news batches:  94%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████         | 44/47 [1:18:32<07:03, 141.19s/it][A
Sampling news batches:  96%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████      | 45/47 [1:20:33<04:30, 135.23s/it][A
Sampling news batches:  98%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████   | 46/47 [1:23:48<02:32, 152.98s/it][A
Sampling news batches: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 47/47 [1:25:08<00:00, 131.00s/it][ASampling news batches: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 47/47 [1:25:08<00:00, 108.68s/it]
Validating
Number of test: 51
Accuracy score: 0.49019607843137253
Precision score: 0.5147058823529411
Recall score: 0.5133228840125392
F1 score: 0.48524844720496896
ROC AUC score: 0.4216300940438872
{'accuracy': 0.49019607843137253, 'precision': 0.5147058823529411, 'recall': 0.5133228840125392, 'f1': 0.48524844720496896, 'auc': 0.4216300940438872, 'loss': 0.7284038066864014}
Testing
Number of test: 48
Accuracy score: 0.4166666666666667
Precision score: 0.4444444444444444
Recall score: 0.45714285714285713
F1 score: 0.4
ROC AUC score: 0.4910714285714286
{'accuracy': 0.4166666666666667, 'precision': 0.4444444444444444, 'recall': 0.45714285714285713, 'f1': 0.4, 'auc': 0.4910714285714286, 'loss': 0.7209812998771667}
Best evaluator is updated.
Saving model checkpoint.
Exporting train embeddings

Exporting node embedding to Tensorboard:   0%|                                                                                                                                    | 0/1496 [00:00<?, ?it/s][A
Exporting node embedding to Tensorboard:  17%|████████████████████▉                                                                                                     | 256/1496 [00:37<03:00,  6.87it/s][A
Exporting node embedding to Tensorboard:  34%|█████████████████████████████████████████▊                                                                                | 512/1496 [01:12<02:20,  7.01it/s][A
Exporting node embedding to Tensorboard:  51%|██████████████████████████████████████████████████████████████▋                                                           | 768/1496 [03:23<03:04,  3.94it/s][A
Exporting node embedding to Tensorboard:  68%|██████████████████████████████████████████████████████████████████████████████████▊                                      | 1024/1496 [03:58<01:43,  4.57it/s][A
Exporting node embedding to Tensorboard:  86%|███████████████████████████████████████████████████████████████████████████████████████████████████████▌                 | 1280/1496 [04:37<00:42,  5.04it/s][AExporting node embedding to Tensorboard: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 1496/1496 [04:37<00:00,  5.40it/s]
Training GraphSage:   3%|████▋                                                                                                                                       | 1/30 [2:01:09<58:33:39, 7269.62s/it]
Sampling news batches:   0%|                                                                                                                                                        | 0/47 [00:00<?, ?it/s][A
Sampling news batches:   2%|███                                                                                                                                             | 1/47 [00:37<28:58, 37.80s/it][A
Sampling news batches:   4%|██████▏                                                                                                                                         | 2/47 [03:09<54:04, 72.10s/it][A
Sampling news batches:   6%|█████████▏                                                                                                                                      | 3/47 [03:51<46:07, 62.90s/it][A
Sampling news batches:   9%|████████████                                                                                                                                 | 4/47 [07:13<1:15:06, 104.81s/it][A
Sampling news batches:  11%|███████████████                                                                                                                              | 5/47 [12:04<1:52:27, 160.66s/it][A
Sampling news batches:  13%|██████████████████                                                                                                                           | 6/47 [15:40<2:01:01, 177.11s/it][A
Sampling news batches:  15%|█████████████████████                                                                                                                        | 7/47 [17:26<1:43:47, 155.70s/it][A
Sampling news batches:  17%|████████████████████████                                                                                                                     | 8/47 [20:42<1:49:12, 168.01s/it][A
Sampling news batches:  19%|███████████████████████████                                                                                                                  | 9/47 [24:26<1:56:58, 184.70s/it][A
Sampling news batches:  21%|█████████████████████████████▊                                                                                                              | 10/47 [29:11<2:12:29, 214.85s/it][A
Sampling news batches:  23%|████████████████████████████████▊                                                                                                           | 11/47 [33:59<2:22:00, 236.69s/it][A
Sampling news batches:  26%|███████████████████████████████████▋                                                                                                        | 12/47 [39:26<2:33:54, 263.83s/it][A
Sampling news batches:  28%|██████████████████████████████████████▋                                                                                                     | 13/47 [42:01<2:10:56, 231.07s/it][A
Sampling news batches:  30%|█████████████████████████████████████████▋                                                                                                  | 14/47 [42:58<1:38:24, 178.92s/it][A
Sampling news batches:  32%|████████████████████████████████████████████▋                                                                                               | 15/47 [47:57<1:54:34, 214.83s/it][A
Sampling news batches:  34%|███████████████████████████████████████████████▋                                                                                            | 16/47 [52:32<2:00:22, 232.98s/it][A
Sampling news batches:  36%|██████████████████████████████████████████████████▋                                                                                         | 17/47 [57:57<2:10:21, 260.71s/it][A
Sampling news batches:  38%|████████████████████████████████████████████████████▊                                                                                     | 18/47 [1:00:35<1:51:07, 229.91s/it][A
Sampling news batches:  40%|███████████████████████████████████████████████████████▊                                                                                  | 19/47 [1:05:23<1:55:19, 247.12s/it][A
Sampling news batches:  43%|██████████████████████████████████████████████████████████▋                                                                               | 20/47 [1:06:11<1:24:19, 187.40s/it][A
Sampling news batches:  45%|█████████████████████████████████████████████████████████████▋                                                                            | 21/47 [1:11:02<1:34:46, 218.72s/it][A
Sampling news batches:  47%|████████████████████████████████████████████████████████████████▌                                                                         | 22/47 [1:16:30<1:44:42, 251.29s/it][A
Sampling news batches:  49%|███████████████████████████████████████████████████████████████████▌                                                                      | 23/47 [1:20:55<1:42:12, 255.54s/it][A
Sampling news batches:  51%|██████████████████████████████████████████████████████████████████████▍                                                                   | 24/47 [1:26:21<1:46:02, 276.65s/it][A
Sampling news batches:  53%|█████████████████████████████████████████████████████████████████████████▍                                                                | 25/47 [1:30:26<1:37:59, 267.23s/it][A
Sampling news batches:  55%|████████████████████████████████████████████████████████████████████████████▎                                                             | 26/47 [1:34:42<1:32:16, 263.63s/it][A^C^C^C^C^C^C^C



^C^C^C^C^[^[^C^C^C^C^C^C^C^C^C^C^C^C^C^C^C^C^C^C^C^C^C^C^C^C^C^C^C^C^C^C^C^C^C^C^C^C^C^C^C^C^C^C^C^C^C^C^CSampling news batches:  55%|████████████████████████████████████████████████████████████████████████████▎                                                             | 26/47 [1:37:12<1:18:31, 224.34s/it]
^CException ignored in: <generator object tqdm.__iter__ at 0x7f6843137cd0>
Traceback (most recent call last):
  File "/home/sejmou/anaconda3/envs/test/lib/python3.7/site-packages/tqdm/std.py", line 1182, in __iter__
    self.close()
  File "/home/sejmou/anaconda3/envs/test/lib/python3.7/site-packages/tqdm/std.py", line 1270, in close
    self._decr_instances(self)
  File "/home/sejmou/anaconda3/envs/test/lib/python3.7/site-packages/tqdm/std.py", line 572, in _decr_instances
    cls.monitor.exit()
  File "/home/sejmou/anaconda3/envs/test/lib/python3.7/site-packages/tqdm/_monitor.py", line 53, in exit
    self.join()
  File "/home/sejmou/anaconda3/envs/test/lib/python3.7/threading.py", line 1044, in join
    self._wait_for_tstate_lock()
  File "/home/sejmou/anaconda3/envs/test/lib/python3.7/threading.py", line 1060, in _wait_for_tstate_lock
    elif lock.acquire(block, timeout):
KeyboardInterrupt: 
Traceback (most recent call last):
  File "run_graph.py", line 67, in <module>
    fang(p_args)
  File "run_graph.py", line 55, in fang
    pretrained_dir=args.pretrained_dir, pretrained_step=args.pretrained_step)
  File "/home/sejmou/Repos/Uni/ExpDesDS/FANG/fang/graphsage/__init__.py", line 227, in run_fang_graph_sage
    n_nodes, input_size, pretrained_dir, pretrained_step)
  File "/home/sejmou/Repos/Uni/ExpDesDS/FANG/fang/graphsage/__init__.py", line 454, in train_fn
    user_emb_batch = graph_sage(user_batch) if len(user_batch) > 0 else None
  File "/home/sejmou/anaconda3/envs/test/lib/python3.7/site-packages/torch/nn/modules/module.py", line 550, in __call__
    result = self.forward(*input, **kwargs)
  File "/home/sejmou/Repos/Uni/ExpDesDS/FANG/user_embed/graphsage/models.py", line 45, in forward
    lower_layer_nodes, num_sample=layer_num_samples[i])
  File "/home/sejmou/Repos/Uni/ExpDesDS/FANG/user_embed/graphsage/models.py", line 82, in _get_unique_neighs_list
    in to_neighs]
  File "/home/sejmou/Repos/Uni/ExpDesDS/FANG/user_embed/graphsage/models.py", line 81, in <listcomp>
    if len(to_neigh) >= num_sample else to_neigh for to_neigh
  File "/home/sejmou/anaconda3/envs/test/lib/python3.7/random.py", line 315, in sample
    population = tuple(population)
KeyboardInterrupt
^C

real	219m13,190s
user	104m19,324s
sys	42m37,258s
(test) ]0;sejmou@sejmou-desktop: ~/Repos/Uni/ExpDesDS/FANG[01;32msejmou@sejmou-desktop[00m:[01;34m~/Repos/Uni/ExpDesDS/FANG[00m$ exit
exit

Script done on 2022-01-25 18:04:38+01:00 [COMMAND_EXIT_CODE="130"]
